s(:begin,
  s(:class,
    s(:const, nil, :Hash), nil,
    s(:def, :extractable_options?,
      s(:args),
      s(:send, nil, :instance_of?,
        s(:const, nil, :Hash)))),
  s(:class,
    s(:const, nil, :Array), nil,
    s(:def, :extract_options!,
      s(:args),
      s(:if,
        s(:and,
          s(:send,
            s(:send, nil, :last), :is_a?,
            s(:const, nil, :Hash)),
          s(:send,
            s(:send, nil, :last), :extractable_options?)),
        s(:send, nil, :pop),
        s(:hash)))))
