s(:begin,
  s(:lvasgn, :cd,
    s(:send,
      s(:send,
        s(:xstr,
          s(:str, "pwd")), :chomp), :+,
      s(:str, "/"))),
  s(:block,
    s(:send,
      s(:const, nil, :ARGF), :each),
    s(:args,
      s(:arg, :line)),
    s(:if,
      s(:match_with_lvasgn,
        s(:regexp,
          s(:str, "^0x([a-z0-9]+),"),
          s(:regopt)),
        s(:lvar, :line)),
      s(:begin,
        s(:lvasgn, :stat,
          s(:send,
            s(:lvar, :line), :split,
            s(:str, ","))),
        s(:lvasgn, :addr,
          s(:send,
            s(:send,
              s(:send,
                s(:lvar, :stat), :[],
                s(:int, 0)), :hex), :+,
            s(:int, 4194304))),
        s(:lvasgn, :retired,
          s(:send,
            s(:send,
              s(:lvar, :stat), :[],
              s(:int, 2)), :to_i)),
        s(:lvasgn, :ticks,
          s(:send,
            s(:send,
              s(:lvar, :stat), :[],
              s(:int, 3)), :to_i)),
        s(:lvasgn, :src,
          s(:send,
            s(:xstr,
              s(:str, "addr2line -e miniruby.exe "),
              s(:begin,
                s(:send,
                  s(:lvar, :addr), :to_s,
                  s(:int, 16)))), :chomp)),
        s(:send,
          s(:lvar, :src), :sub!,
          s(:lvar, :cd),
          s(:str, "")),
        s(:send, nil, :puts,
          s(:send,
            s(:str, "%-40s 0x%08x %8d %8d"), :%,
            s(:array,
              s(:lvar, :src),
              s(:lvar, :addr),
              s(:lvar, :retired),
              s(:lvar, :ticks))))), nil)))
