s(:begin,
  s(:send, nil, :require,
    s(:str, "optparse")),
  s(:lvasgn, :parser,
    s(:send,
      s(:const, nil, :OptionParser), :new)),
  s(:block,
    s(:send,
      s(:lvar, :parser), :on,
      s(:str, "-i")),
    s(:args),
    s(:send, nil, :puts,
      s(:str, "-i"))),
  s(:block,
    s(:send,
      s(:lvar, :parser), :on,
      s(:str, "-o")),
    s(:args),
    s(:send, nil, :puts,
      s(:str, "-o"))),
  s(:lvasgn, :subparsers,
    s(:block,
      s(:send,
        s(:const, nil, :Hash), :new),
      s(:args,
        s(:arg, :h),
        s(:arg, :k)),
      s(:begin,
        s(:send,
          s(:gvar, :$stderr), :puts,
          s(:dstr,
            s(:str, "no such subcommand: "),
            s(:begin,
              s(:lvar, :k)))),
        s(:send, nil, :exit,
          s(:int, 1))))),
  s(:send,
    s(:lvar, :subparsers), :[]=,
    s(:str, "add"),
    s(:block,
      s(:send,
        s(:send,
          s(:const, nil, :OptionParser), :new), :on,
        s(:str, "-i")),
      s(:args),
      s(:send, nil, :puts,
        s(:str, "add -i")))),
  s(:send,
    s(:lvar, :subparsers), :[]=,
    s(:str, "del"),
    s(:block,
      s(:send,
        s(:send,
          s(:const, nil, :OptionParser), :new), :on,
        s(:str, "-i")),
      s(:args),
      s(:send, nil, :puts,
        s(:str, "del -i")))),
  s(:send,
    s(:lvar, :subparsers), :[]=,
    s(:str, "list"),
    s(:block,
      s(:send,
        s(:send,
          s(:const, nil, :OptionParser), :new), :on,
        s(:str, "-i")),
      s(:args),
      s(:send, nil, :puts,
        s(:str, "list -i")))),
  s(:send,
    s(:lvar, :parser), :order!,
    s(:const, nil, :ARGV)),
  s(:if,
    s(:send,
      s(:const, nil, :ARGV), :empty?), nil,
    s(:send,
      s(:send,
        s(:lvar, :subparsers), :[],
        s(:send,
          s(:const, nil, :ARGV), :shift)), :parse!,
      s(:const, nil, :ARGV))))
