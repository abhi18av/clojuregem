s(:begin,
  s(:send, nil, :require,
    s(:str, "open3")),
  s(:lvasgn, :a,
    s(:send,
      s(:const, nil, :Open3), :popen3,
      s(:str, "nroff -man"))),
  s(:block,
    s(:send,
      s(:const, nil, :Thread), :start),
    s(:args),
    s(:begin,
      s(:while,
        s(:lvasgn, :line,
          s(:send, nil, :gets)),
        s(:send,
          s(:send,
            s(:lvar, :a), :[],
            s(:int, 0)), :print,
          s(:lvar, :line))),
      s(:send,
        s(:send,
          s(:lvar, :a), :[],
          s(:int, 0)), :close))),
  s(:while,
    s(:lvasgn, :line,
      s(:send,
        s(:send,
          s(:lvar, :a), :[],
          s(:int, 1)), :gets)),
    s(:send, nil, :print,
      s(:str, ":"),
      s(:lvar, :line))))
