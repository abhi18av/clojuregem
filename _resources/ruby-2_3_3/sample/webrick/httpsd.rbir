s(:begin,
  s(:send, nil, :require,
    s(:str, "webrick")),
  s(:send, nil, :require,
    s(:str, "webrick/https")),
  s(:lvasgn, :hostname,
    s(:send,
      s(:const,
        s(:const, nil, :WEBrick), :Utils), :getservername)),
  s(:lvasgn, :subject,
    s(:array,
      s(:array,
        s(:str, "O"),
        s(:str, "ruby-lang.org")),
      s(:array,
        s(:str, "OU"),
        s(:str, "sample")),
      s(:array,
        s(:str, "CN"),
        s(:lvar, :hostname)))),
  s(:lvasgn, :comment,
    s(:str, "Comment for self-signed certificate")),
  s(:lvasgn, :httpd,
    s(:send,
      s(:const,
        s(:const, nil, :WEBrick), :HTTPServer), :new,
      s(:hash,
        s(:pair,
          s(:sym, :DocumentRoot),
          s(:send,
            s(:const, nil, :File), :dirname,
            s(:str, "(string)"))),
        s(:pair,
          s(:sym, :Port),
          s(:int, 10443)),
        s(:pair,
          s(:sym, :SSLEnable),
          s(:true)),
        s(:pair,
          s(:sym, :SSLCertName),
          s(:lvar, :subject)),
        s(:pair,
          s(:sym, :SSLComment),
          s(:lvar, :comment)),
        s(:pair,
          s(:sym, :CGIPathEnv),
          s(:send,
            s(:const, nil, :ENV), :[],
            s(:str, "PATH")))))),
  s(:send, nil, :require,
    s(:str, "./hello")),
  s(:send,
    s(:lvar, :httpd), :mount,
    s(:str, "/hello"),
    s(:const, nil, :HelloServlet)),
  s(:send, nil, :require,
    s(:str, "./demo-servlet")),
  s(:send,
    s(:lvar, :httpd), :mount,
    s(:str, "/urlencoded"),
    s(:const, nil, :DemoServlet),
    s(:str, "application/x-www-form-urlencoded")),
  s(:send,
    s(:lvar, :httpd), :mount,
    s(:str, "/multipart"),
    s(:const, nil, :DemoServlet),
    s(:str, "multipart/form-data")),
  s(:block,
    s(:send, nil, :trap,
      s(:sym, :INT)),
    s(:args),
    s(:send,
      s(:lvar, :httpd), :shutdown)),
  s(:send,
    s(:lvar, :httpd), :start))
