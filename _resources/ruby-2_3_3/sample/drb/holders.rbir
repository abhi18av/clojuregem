s(:begin,
  s(:send, nil, :require,
    s(:str, "drb/drb")),
  s(:class,
    s(:const, nil, :DRbEx3), nil,
    s(:begin,
      s(:send, nil, :include,
        s(:const, nil, :DRbUndumped)),
      s(:def, :initialize,
        s(:args,
          s(:arg, :n)),
        s(:ivasgn, :@v,
          s(:lvar, :n))),
      s(:def, :sample,
        s(:args,
          s(:arg, :list)),
        s(:begin,
          s(:lvasgn, :sum,
            s(:int, 0)),
          s(:block,
            s(:send,
              s(:lvar, :list), :each),
            s(:args,
              s(:arg, :e)),
            s(:op_asgn,
              s(:lvasgn, :sum), :+,
              s(:send,
                s(:lvar, :e), :to_i))),
          s(:send,
            s(:ivar, :@v), :*,
            s(:lvar, :sum)))))),
  s(:class,
    s(:const, nil, :DRbEx4), nil,
    s(:begin,
      s(:send, nil, :include,
        s(:const, nil, :DRbUndumped)),
      s(:def, :initialize,
        s(:args),
        s(:ivasgn, :@curr,
          s(:int, 1))),
      s(:def, :gen,
        s(:args),
        s(:kwbegin,
          s(:ensure,
            s(:begin,
              s(:op_asgn,
                s(:ivasgn, :@curr), :+,
                s(:int, 1)),
              s(:send,
                s(:const, nil, :DRbEx3), :new,
                s(:ivar, :@curr))),
            s(:send,
              s(:const, nil, :GC), :start)))))),
  s(:if,
    s(:send,
      s(:str, "(string)"), :==,
      s(:gvar, :$0)),
    s(:begin,
      s(:if,
        s(:gvar, :$DEBUG),
        s(:begin,
          s(:send, nil, :require,
            s(:str, "drb/timeridconv")),
          s(:send,
            s(:const, nil, :DRb), :install_id_conv,
            s(:send,
              s(:const,
                s(:const, nil, :DRb), :TimerIdConv), :new,
              s(:int, 2)))), nil),
      s(:send,
        s(:const, nil, :DRb), :start_service,
        s(:nil),
        s(:send,
          s(:const, nil, :DRbEx4), :new)),
      s(:send, nil, :puts,
        s(:send,
          s(:const, nil, :DRb), :uri)),
      s(:send,
        s(:send,
          s(:const, nil, :DRb), :thread), :join)), nil))
