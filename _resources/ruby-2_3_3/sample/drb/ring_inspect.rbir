s(:begin,
  s(:send, nil, :require,
    s(:str, "rinda/ring")),
  s(:send, nil, :require,
    s(:str, "drb/drb")),
  s(:class,
    s(:const, nil, :Inspector), nil,
    s(:begin,
      s(:def, :initialize,
        s(:args), nil),
      s(:def, :primary,
        s(:args),
        s(:send,
          s(:const,
            s(:const, nil, :Rinda), :RingFinger), :primary)),
      s(:def, :list_place,
        s(:args),
        s(:send,
          s(:const,
            s(:const, nil, :Rinda), :RingFinger), :to_a)),
      s(:def, :list,
        s(:args,
          s(:optarg, :idx,
            s(:int, -1))),
        s(:begin,
          s(:if,
            s(:send,
              s(:lvar, :idx), :<,
              s(:int, 0)),
            s(:lvasgn, :ts,
              s(:send, nil, :primary)),
            s(:begin,
              s(:lvasgn, :ts,
                s(:send,
                  s(:send, nil, :list_place), :[],
                  s(:lvar, :idx))),
              s(:if,
                s(:lvar, :ts), nil,
                s(:send, nil, :raise,
                  s(:str, "RingNotFound"))))),
          s(:send,
            s(:lvar, :ts), :read_all,
            s(:array,
              s(:sym, :name),
              s(:nil),
              s(:nil),
              s(:nil))))))),
  s(:def, :main,
    s(:args),
    s(:begin,
      s(:send,
        s(:const, nil, :DRb), :start_service),
      s(:lvasgn, :r,
        s(:send,
          s(:const, nil, :Inspector), :new)))))
