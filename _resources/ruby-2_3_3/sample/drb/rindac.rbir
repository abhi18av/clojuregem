s(:begin,
  s(:send, nil, :require,
    s(:str, "drb/drb")),
  s(:send, nil, :require,
    s(:str, "rinda/rinda")),
  s(:lvasgn, :uri,
    s(:or,
      s(:send,
        s(:const, nil, :ARGV), :shift),
      s(:send, nil, :raise,
        s(:dstr,
          s(:str, "usage: "),
          s(:begin,
            s(:gvar, :$0)),
          s(:str, " <server_uri>"))))),
  s(:send,
    s(:const, nil, :DRb), :start_service),
  s(:lvasgn, :ts,
    s(:send,
      s(:const,
        s(:const, nil, :Rinda), :TupleSpaceProxy), :new,
      s(:send,
        s(:const, nil, :DRbObject), :new,
        s(:nil),
        s(:lvar, :uri)))),
  s(:block,
    s(:send,
      s(:begin,
        s(:irange,
          s(:int, 1),
          s(:int, 10))), :each),
    s(:args,
      s(:arg, :n)),
    s(:send,
      s(:lvar, :ts), :write,
      s(:array,
        s(:str, "sum"),
        s(:send,
          s(:const, nil, :DRb), :uri),
        s(:lvar, :n)))),
  s(:block,
    s(:send,
      s(:begin,
        s(:irange,
          s(:int, 1),
          s(:int, 10))), :each),
    s(:args,
      s(:arg, :n)),
    s(:begin,
      s(:lvasgn, :ans,
        s(:send,
          s(:lvar, :ts), :take,
          s(:array,
            s(:str, "ans"),
            s(:send,
              s(:const, nil, :DRb), :uri),
            s(:lvar, :n),
            s(:nil)))),
      s(:send, nil, :p,
        s(:array,
          s(:send,
            s(:lvar, :ans), :[],
            s(:int, 2)),
          s(:send,
            s(:lvar, :ans), :[],
            s(:int, 3)))))))
