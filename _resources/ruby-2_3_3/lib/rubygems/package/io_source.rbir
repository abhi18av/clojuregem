s(:class,
  s(:const,
    s(:const,
      s(:const, nil, :Gem), :Package), :IOSource),
  s(:const,
    s(:const,
      s(:const, nil, :Gem), :Package), :Source),
  s(:begin,
    s(:send, nil, :attr_reader,
      s(:sym, :io)),
    s(:def, :initialize,
      s(:args,
        s(:arg, :io)),
      s(:ivasgn, :@io,
        s(:lvar, :io))),
    s(:def, :start,
      s(:args),
      s(:or_asgn,
        s(:ivasgn, :@start),
        s(:kwbegin,
          s(:if,
            s(:send,
              s(:send,
                s(:send, nil, :io), :pos), :>,
              s(:int, 0)),
            s(:send, nil, :raise,
              s(:const,
                s(:const,
                  s(:const, nil, :Gem), :Package), :Error),
              s(:str, "Cannot read start unless IO is at start")), nil),
          s(:lvasgn, :value,
            s(:send,
              s(:send, nil, :io), :read,
              s(:int, 20))),
          s(:send,
            s(:send, nil, :io), :rewind),
          s(:lvar, :value)))),
    s(:def, :present?,
      s(:args),
      s(:true)),
    s(:def, :with_read_io,
      s(:args),
      s(:yield,
        s(:send, nil, :io))),
    s(:def, :with_write_io,
      s(:args),
      s(:yield,
        s(:send, nil, :io))),
    s(:def, :path,
      s(:args), nil)))
