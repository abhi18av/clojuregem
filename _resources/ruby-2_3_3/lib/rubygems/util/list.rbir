s(:module,
  s(:const, nil, :Gem),
  s(:class,
    s(:const, nil, :List), nil,
    s(:begin,
      s(:send, nil, :include,
        s(:const, nil, :Enumerable)),
      s(:send, nil, :attr_accessor,
        s(:sym, :value),
        s(:sym, :tail)),
      s(:def, :initialize,
        s(:args,
          s(:optarg, :value,
            s(:nil)),
          s(:optarg, :tail,
            s(:nil))),
        s(:begin,
          s(:ivasgn, :@value,
            s(:lvar, :value)),
          s(:ivasgn, :@tail,
            s(:lvar, :tail)))),
      s(:def, :each,
        s(:args),
        s(:begin,
          s(:lvasgn, :n,
            s(:self)),
          s(:while,
            s(:lvar, :n),
            s(:begin,
              s(:yield,
                s(:send,
                  s(:lvar, :n), :value)),
              s(:lvasgn, :n,
                s(:send,
                  s(:lvar, :n), :tail)))))),
      s(:def, :to_a,
        s(:args),
        s(:send,
          s(:zsuper), :reverse)),
      s(:def, :prepend,
        s(:args,
          s(:arg, :value)),
        s(:send,
          s(:const, nil, :List), :new,
          s(:lvar, :value),
          s(:self))),
      s(:def, :pretty_print,
        s(:args,
          s(:arg, :q)),
        s(:send,
          s(:lvar, :q), :pp,
          s(:send, nil, :to_a))),
      s(:defs,
        s(:self), :prepend,
        s(:args,
          s(:arg, :list),
          s(:arg, :value)),
        s(:begin,
          s(:if,
            s(:lvar, :list), nil,
            s(:return,
              s(:send,
                s(:const, nil, :List), :new,
                s(:lvar, :value)))),
          s(:send,
            s(:const, nil, :List), :new,
            s(:lvar, :value),
            s(:lvar, :list)))))))
