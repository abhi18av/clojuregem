s(:begin,
  s(:send, nil, :require,
    s(:str, "rss/1.0")),
  s(:send, nil, :require,
    s(:str, "rss/dublincore")),
  s(:module,
    s(:const, nil, :RSS),
    s(:begin,
      s(:casgn, nil, :IMAGE_PREFIX,
        s(:str, "image")),
      s(:casgn, nil, :IMAGE_URI,
        s(:str, "http://purl.org/rss/1.0/modules/image/")),
      s(:send,
        s(:const, nil, :RDF), :install_ns,
        s(:const, nil, :IMAGE_PREFIX),
        s(:const, nil, :IMAGE_URI)),
      s(:casgn, nil, :IMAGE_ELEMENTS,
        s(:array)),
      s(:block,
        s(:send,
          s(:array,
            s(:str, "item"),
            s(:str, "favicon")), :each),
        s(:args,
          s(:arg, :name)),
        s(:begin,
          s(:lvasgn, :class_name,
            s(:send,
              s(:const, nil, :Utils), :to_class_name,
              s(:lvar, :name))),
          s(:send,
            s(:const, nil, :BaseListener), :install_class_name,
            s(:const, nil, :IMAGE_URI),
            s(:lvar, :name),
            s(:dstr,
              s(:str, "Image"),
              s(:begin,
                s(:lvar, :class_name)))),
          s(:send,
            s(:const, nil, :IMAGE_ELEMENTS), :<<,
            s(:dstr,
              s(:begin,
                s(:const, nil, :IMAGE_PREFIX)),
              s(:str, "_"),
              s(:begin,
                s(:lvar, :name)))))),
      s(:module,
        s(:const, nil, :ImageModelUtils),
        s(:def, :validate_one_tag_name,
          s(:args,
            s(:arg, :ignore_unknown_element),
            s(:arg, :name),
            s(:arg, :tags)),
          s(:begin,
            s(:if,
              s(:send,
                s(:lvar, :ignore_unknown_element), :!),
              s(:begin,
                s(:lvasgn, :invalid,
                  s(:block,
                    s(:send,
                      s(:lvar, :tags), :find),
                    s(:args,
                      s(:arg, :tag)),
                    s(:send,
                      s(:lvar, :tag), :!=,
                      s(:lvar, :name)))),
                s(:if,
                  s(:lvar, :invalid),
                  s(:send, nil, :raise,
                    s(:send,
                      s(:const, nil, :UnknownTagError), :new,
                      s(:lvar, :invalid),
                      s(:const, nil, :IMAGE_URI))), nil)), nil),
            s(:if,
              s(:send,
                s(:send,
                  s(:lvar, :tags), :size), :>,
                s(:int, 1)),
              s(:send, nil, :raise,
                s(:send,
                  s(:const, nil, :TooMuchTagError), :new,
                  s(:lvar, :name),
                  s(:send, nil, :tag_name))), nil)))),
      s(:module,
        s(:const, nil, :ImageItemModel),
        s(:begin,
          s(:send, nil, :include,
            s(:const, nil, :ImageModelUtils)),
          s(:send, nil, :extend,
            s(:const, nil, :BaseModel)),
          s(:defs,
            s(:self), :append_features,
            s(:args,
              s(:arg, :klass)),
            s(:begin,
              s(:zsuper),
              s(:send,
                s(:lvar, :klass), :install_have_child_element,
                s(:str, "item"),
                s(:const, nil, :IMAGE_URI),
                s(:str, "?"),
                s(:dstr,
                  s(:begin,
                    s(:const, nil, :IMAGE_PREFIX)),
                  s(:str, "_item"))),
              s(:send,
                s(:lvar, :klass), :install_must_call_validator,
                s(:const, nil, :IMAGE_PREFIX),
                s(:const, nil, :IMAGE_URI)))),
          s(:class,
            s(:const, nil, :ImageItem),
            s(:const, nil, :Element),
            s(:begin,
              s(:send, nil, :include,
                s(:const, nil, :RSS10)),
              s(:send, nil, :include,
                s(:const, nil, :DublinCoreModel)),
              s(:ivasgn, :@tag_name,
                s(:str, "item")),
              s(:sclass,
                s(:self),
                s(:begin,
                  s(:def, :required_prefix,
                    s(:args),
                    s(:const, nil, :IMAGE_PREFIX)),
                  s(:def, :required_uri,
                    s(:args),
                    s(:const, nil, :IMAGE_URI)))),
              s(:send, nil, :install_must_call_validator,
                s(:const, nil, :IMAGE_PREFIX),
                s(:const, nil, :IMAGE_URI)),
              s(:block,
                s(:send,
                  s(:array,
                    s(:array,
                      s(:str, "about"),
                      s(:const,
                        s(:const,
                          s(:const,
                            s(:cbase), :RSS), :RDF), :URI),
                      s(:true)),
                    s(:array,
                      s(:str, "resource"),
                      s(:const,
                        s(:const,
                          s(:const,
                            s(:cbase), :RSS), :RDF), :URI),
                      s(:false))), :each),
                s(:args,
                  s(:arg, :name),
                  s(:arg, :uri),
                  s(:arg, :required)),
                s(:send, nil, :install_get_attribute,
                  s(:lvar, :name),
                  s(:lvar, :uri),
                  s(:lvar, :required),
                  s(:nil),
                  s(:nil),
                  s(:dstr,
                    s(:begin,
                      s(:const,
                        s(:const,
                          s(:const,
                            s(:cbase), :RSS), :RDF), :PREFIX)),
                    s(:str, ":"),
                    s(:begin,
                      s(:lvar, :name))))),
              s(:block,
                s(:send,
                  s(:array,
                    s(:str, "width"),
                    s(:str, "height")), :each),
                s(:args,
                  s(:arg, :tag)),
                s(:begin,
                  s(:lvasgn, :full_name,
                    s(:dstr,
                      s(:begin,
                        s(:const, nil, :IMAGE_PREFIX)),
                      s(:str, "_"),
                      s(:begin,
                        s(:lvar, :tag)))),
                  s(:lvasgn, :disp_name,
                    s(:dstr,
                      s(:begin,
                        s(:const, nil, :IMAGE_PREFIX)),
                      s(:str, ":"),
                      s(:begin,
                        s(:lvar, :tag)))),
                  s(:send, nil, :install_text_element,
                    s(:lvar, :tag),
                    s(:const, nil, :IMAGE_URI),
                    s(:str, "?"),
                    s(:lvar, :full_name),
                    s(:sym, :integer),
                    s(:lvar, :disp_name)),
                  s(:send,
                    s(:const, nil, :BaseListener), :install_get_text_element,
                    s(:const, nil, :IMAGE_URI),
                    s(:lvar, :tag),
                    s(:lvar, :full_name)))),
              s(:alias,
                s(:sym, :width=),
                s(:sym, :image_width=)),
              s(:alias,
                s(:sym, :width),
                s(:sym, :image_width)),
              s(:alias,
                s(:sym, :height=),
                s(:sym, :image_height=)),
              s(:alias,
                s(:sym, :height),
                s(:sym, :image_height)),
              s(:def, :initialize,
                s(:args,
                  s(:restarg, :args)),
                s(:if,
                  s(:send,
                    s(:const, nil, :Utils), :element_initialize_arguments?,
                    s(:lvar, :args)),
                  s(:zsuper),
                  s(:begin,
                    s(:super),
                    s(:send,
                      s(:self), :about=,
                      s(:send,
                        s(:lvar, :args), :[],
                        s(:int, 0))),
                    s(:send,
                      s(:self), :resource=,
                      s(:send,
                        s(:lvar, :args), :[],
                        s(:int, 1)))))),
              s(:def, :full_name,
                s(:args),
                s(:send, nil, :tag_name_with_prefix,
                  s(:const, nil, :IMAGE_PREFIX))),
              s(:send, nil, :private),
              s(:def, :maker_target,
                s(:args,
                  s(:arg, :target)),
                s(:send,
                  s(:lvar, :target), :image_item)),
              s(:def, :setup_maker_attributes,
                s(:args,
                  s(:arg, :item)),
                s(:begin,
                  s(:send,
                    s(:lvar, :item), :about=,
                    s(:send,
                      s(:self), :about)),
                  s(:send,
                    s(:lvar, :item), :resource=,
                    s(:send,
                      s(:self), :resource)))))))),
      s(:module,
        s(:const, nil, :ImageFaviconModel),
        s(:begin,
          s(:send, nil, :include,
            s(:const, nil, :ImageModelUtils)),
          s(:send, nil, :extend,
            s(:const, nil, :BaseModel)),
          s(:defs,
            s(:self), :append_features,
            s(:args,
              s(:arg, :klass)),
            s(:begin,
              s(:zsuper),
              s(:if,
                s(:send,
                  s(:send,
                    s(:lvar, :klass), :class), :==,
                  s(:const, nil, :Module)), nil,
                s(:begin,
                  s(:send,
                    s(:lvar, :klass), :install_have_child_element,
                    s(:str, "favicon"),
                    s(:const, nil, :IMAGE_URI),
                    s(:str, "?"),
                    s(:dstr,
                      s(:begin,
                        s(:const, nil, :IMAGE_PREFIX)),
                      s(:str, "_favicon"))),
                  s(:send,
                    s(:lvar, :klass), :install_must_call_validator,
                    s(:const, nil, :IMAGE_PREFIX),
                    s(:const, nil, :IMAGE_URI)))))),
          s(:class,
            s(:const, nil, :ImageFavicon),
            s(:const, nil, :Element),
            s(:begin,
              s(:send, nil, :include,
                s(:const, nil, :RSS10)),
              s(:send, nil, :include,
                s(:const, nil, :DublinCoreModel)),
              s(:ivasgn, :@tag_name,
                s(:str, "favicon")),
              s(:sclass,
                s(:self),
                s(:begin,
                  s(:def, :required_prefix,
                    s(:args),
                    s(:const, nil, :IMAGE_PREFIX)),
                  s(:def, :required_uri,
                    s(:args),
                    s(:const, nil, :IMAGE_URI)))),
              s(:block,
                s(:send,
                  s(:array,
                    s(:array,
                      s(:str, "about"),
                      s(:const,
                        s(:const,
                          s(:const,
                            s(:cbase), :RSS), :RDF), :URI),
                      s(:true),
                      s(:const,
                        s(:const,
                          s(:const,
                            s(:cbase), :RSS), :RDF), :PREFIX)),
                    s(:array,
                      s(:str, "size"),
                      s(:const, nil, :IMAGE_URI),
                      s(:true),
                      s(:const, nil, :IMAGE_PREFIX))), :each),
                s(:args,
                  s(:arg, :name),
                  s(:arg, :uri),
                  s(:arg, :required),
                  s(:arg, :prefix)),
                s(:send, nil, :install_get_attribute,
                  s(:lvar, :name),
                  s(:lvar, :uri),
                  s(:lvar, :required),
                  s(:nil),
                  s(:nil),
                  s(:dstr,
                    s(:begin,
                      s(:lvar, :prefix)),
                    s(:str, ":"),
                    s(:begin,
                      s(:lvar, :name))))),
              s(:casgn, nil, :AVAILABLE_SIZES,
                s(:array,
                  s(:str, "small"),
                  s(:str, "medium"),
                  s(:str, "large"))),
              s(:send, nil, :alias_method,
                s(:sym, :set_size),
                s(:sym, :size=)),
              s(:send, nil, :private,
                s(:sym, :set_size)),
              s(:def, :size=,
                s(:args,
                  s(:arg, :new_value)),
                s(:begin,
                  s(:if,
                    s(:and,
                      s(:ivar, :@do_validate),
                      s(:send,
                        s(:send,
                          s(:lvar, :new_value), :nil?), :!)),
                    s(:begin,
                      s(:lvasgn, :new_value,
                        s(:send,
                          s(:lvar, :new_value), :strip)),
                      s(:if,
                        s(:send,
                          s(:const, nil, :AVAILABLE_SIZES), :include?,
                          s(:lvar, :new_value)), nil,
                        s(:begin,
                          s(:lvasgn, :attr_name,
                            s(:dstr,
                              s(:begin,
                                s(:const, nil, :IMAGE_PREFIX)),
                              s(:str, ":size"))),
                          s(:send, nil, :raise,
                            s(:send,
                              s(:const, nil, :NotAvailableValueError), :new,
                              s(:send, nil, :full_name),
                              s(:lvar, :new_value),
                              s(:lvar, :attr_name)))))), nil),
                  s(:send, nil, :set_size,
                    s(:lvar, :new_value)))),
              s(:alias,
                s(:sym, :image_size=),
                s(:sym, :size=)),
              s(:alias,
                s(:sym, :image_size),
                s(:sym, :size)),
              s(:def, :initialize,
                s(:args,
                  s(:restarg, :args)),
                s(:if,
                  s(:send,
                    s(:const, nil, :Utils), :element_initialize_arguments?,
                    s(:lvar, :args)),
                  s(:zsuper),
                  s(:begin,
                    s(:super),
                    s(:send,
                      s(:self), :about=,
                      s(:send,
                        s(:lvar, :args), :[],
                        s(:int, 0))),
                    s(:send,
                      s(:self), :size=,
                      s(:send,
                        s(:lvar, :args), :[],
                        s(:int, 1)))))),
              s(:def, :full_name,
                s(:args),
                s(:send, nil, :tag_name_with_prefix,
                  s(:const, nil, :IMAGE_PREFIX))),
              s(:send, nil, :private),
              s(:def, :maker_target,
                s(:args,
                  s(:arg, :target)),
                s(:send,
                  s(:lvar, :target), :image_favicon)),
              s(:def, :setup_maker_attributes,
                s(:args,
                  s(:arg, :favicon)),
                s(:begin,
                  s(:send,
                    s(:lvar, :favicon), :about=,
                    s(:send,
                      s(:self), :about)),
                  s(:send,
                    s(:lvar, :favicon), :size=,
                    s(:send,
                      s(:self), :size)))))))),
      s(:class,
        s(:const, nil, :RDF), nil,
        s(:begin,
          s(:class,
            s(:const, nil, :Channel), nil,
            s(:send, nil, :include,
              s(:const, nil, :ImageFaviconModel))),
          s(:class,
            s(:const, nil, :Item), nil,
            s(:send, nil, :include,
              s(:const, nil, :ImageItemModel))))))))
