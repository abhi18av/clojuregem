s(:module,
  s(:const, nil, :WEBrick),
  s(:class,
    s(:const, nil, :HTTPVersion), nil,
    s(:begin,
      s(:send, nil, :include,
        s(:const, nil, :Comparable)),
      s(:send, nil, :attr_accessor,
        s(:sym, :major)),
      s(:send, nil, :attr_accessor,
        s(:sym, :minor)),
      s(:defs,
        s(:self), :convert,
        s(:args,
          s(:arg, :version)),
        s(:if,
          s(:send,
            s(:lvar, :version), :is_a?,
            s(:self)),
          s(:lvar, :version),
          s(:send, nil, :new,
            s(:lvar, :version)))),
      s(:def, :initialize,
        s(:args,
          s(:arg, :version)),
        s(:begin,
          s(:case,
            s(:lvar, :version),
            s(:when,
              s(:const, nil, :HTTPVersion),
              s(:masgn,
                s(:mlhs,
                  s(:ivasgn, :@major),
                  s(:ivasgn, :@minor)),
                s(:array,
                  s(:send,
                    s(:lvar, :version), :major),
                  s(:send,
                    s(:lvar, :version), :minor)))),
            s(:when,
              s(:const, nil, :String),
              s(:if,
                s(:match_with_lvasgn,
                  s(:regexp,
                    s(:str, "^(\\d+)\\.(\\d+)$"),
                    s(:regopt)),
                  s(:lvar, :version)),
                s(:masgn,
                  s(:mlhs,
                    s(:ivasgn, :@major),
                    s(:ivasgn, :@minor)),
                  s(:array,
                    s(:send,
                      s(:nth_ref, 1), :to_i),
                    s(:send,
                      s(:nth_ref, 2), :to_i))), nil)), nil),
          s(:if,
            s(:or,
              s(:send,
                s(:ivar, :@major), :nil?),
              s(:send,
                s(:ivar, :@minor), :nil?)),
            s(:send, nil, :raise,
              s(:const, nil, :ArgumentError),
              s(:send, nil, :format,
                s(:str, "cannot convert %s into %s"),
                s(:send,
                  s(:lvar, :version), :class),
                s(:send,
                  s(:self), :class))), nil))),
      s(:def, :<=>,
        s(:args,
          s(:arg, :other)),
        s(:begin,
          s(:if,
            s(:send,
              s(:lvar, :other), :is_a?,
              s(:send,
                s(:self), :class)), nil,
            s(:lvasgn, :other,
              s(:send,
                s(:send,
                  s(:self), :class), :new,
                s(:lvar, :other)))),
          s(:if,
            s(:send,
              s(:begin,
                s(:lvasgn, :ret,
                  s(:send,
                    s(:ivar, :@major), :<=>,
                    s(:send,
                      s(:lvar, :other), :major)))), :==,
              s(:int, 0)),
            s(:return,
              s(:send,
                s(:ivar, :@minor), :<=>,
                s(:send,
                  s(:lvar, :other), :minor))), nil),
          s(:return,
            s(:lvar, :ret)))),
      s(:def, :to_s,
        s(:args),
        s(:send, nil, :format,
          s(:str, "%d.%d"),
          s(:ivar, :@major),
          s(:ivar, :@minor))))))
