s(:module,
  s(:const, nil, :REXML),
  s(:class,
    s(:const, nil, :SyncEnumerator), nil,
    s(:begin,
      s(:send, nil, :include,
        s(:const, nil, :Enumerable)),
      s(:def, :initialize,
        s(:args,
          s(:restarg, :enums)),
        s(:begin,
          s(:ivasgn, :@gens,
            s(:lvar, :enums)),
          s(:ivasgn, :@length,
            s(:send,
              s(:block,
                s(:send,
                  s(:ivar, :@gens), :collect),
                s(:args,
                  s(:arg, :x)),
                s(:send,
                  s(:lvar, :x), :size)), :max)))),
      s(:def, :size,
        s(:args),
        s(:send,
          s(:ivar, :@gens), :size)),
      s(:def, :length,
        s(:args),
        s(:send,
          s(:ivar, :@gens), :length)),
      s(:def, :each,
        s(:args),
        s(:begin,
          s(:block,
            s(:send,
              s(:ivar, :@length), :times),
            s(:args,
              s(:arg, :i)),
            s(:yield,
              s(:block,
                s(:send,
                  s(:ivar, :@gens), :collect),
                s(:args,
                  s(:arg, :x)),
                s(:send,
                  s(:lvar, :x), :[],
                  s(:lvar, :i))))),
          s(:self))))))
