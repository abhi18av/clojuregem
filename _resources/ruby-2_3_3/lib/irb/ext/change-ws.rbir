s(:module,
  s(:const, nil, :IRB),
  s(:class,
    s(:const, nil, :Context), nil,
    s(:begin,
      s(:def, :home_workspace,
        s(:args),
        s(:if,
          s(:defined?,
            s(:ivar, :@home_workspace)),
          s(:ivar, :@home_workspace),
          s(:ivasgn, :@home_workspace,
            s(:ivar, :@workspace)))),
      s(:def, :change_workspace,
        s(:args,
          s(:restarg, :_main)),
        s(:begin,
          s(:if,
            s(:send,
              s(:lvar, :_main), :empty?),
            s(:begin,
              s(:ivasgn, :@workspace,
                s(:send, nil, :home_workspace)),
              s(:return,
                s(:send, nil, :main))), nil),
          s(:ivasgn, :@workspace,
            s(:send,
              s(:const, nil, :WorkSpace), :new,
              s(:send,
                s(:lvar, :_main), :[],
                s(:int, 0)))),
          s(:if,
            s(:send,
              s(:send,
                s(:begin,
                  s(:sclass,
                    s(:send, nil, :main),
                    s(:send, nil, :ancestors))), :include?,
                s(:const, nil, :ExtendCommandBundle)), :!),
            s(:send,
              s(:send, nil, :main), :extend,
              s(:const, nil, :ExtendCommandBundle)), nil))))))
