s(:begin,
  s(:lvasgn, :num,
    s(:int, 500)),
  s(:lvasgn, :count,
    s(:lvasgn, :i,
      s(:lvasgn, :j,
        s(:int, 0)))),
  s(:lvasgn, :flags0,
    s(:send,
      s(:const, nil, :Array), :new,
      s(:int, 8192),
      s(:int, 1))),
  s(:lvasgn, :k,
    s(:int, 0)),
  s(:while,
    s(:send,
      s(:lvar, :k), :<,
      s(:lvar, :num)),
    s(:begin,
      s(:op_asgn,
        s(:lvasgn, :k), :+,
        s(:int, 1)),
      s(:lvasgn, :count,
        s(:int, 0)),
      s(:lvasgn, :flags,
        s(:send,
          s(:lvar, :flags0), :dup)),
      s(:lvasgn, :i,
        s(:int, 2)),
      s(:while,
        s(:send,
          s(:lvar, :i), :<,
          s(:int, 8192)),
        s(:begin,
          s(:op_asgn,
            s(:lvasgn, :i), :+,
            s(:int, 1)),
          s(:if,
            s(:send,
              s(:lvar, :flags), :[],
              s(:lvar, :i)),
            s(:begin,
              s(:lvasgn, :j,
                s(:send,
                  s(:lvar, :i), :*,
                  s(:lvar, :i))),
              s(:while,
                s(:send,
                  s(:lvar, :j), :<,
                  s(:int, 8192)),
                s(:begin,
                  s(:op_asgn,
                    s(:lvasgn, :j), :+,
                    s(:lvar, :i)),
                  s(:send,
                    s(:lvar, :flags), :[]=,
                    s(:lvar, :j),
                    s(:nil)))),
              s(:op_asgn,
                s(:lvasgn, :count), :+,
                s(:int, 1))), nil))))),
  s(:lvar, :count))
