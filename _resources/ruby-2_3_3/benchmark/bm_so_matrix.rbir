s(:begin,
  s(:lvasgn, :n,
    s(:int, 60)),
  s(:lvasgn, :size,
    s(:int, 40)),
  s(:def, :mkmatrix,
    s(:args,
      s(:arg, :rows),
      s(:arg, :cols)),
    s(:begin,
      s(:lvasgn, :count,
        s(:int, 1)),
      s(:lvasgn, :mx,
        s(:send,
          s(:const, nil, :Array), :new,
          s(:lvar, :rows))),
      s(:block,
        s(:send,
          s(:begin,
            s(:irange,
              s(:int, 0),
              s(:begin,
                s(:send,
                  s(:lvar, :rows), :-,
                  s(:int, 1))))), :each),
        s(:args,
          s(:arg, :bi)),
        s(:begin,
          s(:lvasgn, :row,
            s(:send,
              s(:const, nil, :Array), :new,
              s(:lvar, :cols),
              s(:int, 0))),
          s(:block,
            s(:send,
              s(:begin,
                s(:irange,
                  s(:int, 0),
                  s(:begin,
                    s(:send,
                      s(:lvar, :cols), :-,
                      s(:int, 1))))), :each),
            s(:args,
              s(:arg, :j)),
            s(:begin,
              s(:send,
                s(:lvar, :row), :[]=,
                s(:lvar, :j),
                s(:lvar, :count)),
              s(:op_asgn,
                s(:lvasgn, :count), :+,
                s(:int, 1)))),
          s(:send,
            s(:lvar, :mx), :[]=,
            s(:lvar, :bi),
            s(:lvar, :row)))),
      s(:lvar, :mx))),
  s(:def, :mmult,
    s(:args,
      s(:arg, :rows),
      s(:arg, :cols),
      s(:arg, :m1),
      s(:arg, :m2)),
    s(:begin,
      s(:lvasgn, :m3,
        s(:send,
          s(:const, nil, :Array), :new,
          s(:lvar, :rows))),
      s(:block,
        s(:send,
          s(:begin,
            s(:irange,
              s(:int, 0),
              s(:begin,
                s(:send,
                  s(:lvar, :rows), :-,
                  s(:int, 1))))), :each),
        s(:args,
          s(:arg, :bi)),
        s(:begin,
          s(:lvasgn, :row,
            s(:send,
              s(:const, nil, :Array), :new,
              s(:lvar, :cols),
              s(:int, 0))),
          s(:block,
            s(:send,
              s(:begin,
                s(:irange,
                  s(:int, 0),
                  s(:begin,
                    s(:send,
                      s(:lvar, :cols), :-,
                      s(:int, 1))))), :each),
            s(:args,
              s(:arg, :j)),
            s(:begin,
              s(:lvasgn, :val,
                s(:int, 0)),
              s(:block,
                s(:send,
                  s(:begin,
                    s(:irange,
                      s(:int, 0),
                      s(:begin,
                        s(:send,
                          s(:lvar, :cols), :-,
                          s(:int, 1))))), :each),
                s(:args,
                  s(:arg, :k)),
                s(:op_asgn,
                  s(:lvasgn, :val), :+,
                  s(:send,
                    s(:send,
                      s(:send,
                        s(:lvar, :m1), :at,
                        s(:lvar, :bi)), :at,
                      s(:lvar, :k)), :*,
                    s(:send,
                      s(:send,
                        s(:lvar, :m2), :at,
                        s(:lvar, :k)), :at,
                      s(:lvar, :j))))),
              s(:send,
                s(:lvar, :row), :[]=,
                s(:lvar, :j),
                s(:lvar, :val)))),
          s(:send,
            s(:lvar, :m3), :[]=,
            s(:lvar, :bi),
            s(:lvar, :row)))),
      s(:lvar, :m3))),
  s(:lvasgn, :m1,
    s(:send, nil, :mkmatrix,
      s(:lvar, :size),
      s(:lvar, :size))),
  s(:lvasgn, :m2,
    s(:send, nil, :mkmatrix,
      s(:lvar, :size),
      s(:lvar, :size))),
  s(:lvasgn, :mm,
    s(:send,
      s(:const, nil, :Array), :new)),
  s(:block,
    s(:send,
      s(:lvar, :n), :times),
    s(:args),
    s(:lvasgn, :mm,
      s(:send, nil, :mmult,
        s(:lvar, :size),
        s(:lvar, :size),
        s(:lvar, :m1),
        s(:lvar, :m2)))))
