s(:begin,
  s(:gvasgn, :$HI,
    s(:int, 0)),
  s(:gvasgn, :$LO,
    s(:int, 0)),
  s(:casgn, nil, :NUM,
    s(:int, 250000)),
  s(:class,
    s(:const, nil, :Lo_Exception),
    s(:const, nil, :Exception),
    s(:def, :initialize,
      s(:args,
        s(:arg, :num)),
      s(:ivasgn, :@value,
        s(:lvar, :num)))),
  s(:class,
    s(:const, nil, :Hi_Exception),
    s(:const, nil, :Exception),
    s(:def, :initialize,
      s(:args,
        s(:arg, :num)),
      s(:ivasgn, :@value,
        s(:lvar, :num)))),
  s(:def, :some_function,
    s(:args,
      s(:arg, :num)),
    s(:kwbegin,
      s(:rescue,
        s(:send, nil, :hi_function,
          s(:lvar, :num)),
        s(:resbody, nil, nil,
          s(:send, nil, :print,
            s(:dstr,
              s(:str, "We shouldn't get here, exception is: "),
              s(:begin,
                s(:send,
                  s(:gvar, :$!), :type)),
              s(:str, "\n")))), nil))),
  s(:def, :hi_function,
    s(:args,
      s(:arg, :num)),
    s(:kwbegin,
      s(:rescue,
        s(:send, nil, :lo_function,
          s(:lvar, :num)),
        s(:resbody,
          s(:array,
            s(:const, nil, :Hi_Exception)), nil,
          s(:gvasgn, :$HI,
            s(:send,
              s(:gvar, :$HI), :+,
              s(:int, 1)))), nil))),
  s(:def, :lo_function,
    s(:args,
      s(:arg, :num)),
    s(:kwbegin,
      s(:rescue,
        s(:send, nil, :blowup,
          s(:lvar, :num)),
        s(:resbody,
          s(:array,
            s(:const, nil, :Lo_Exception)), nil,
          s(:gvasgn, :$LO,
            s(:send,
              s(:gvar, :$LO), :+,
              s(:int, 1)))), nil))),
  s(:def, :blowup,
    s(:args,
      s(:arg, :num)),
    s(:if,
      s(:send,
        s(:send,
          s(:lvar, :num), :%,
          s(:int, 2)), :==,
        s(:int, 0)),
      s(:send, nil, :raise,
        s(:send,
          s(:const, nil, :Lo_Exception), :new,
          s(:lvar, :num))),
      s(:send, nil, :raise,
        s(:send,
          s(:const, nil, :Hi_Exception), :new,
          s(:lvar, :num))))),
  s(:lvasgn, :i,
    s(:int, 1)),
  s(:lvasgn, :max,
    s(:send,
      s(:const, nil, :NUM), :+,
      s(:int, 1))),
  s(:while,
    s(:send,
      s(:lvar, :i), :<,
      s(:lvar, :max)),
    s(:begin,
      s(:op_asgn,
        s(:lvasgn, :i), :+,
        s(:int, 1)),
      s(:send, nil, :some_function,
        s(:send,
          s(:lvar, :i), :+,
          s(:int, 1))))))
