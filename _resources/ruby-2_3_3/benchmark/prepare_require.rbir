s(:begin,
  s(:send, nil, :require,
    s(:str, "fileutils")),
  s(:def, :prepare,
    s(:args),
    s(:begin,
      s(:lvasgn, :num_files,
        s(:int, 10000)),
      s(:lvasgn, :basename,
        s(:send,
          s(:const, nil, :File), :dirname,
          s(:gvar, :$0))),
      s(:lvasgn, :data_dir,
        s(:send,
          s(:const, nil, :File), :join,
          s(:lvar, :basename),
          s(:str, "bm_require.data"))),
      s(:if,
        s(:send,
          s(:const, nil, :File), :exist?,
          s(:send,
            s(:const, nil, :File), :join,
            s(:lvar, :data_dir),
            s(:dstr,
              s(:str, "c"),
              s(:begin,
                s(:lvar, :num_files)),
              s(:str, ".rb")))),
        s(:return), nil),
      s(:send,
        s(:const, nil, :FileUtils), :mkdir_p,
        s(:lvar, :data_dir)),
      s(:block,
        s(:send,
          s(:int, 1), :upto,
          s(:lvar, :num_files)),
        s(:args,
          s(:arg, :i)),
        s(:begin,
          s(:lvasgn, :f,
            s(:send,
              s(:const, nil, :File), :open,
              s(:dstr,
                s(:begin,
                  s(:lvar, :data_dir)),
                s(:str, "/c"),
                s(:begin,
                  s(:lvar, :i)),
                s(:str, ".rb")),
              s(:str, "w"))),
          s(:send,
            s(:lvar, :f), :puts,
            s(:dstr,
              s(:str, "      class C"),
              s(:begin,
                s(:lvar, :i)),
              s(:str, "\n"),
              s(:str, "      end\n"))))))),
  s(:send, nil, :prepare))
