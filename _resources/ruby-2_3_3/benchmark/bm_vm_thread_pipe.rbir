s(:begin,
  s(:lvasgn, :lmax,
    s(:int, 100000)),
  s(:masgn,
    s(:mlhs,
      s(:lvasgn, :r),
      s(:lvasgn, :w)),
    s(:send,
      s(:const, nil, :IO), :pipe)),
  s(:block,
    s(:send,
      s(:array,
        s(:block,
          s(:send,
            s(:const, nil, :Thread), :new),
          s(:args),
          s(:begin,
            s(:block,
              s(:send,
                s(:lvar, :lmax), :times),
              s(:args),
              s(:send,
                s(:lvar, :w), :write,
                s(:str, "a"))),
            s(:send, nil, :p,
              s(:str, "w:exit")))),
        s(:block,
          s(:send,
            s(:const, nil, :Thread), :new),
          s(:args),
          s(:begin,
            s(:block,
              s(:send,
                s(:lvar, :lmax), :times),
              s(:args),
              s(:send,
                s(:lvar, :r), :read,
                s(:int, 1))),
            s(:send, nil, :p,
              s(:str, "r:exit"))))), :each),
    s(:args,
      s(:arg, :t)),
    s(:send,
      s(:lvar, :t), :join)))
