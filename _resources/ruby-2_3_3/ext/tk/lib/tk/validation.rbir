s(:begin,
  s(:send, nil, :require,
    s(:str, "tk")),
  s(:module,
    s(:const, nil, :Tk),
    s(:begin,
      s(:module,
        s(:const, nil, :ValidateConfigure),
        s(:begin,
          s(:defs,
            s(:self), :__def_validcmd,
            s(:args,
              s(:arg, :scope),
              s(:arg, :klass),
              s(:optarg, :keys,
                s(:nil))),
            s(:begin,
              s(:if,
                s(:lvar, :keys), nil,
                s(:lvasgn, :keys,
                  s(:send,
                    s(:lvar, :klass), :_config_keys))),
              s(:block,
                s(:send,
                  s(:lvar, :keys), :each),
                s(:args,
                  s(:arg, :key)),
                s(:send, nil, :eval,
                  s(:dstr,
                    s(:str, "def "),
                    s(:begin,
                      s(:lvar, :key)),
                    s(:str, "(*args, &b)\n"),
                    s(:str, "                 __validcmd_call("),
                    s(:begin,
                      s(:send,
                        s(:lvar, :klass), :name)),
                    s(:str, ", '"),
                    s(:begin,
                      s(:lvar, :key)),
                    s(:str, "', *args, &b)\n"),
                    s(:str, "              end")),
                  s(:lvar, :scope))))),
          s(:def, :__validcmd_call,
            s(:args,
              s(:arg, :klass),
              s(:arg, :key),
              s(:restarg, :args),
              s(:blockarg, :b)),
            s(:begin,
              s(:if,
                s(:and,
                  s(:send,
                    s(:lvar, :args), :empty?),
                  s(:send,
                    s(:lvar, :b), :!)),
                s(:return,
                  s(:send, nil, :cget,
                    s(:lvar, :key))), nil),
              s(:lvasgn, :cmd,
                s(:if,
                  s(:begin,
                    s(:lvar, :b)),
                  s(:send, nil, :proc,
                    s(:block_pass,
                      s(:lvar, :b))),
                  s(:send,
                    s(:lvar, :args), :shift))),
              s(:if,
                s(:send,
                  s(:lvar, :cmd), :kind_of?,
                  s(:lvar, :klass)),
                s(:send, nil, :configure,
                  s(:lvar, :key),
                  s(:lvar, :cmd)),
                s(:if,
                  s(:send,
                    s(:send,
                      s(:lvar, :args), :empty?), :!),
                  s(:send, nil, :configure,
                    s(:lvar, :key),
                    s(:array,
                      s(:lvar, :cmd),
                      s(:lvar, :args))),
                  s(:send, nil, :configure,
                    s(:lvar, :key),
                    s(:lvar, :cmd)))))),
          s(:def, :__validation_class_list,
            s(:args),
            s(:array)),
          s(:def, :__get_validate_key2class,
            s(:args),
            s(:begin,
              s(:lvasgn, :k2c,
                s(:hash)),
              s(:block,
                s(:send,
                  s(:send, nil, :__validation_class_list), :each),
                s(:args,
                  s(:arg, :klass)),
                s(:block,
                  s(:send,
                    s(:send,
                      s(:lvar, :klass), :_config_keys), :each),
                  s(:args,
                    s(:arg, :key)),
                  s(:send,
                    s(:lvar, :k2c), :[]=,
                    s(:send,
                      s(:lvar, :key), :to_s),
                    s(:lvar, :klass)))),
              s(:lvar, :k2c))),
          s(:def, :__conv_vcmd_on_hash_kv,
            s(:args,
              s(:arg, :keys)),
            s(:begin,
              s(:lvasgn, :key2class,
                s(:send, nil, :__get_validate_key2class)),
              s(:lvasgn, :keys,
                s(:send, nil, :_symbolkey2str,
                  s(:lvar, :keys))),
              s(:block,
                s(:send,
                  s(:lvar, :key2class), :each),
                s(:args,
                  s(:arg, :key),
                  s(:arg, :klass)),
                s(:if,
                  s(:send,
                    s(:send,
                      s(:lvar, :keys), :[],
                      s(:lvar, :key)), :kind_of?,
                    s(:const, nil, :Array)),
                  s(:begin,
                    s(:masgn,
                      s(:mlhs,
                        s(:lvasgn, :cmd),
                        s(:splat,
                          s(:lvasgn, :args))),
                      s(:send,
                        s(:lvar, :keys), :[],
                        s(:lvar, :key))),
                    s(:send,
                      s(:lvar, :keys), :[]=,
                      s(:lvar, :key),
                      s(:send,
                        s(:lvar, :klass), :new,
                        s(:lvar, :cmd),
                        s(:splat,
                          s(:lvar, :args))))),
                  s(:if,
                    s(:send,
                      s(:const, nil, :TkComm), :_callback_entry?,
                      s(:send,
                        s(:lvar, :keys), :[],
                        s(:lvar, :key))),
                    s(:send,
                      s(:lvar, :keys), :[]=,
                      s(:lvar, :key),
                      s(:send,
                        s(:lvar, :klass), :new,
                        s(:send,
                          s(:lvar, :keys), :[],
                          s(:lvar, :key)))), nil))),
              s(:lvar, :keys))),
          s(:def, :create_self,
            s(:args,
              s(:arg, :keys)),
            s(:super,
              s(:send, nil, :__conv_vcmd_on_hash_kv,
                s(:lvar, :keys)))),
          s(:send, nil, :private,
            s(:sym, :create_self)),
          s(:def, :configure,
            s(:args,
              s(:arg, :slot),
              s(:optarg, :value,
                s(:const,
                  s(:const, nil, :TkComm), :None))),
            s(:begin,
              s(:if,
                s(:send,
                  s(:lvar, :slot), :kind_of?,
                  s(:const, nil, :Hash)),
                s(:super,
                  s(:send, nil, :__conv_vcmd_on_hash_kv,
                    s(:lvar, :slot))),
                s(:super,
                  s(:send, nil, :__conv_vcmd_on_hash_kv,
                    s(:hash,
                      s(:pair,
                        s(:lvar, :slot),
                        s(:lvar, :value)))))),
              s(:self))))),
      s(:module,
        s(:const, nil, :ItemValidateConfigure),
        s(:begin,
          s(:defs,
            s(:self), :__def_validcmd,
            s(:args,
              s(:arg, :scope),
              s(:arg, :klass),
              s(:optarg, :keys,
                s(:nil))),
            s(:begin,
              s(:if,
                s(:lvar, :keys), nil,
                s(:lvasgn, :keys,
                  s(:send,
                    s(:lvar, :klass), :_config_keys))),
              s(:block,
                s(:send,
                  s(:lvar, :keys), :each),
                s(:args,
                  s(:arg, :key)),
                s(:send, nil, :eval,
                  s(:dstr,
                    s(:str, "def item_"),
                    s(:begin,
                      s(:lvar, :key)),
                    s(:str, "(id, *args, &b)\n"),
                    s(:str, "                 __item_validcmd_call("),
                    s(:begin,
                      s(:send,
                        s(:lvar, :klass), :name)),
                    s(:str, ", '"),
                    s(:begin,
                      s(:lvar, :key)),
                    s(:str, "', id, *args, &b)\n"),
                    s(:str, "              end")),
                  s(:lvar, :scope))))),
          s(:def, :__item_validcmd_call,
            s(:args,
              s(:arg, :tagOrId),
              s(:arg, :klass),
              s(:arg, :key),
              s(:restarg, :args),
              s(:blockarg, :b)),
            s(:begin,
              s(:if,
                s(:and,
                  s(:send,
                    s(:lvar, :args), :empty?),
                  s(:send,
                    s(:lvar, :b), :!)),
                s(:return,
                  s(:send, nil, :itemcget,
                    s(:send, nil, :tagid,
                      s(:lvar, :tagOrId)),
                    s(:lvar, :key))), nil),
              s(:lvasgn, :cmd,
                s(:if,
                  s(:begin,
                    s(:lvar, :b)),
                  s(:send, nil, :proc,
                    s(:block_pass,
                      s(:lvar, :b))),
                  s(:send,
                    s(:lvar, :args), :shift))),
              s(:if,
                s(:send,
                  s(:lvar, :cmd), :kind_of?,
                  s(:lvar, :klass)),
                s(:send, nil, :itemconfigure,
                  s(:send, nil, :tagid,
                    s(:lvar, :tagOrId)),
                  s(:lvar, :key),
                  s(:lvar, :cmd)),
                s(:if,
                  s(:send,
                    s(:send,
                      s(:lvar, :args), :empty?), :!),
                  s(:send, nil, :itemconfigure,
                    s(:send, nil, :tagid,
                      s(:lvar, :tagOrId)),
                    s(:lvar, :key),
                    s(:array,
                      s(:lvar, :cmd),
                      s(:lvar, :args))),
                  s(:send, nil, :itemconfigure,
                    s(:send, nil, :tagid,
                      s(:lvar, :tagOrId)),
                    s(:lvar, :key),
                    s(:lvar, :cmd)))))),
          s(:def, :__item_validation_class_list,
            s(:args,
              s(:arg, :id)),
            s(:array)),
          s(:def, :__get_item_validate_key2class,
            s(:args,
              s(:arg, :id)),
            s(:begin,
              s(:lvasgn, :k2c,
                s(:hash)),
              s(:block,
                s(:send,
                  s(:send, nil, :__item_validation_class_list,
                    s(:lvar, :id)), :each),
                s(:args,
                  s(:arg, :klass)),
                s(:block,
                  s(:send,
                    s(:send,
                      s(:lvar, :klass), :_config_keys), :each),
                  s(:args,
                    s(:arg, :key)),
                  s(:send,
                    s(:lvar, :k2c), :[]=,
                    s(:send,
                      s(:lvar, :key), :to_s),
                    s(:lvar, :klass)))))),
          s(:def, :__conv_item_vcmd_on_hash_kv,
            s(:args,
              s(:arg, :keys)),
            s(:begin,
              s(:lvasgn, :key2class,
                s(:send, nil, :__get_item_validate_key2class,
                  s(:send, nil, :tagid,
                    s(:send, nil, :tagOrId)))),
              s(:lvasgn, :keys,
                s(:send, nil, :_symbolkey2str,
                  s(:lvar, :keys))),
              s(:block,
                s(:send,
                  s(:lvar, :key2class), :each),
                s(:args,
                  s(:arg, :key),
                  s(:arg, :klass)),
                s(:if,
                  s(:send,
                    s(:send,
                      s(:lvar, :keys), :[],
                      s(:lvar, :key)), :kind_of?,
                    s(:const, nil, :Array)),
                  s(:begin,
                    s(:masgn,
                      s(:mlhs,
                        s(:lvasgn, :cmd),
                        s(:splat,
                          s(:lvasgn, :args))),
                      s(:send,
                        s(:lvar, :keys), :[],
                        s(:lvar, :key))),
                    s(:send,
                      s(:lvar, :keys), :[]=,
                      s(:lvar, :key),
                      s(:send,
                        s(:lvar, :klass), :new,
                        s(:lvar, :cmd),
                        s(:splat,
                          s(:lvar, :args))))),
                  s(:if,
                    s(:send,
                      s(:const, nil, :TkComm), :_callback_entry?,
                      s(:send,
                        s(:lvar, :keys), :[],
                        s(:lvar, :key))),
                    s(:send,
                      s(:lvar, :keys), :[]=,
                      s(:lvar, :key),
                      s(:send,
                        s(:lvar, :klass), :new,
                        s(:send,
                          s(:lvar, :keys), :[],
                          s(:lvar, :key)))), nil))),
              s(:lvar, :keys))),
          s(:def, :itemconfigure,
            s(:args,
              s(:arg, :tagOrId),
              s(:arg, :slot),
              s(:optarg, :value,
                s(:const,
                  s(:const, nil, :TkComm), :None))),
            s(:begin,
              s(:if,
                s(:send,
                  s(:lvar, :slot), :kind_of?,
                  s(:const, nil, :Hash)),
                s(:super,
                  s(:send, nil, :__conv_item_vcmd_on_hash_kv,
                    s(:lvar, :slot))),
                s(:super,
                  s(:send, nil, :__conv_item_vcmd_on_hash_kv,
                    s(:hash,
                      s(:pair,
                        s(:lvar, :slot),
                        s(:lvar, :value)))))),
              s(:self))))))),
  s(:class,
    s(:const, nil, :TkValidateCommand), nil,
    s(:begin,
      s(:send, nil, :include,
        s(:const, nil, :TkComm)),
      s(:send, nil, :extend,
        s(:const, nil, :TkComm)),
      s(:class,
        s(:const, nil, :ValidateArgs),
        s(:const,
          s(:const, nil, :TkUtil), :CallbackSubst),
        s(:begin,
          s(:casgn, nil, :KEY_TBL,
            s(:array,
              s(:array,
                s(:str, "d"),
                s(:str, "n"),
                s(:sym, :action)),
              s(:array,
                s(:str, "i"),
                s(:str, "x"),
                s(:sym, :index)),
              s(:array,
                s(:str, "s"),
                s(:str, "e"),
                s(:sym, :current)),
              s(:array,
                s(:str, "v"),
                s(:str, "s"),
                s(:sym, :type)),
              s(:array,
                s(:str, "P"),
                s(:str, "e"),
                s(:sym, :value)),
              s(:array,
                s(:str, "S"),
                s(:str, "e"),
                s(:sym, :string)),
              s(:array,
                s(:str, "V"),
                s(:str, "s"),
                s(:sym, :triggered)),
              s(:array,
                s(:str, "W"),
                s(:str, "w"),
                s(:sym, :widget)),
              s(:nil))),
          s(:casgn, nil, :PROC_TBL,
            s(:array,
              s(:array,
                s(:str, "n"),
                s(:send,
                  s(:const, nil, :TkComm), :method,
                  s(:sym, :number))),
              s(:array,
                s(:str, "s"),
                s(:send,
                  s(:const, nil, :TkComm), :method,
                  s(:sym, :string))),
              s(:array,
                s(:str, "w"),
                s(:send,
                  s(:const, nil, :TkComm), :method,
                  s(:sym, :window))),
              s(:array,
                s(:str, "e"),
                s(:block,
                  s(:send, nil, :proc),
                  s(:args,
                    s(:arg, :val)),
                  s(:begin,
                    s(:lvasgn, :enc,
                      s(:begin,
                        s(:if,
                          s(:begin,
                            s(:send,
                              s(:const, nil, :Tk), :encoding)),
                          s(:send,
                            s(:const, nil, :Tk), :encoding),
                          s(:send,
                            s(:const, nil, :Tk), :encoding_system)))),
                    s(:if,
                      s(:lvar, :enc),
                      s(:send,
                        s(:const, nil, :Tk), :fromUTF8,
                        s(:send,
                          s(:const, nil, :TkComm), :string,
                          s(:lvar, :val)),
                        s(:lvar, :enc)),
                      s(:send,
                        s(:const, nil, :TkComm), :string,
                        s(:lvar, :val)))))),
              s(:array,
                s(:str, "x"),
                s(:block,
                  s(:send, nil, :proc),
                  s(:args,
                    s(:arg, :val)),
                  s(:begin,
                    s(:lvasgn, :idx,
                      s(:send,
                        s(:const, nil, :TkComm), :number,
                        s(:lvar, :val))),
                    s(:if,
                      s(:send,
                        s(:lvar, :idx), :<,
                        s(:int, 0)),
                      s(:nil),
                      s(:lvar, :idx))))),
              s(:nil))),
          s(:send, nil, :_setup_subst_table,
            s(:const, nil, :KEY_TBL),
            s(:const, nil, :PROC_TBL)),
          s(:defs,
            s(:self), :ret_val,
            s(:args,
              s(:arg, :val)),
            s(:if,
              s(:begin,
                s(:lvar, :val)),
              s(:str, "1"),
              s(:str, "0"))))),
      s(:defs,
        s(:self), :_config_keys,
        s(:args),
        s(:array,
          s(:str, "vcmd"),
          s(:str, "validatecommand"),
          s(:str, "invcmd"),
          s(:str, "invalidcommand"))),
      s(:def, :_initialize_for_cb_class,
        s(:args,
          s(:arg, :klass),
          s(:optarg, :cmd,
            s(:send,
              s(:const, nil, :Proc), :new)),
          s(:restarg, :args)),
        s(:begin,
          s(:lvasgn, :extra_args_tbl,
            s(:send,
              s(:lvar, :klass), :_get_extra_args_tbl)),
          s(:if,
            s(:send,
              s(:send,
                s(:send,
                  s(:lvar, :args), :compact), :size), :>,
              s(:int, 0)),
            s(:begin,
              s(:block,
                s(:send,
                  s(:lvar, :args), :map!),
                s(:args,
                  s(:arg, :arg)),
                s(:send,
                  s(:lvar, :klass), :_sym2subst,
                  s(:lvar, :arg))),
              s(:lvasgn, :args,
                s(:send,
                  s(:lvar, :args), :join,
                  s(:str, " "))),
              s(:lvasgn, :keys,
                s(:send,
                  s(:lvar, :klass), :_get_subst_key,
                  s(:lvar, :args))),
              s(:if,
                s(:send,
                  s(:lvar, :cmd), :kind_of?,
                  s(:const, nil, :String)),
                s(:lvasgn, :id,
                  s(:lvar, :cmd)),
                s(:if,
                  s(:send,
                    s(:lvar, :cmd), :kind_of?,
                    s(:const, nil, :TkCallbackEntry)),
                  s(:ivasgn, :@id,
                    s(:send, nil, :install_cmd,
                      s(:lvar, :cmd))),
                  s(:ivasgn, :@id,
                    s(:send,
                      s(:send,
                        s(:send, nil, :install_cmd,
                          s(:block,
                            s(:send, nil, :proc),
                            s(:args,
                              s(:restarg, :arg)),
                            s(:begin,
                              s(:lvasgn, :ex_args,
                                s(:array)),
                              s(:block,
                                s(:send,
                                  s(:lvar, :extra_args_tbl), :reverse_each),
                                s(:args,
                                  s(:arg, :conv)),
                                s(:send,
                                  s(:lvar, :ex_args), :<<,
                                  s(:send,
                                    s(:lvar, :conv), :call,
                                    s(:send,
                                      s(:lvar, :arg), :pop)))),
                              s(:send,
                                s(:lvar, :klass), :ret_val,
                                s(:send,
                                  s(:lvar, :cmd), :call,
                                  s(:splat,
                                    s(:begin,
                                      s(:send,
                                        s(:lvar, :ex_args), :concat,
                                        s(:send,
                                          s(:lvar, :klass), :scan_args,
                                          s(:lvar, :keys),
                                          s(:lvar, :arg)))))))))), :+,
                        s(:str, " ")), :+,
                      s(:lvar, :args)))))),
            s(:begin,
              s(:masgn,
                s(:mlhs,
                  s(:lvasgn, :keys),
                  s(:lvasgn, :args)),
                s(:send,
                  s(:lvar, :klass), :_get_all_subst_keys)),
              s(:if,
                s(:send,
                  s(:lvar, :cmd), :kind_of?,
                  s(:const, nil, :String)),
                s(:lvasgn, :id,
                  s(:lvar, :cmd)),
                s(:if,
                  s(:send,
                    s(:lvar, :cmd), :kind_of?,
                    s(:const, nil, :TkCallbackEntry)),
                  s(:ivasgn, :@id,
                    s(:send, nil, :install_cmd,
                      s(:lvar, :cmd))),
                  s(:ivasgn, :@id,
                    s(:send,
                      s(:send,
                        s(:send, nil, :install_cmd,
                          s(:block,
                            s(:send, nil, :proc),
                            s(:args,
                              s(:restarg, :arg)),
                            s(:begin,
                              s(:lvasgn, :ex_args,
                                s(:array)),
                              s(:block,
                                s(:send,
                                  s(:lvar, :extra_args_tbl), :reverse_each),
                                s(:args,
                                  s(:arg, :conv)),
                                s(:send,
                                  s(:lvar, :ex_args), :<<,
                                  s(:send,
                                    s(:lvar, :conv), :call,
                                    s(:send,
                                      s(:lvar, :arg), :pop)))),
                              s(:send,
                                s(:lvar, :klass), :ret_val,
                                s(:send,
                                  s(:lvar, :cmd), :call,
                                  s(:splat,
                                    s(:begin,
                                      s(:send,
                                        s(:lvar, :ex_args), :<<,
                                        s(:send,
                                          s(:lvar, :klass), :new,
                                          s(:splat,
                                            s(:send,
                                              s(:lvar, :klass), :scan_args,
                                              s(:lvar, :keys),
                                              s(:lvar, :arg)))))))))))), :+,
                        s(:str, " ")), :+,
                      s(:lvar, :args))))))))),
      s(:def, :initialize,
        s(:args,
          s(:optarg, :cmd,
            s(:send,
              s(:const, nil, :Proc), :new)),
          s(:restarg, :args)),
        s(:send, nil, :_initialize_for_cb_class,
          s(:const,
            s(:send,
              s(:self), :class), :ValidateArgs),
          s(:lvar, :cmd),
          s(:splat,
            s(:lvar, :args)))),
      s(:def, :to_eval,
        s(:args),
        s(:ivar, :@id)))),
  s(:module,
    s(:const, nil, :TkValidation),
    s(:begin,
      s(:send, nil, :include,
        s(:const,
          s(:const, nil, :Tk), :ValidateConfigure)),
      s(:class,
        s(:const, nil, :ValidateCmd),
        s(:const, nil, :TkValidateCommand),
        s(:module,
          s(:const, nil, :Action),
          s(:begin,
            s(:casgn, nil, :Insert,
              s(:int, 1)),
            s(:casgn, nil, :Delete,
              s(:int, 0)),
            s(:casgn, nil, :Others,
              s(:int, -1)),
            s(:casgn, nil, :Focus,
              s(:int, -1)),
            s(:casgn, nil, :Forced,
              s(:int, -1)),
            s(:casgn, nil, :Textvariable,
              s(:int, -1)),
            s(:casgn, nil, :TextVariable,
              s(:int, -1))))),
      s(:def, :__validation_class_list,
        s(:args),
        s(:send,
          s(:super), :<<,
          s(:const, nil, :ValidateCmd))),
      s(:send,
        s(:const,
          s(:const, nil, :Tk), :ValidateConfigure), :__def_validcmd,
        s(:send, nil, :binding),
        s(:const, nil, :ValidateCmd)))))
