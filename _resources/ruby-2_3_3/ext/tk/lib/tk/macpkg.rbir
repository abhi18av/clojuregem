s(:begin,
  s(:send, nil, :require,
    s(:str, "tk")),
  s(:module,
    s(:const, nil, :Tk),
    s(:begin,
      s(:defs,
        s(:const, nil, :Tk), :load_tclscript_rsrc,
        s(:args,
          s(:arg, :resource_name),
          s(:optarg, :file,
            s(:const, nil, :None))),
        s(:send, nil, :tk_call,
          s(:str, "source"),
          s(:str, "-rsrc"),
          s(:lvar, :resource_name),
          s(:lvar, :file))),
      s(:defs,
        s(:const, nil, :Tk), :load_tclscript_rsrcid,
        s(:args,
          s(:arg, :resource_id),
          s(:optarg, :file,
            s(:const, nil, :None))),
        s(:send, nil, :tk_call,
          s(:str, "source"),
          s(:str, "-rsrcid"),
          s(:lvar, :resource_id),
          s(:lvar, :file))))),
  s(:module,
    s(:const,
      s(:const, nil, :Tk), :MacResource), nil),
  s(:send,
    s(:const, nil, :Tk), :__set_loaded_toplevel_aliases__,
    s(:str, "tk/macpkg.rb"),
    s(:sym, :Tk),
    s(:const,
      s(:const, nil, :Tk), :MacResource),
    s(:sym, :TkMacResource)),
  s(:module,
    s(:const,
      s(:const, nil, :Tk), :MacResource),
    s(:begin,
      s(:send, nil, :extend,
        s(:const, nil, :Tk)),
      s(:send, nil, :extend,
        s(:const,
          s(:const, nil, :Tk), :MacResource)),
      s(:casgn, nil, :TkCommandNames,
        s(:send,
          s(:array,
            s(:send,
              s(:str, "resource"), :freeze)), :freeze)),
      s(:casgn, nil, :PACKAGE_NAME,
        s(:send,
          s(:str, "resource"), :freeze)),
      s(:defs,
        s(:self), :package_name,
        s(:args),
        s(:const, nil, :PACKAGE_NAME)),
      s(:send, nil, :tk_call_without_enc,
        s(:str, "package"),
        s(:str, "require"),
        s(:str, "resource")),
      s(:def, :close,
        s(:args,
          s(:arg, :rsrcRef)),
        s(:send, nil, :tk_call,
          s(:str, "resource"),
          s(:str, "close"),
          s(:lvar, :rsrcRef))),
      s(:def, :delete,
        s(:args,
          s(:arg, :rsrcType),
          s(:optarg, :opts,
            s(:nil))),
        s(:send, nil, :tk_call,
          s(:str, "resource"),
          s(:str, "delete"),
          s(:splat,
            s(:begin,
              s(:send,
                s(:send, nil, :hash_kv,
                  s(:lvar, :opts)), :<<,
                s(:lvar, :rsrcType)))))),
      s(:def, :files,
        s(:args,
          s(:optarg, :rsrcRef,
            s(:nil))),
        s(:if,
          s(:lvar, :rsrcRef),
          s(:send, nil, :tk_call,
            s(:str, "resource"),
            s(:str, "files"),
            s(:lvar, :rsrcRef)),
          s(:send, nil, :tk_split_simplelist,
            s(:send, nil, :tk_call,
              s(:str, "resource"),
              s(:str, "files"))))),
      s(:def, :list,
        s(:args,
          s(:arg, :rsrcType),
          s(:optarg, :rsrcRef,
            s(:nil))),
        s(:send, nil, :tk_split_simplelist,
          s(:send, nil, :tk_call,
            s(:str, "resource"),
            s(:str, "list"),
            s(:lvar, :rsrcType),
            s(:lvar, :rsrcRef)))),
      s(:def, :open,
        s(:args,
          s(:arg, :fname),
          s(:optarg, :access,
            s(:nil))),
        s(:send, nil, :tk_call,
          s(:str, "resource"),
          s(:str, "open"),
          s(:lvar, :fname),
          s(:lvar, :access))),
      s(:def, :read,
        s(:args,
          s(:arg, :rsrcType),
          s(:arg, :rsrcID),
          s(:optarg, :rsrcRef,
            s(:nil))),
        s(:send, nil, :tk_call,
          s(:str, "resource"),
          s(:str, "read"),
          s(:lvar, :rsrcType),
          s(:lvar, :rsrcID),
          s(:lvar, :rsrcRef))),
      s(:def, :types,
        s(:args,
          s(:optarg, :rsrcRef,
            s(:nil))),
        s(:send, nil, :tk_split_simplelist,
          s(:send, nil, :tk_call,
            s(:str, "resource"),
            s(:str, "types"),
            s(:lvar, :rsrcRef)))),
      s(:def, :write,
        s(:args,
          s(:arg, :rsrcType),
          s(:arg, :data),
          s(:optarg, :opts,
            s(:nil))),
        s(:send, nil, :tk_call,
          s(:str, "resource"),
          s(:str, "write"),
          s(:splat,
            s(:begin,
              s(:send,
                s(:send,
                  s(:send, nil, :hash_kv,
                    s(:lvar, :opts)), :<<,
                  s(:lvar, :rsrcType)), :<<,
                s(:lvar, :data)))))),
      s(:send, nil, :module_function,
        s(:sym, :close),
        s(:sym, :delete),
        s(:sym, :files),
        s(:sym, :list),
        s(:sym, :open),
        s(:sym, :read),
        s(:sym, :types),
        s(:sym, :write)))))
