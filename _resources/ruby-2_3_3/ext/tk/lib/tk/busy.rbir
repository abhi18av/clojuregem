s(:begin,
  s(:send, nil, :require,
    s(:str, "tk")),
  s(:module,
    s(:const,
      s(:const, nil, :Tk), :Busy),
    s(:begin,
      s(:send, nil, :include,
        s(:const, nil, :TkCore)),
      s(:send, nil, :extend,
        s(:const, nil, :TkCore)),
      s(:send, nil, :extend,
        s(:const, nil, :TkItemConfigMethod)))),
  s(:sclass,
    s(:const,
      s(:const, nil, :Tk), :Busy),
    s(:begin,
      s(:def, :__item_cget_cmd,
        s(:args,
          s(:arg, :win)),
        s(:array,
          s(:str, "tk"),
          s(:str, "busy"),
          s(:str, "cget"),
          s(:send,
            s(:lvar, :win), :path))),
      s(:send, nil, :private,
        s(:sym, :__item_cget_cmd)),
      s(:def, :__item_config_cmd,
        s(:args,
          s(:arg, :win)),
        s(:array,
          s(:str, "tk"),
          s(:str, "busy"),
          s(:str, "configure"),
          s(:send,
            s(:lvar, :win), :path))),
      s(:send, nil, :private,
        s(:sym, :__item_config_cmd)),
      s(:def, :__item_confinfo_cmd,
        s(:args,
          s(:arg, :win)),
        s(:send, nil, :__item_config_cmd,
          s(:lvar, :win))),
      s(:send, nil, :private,
        s(:sym, :__item_confinfo_cmd)),
      s(:alias,
        s(:sym, :cget_tkstring),
        s(:sym, :itemcget_tkstring)),
      s(:alias,
        s(:sym, :cget),
        s(:sym, :itemcget)),
      s(:alias,
        s(:sym, :cget_strict),
        s(:sym, :itemcget_strict)),
      s(:alias,
        s(:sym, :configure),
        s(:sym, :itemconfigure)),
      s(:alias,
        s(:sym, :configinfo),
        s(:sym, :itemconfiginfo)),
      s(:alias,
        s(:sym, :current_configinfo),
        s(:sym, :current_itemconfiginfo)),
      s(:send, nil, :private,
        s(:sym, :itemcget_tkstring),
        s(:sym, :itemcget),
        s(:sym, :itemcget_strict)),
      s(:send, nil, :private,
        s(:sym, :itemconfigure),
        s(:sym, :itemconfiginfo),
        s(:sym, :current_itemconfiginfo)),
      s(:def, :method_missing,
        s(:args,
          s(:arg, :id),
          s(:restarg, :args)),
        s(:begin,
          s(:lvasgn, :name,
            s(:send,
              s(:lvar, :id), :id2name)),
          s(:case,
            s(:send,
              s(:lvar, :args), :length),
            s(:when,
              s(:int, 1),
              s(:if,
                s(:send,
                  s(:send,
                    s(:lvar, :name), :[],
                    s(:int, -1)), :==,
                  s(:str, "=")),
                s(:begin,
                  s(:send, nil, :configure,
                    s(:send,
                      s(:lvar, :name), :[],
                      s(:irange,
                        s(:int, 0),
                        s(:int, -2))),
                    s(:send,
                      s(:lvar, :args), :[],
                      s(:int, 0))),
                  s(:send,
                    s(:lvar, :args), :[],
                    s(:int, 0))),
                s(:begin,
                  s(:send, nil, :configure,
                    s(:lvar, :name),
                    s(:send,
                      s(:lvar, :args), :[],
                      s(:int, 0))),
                  s(:self)))),
            s(:when,
              s(:int, 0),
              s(:kwbegin,
                s(:rescue,
                  s(:send, nil, :cget,
                    s(:lvar, :name)),
                  s(:resbody, nil, nil,
                    s(:super,
                      s(:lvar, :id),
                      s(:splat,
                        s(:lvar, :args)))), nil))),
            s(:super,
              s(:lvar, :id),
              s(:splat,
                s(:lvar, :args)))))),
      s(:def, :hold,
        s(:args,
          s(:arg, :win),
          s(:optarg, :keys,
            s(:hash))),
        s(:begin,
          s(:send, nil, :tk_call_without_enc,
            s(:str, "tk"),
            s(:str, "busy"),
            s(:str, "hold"),
            s(:lvar, :win),
            s(:splat,
              s(:send, nil, :hash_kv,
                s(:lvar, :keys)))),
          s(:lvar, :win))),
      s(:def, :forget,
        s(:args,
          s(:restarg, :wins)),
        s(:begin,
          s(:send, nil, :tk_call_without_enc,
            s(:str, "tk"),
            s(:str, "busy"),
            s(:str, "forget"),
            s(:splat,
              s(:lvar, :wins))),
          s(:self))),
      s(:def, :current,
        s(:args,
          s(:optarg, :pat,
            s(:const, nil, :None))),
        s(:send, nil, :list,
          s(:send, nil, :tk_call,
            s(:str, "tk"),
            s(:str, "busy"),
            s(:str, "current"),
            s(:lvar, :pat)))),
      s(:def, :status,
        s(:args,
          s(:arg, :win)),
        s(:send, nil, :bool,
          s(:send, nil, :tk_call_without_enc,
            s(:str, "tk"),
            s(:str, "busy"),
            s(:str, "status"),
            s(:lvar, :win)))))),
  s(:module,
    s(:const,
      s(:const, nil, :Tk), :Busy),
    s(:begin,
      s(:def, :busy_configinfo,
        s(:args,
          s(:optarg, :option,
            s(:nil))),
        s(:send,
          s(:const,
            s(:const, nil, :Tk), :Busy), :configinfo,
          s(:self),
          s(:lvar, :option))),
      s(:def, :busy_current_configinfo,
        s(:args,
          s(:optarg, :option,
            s(:nil))),
        s(:send,
          s(:const,
            s(:const, nil, :Tk), :Busy), :current_configinfo,
          s(:self),
          s(:lvar, :option))),
      s(:def, :busy_configure,
        s(:args,
          s(:arg, :option),
          s(:optarg, :value,
            s(:const, nil, :None))),
        s(:begin,
          s(:send,
            s(:const,
              s(:const, nil, :Tk), :Busy), :configure,
            s(:self),
            s(:lvar, :option),
            s(:lvar, :value)),
          s(:self))),
      s(:def, :busy_cget,
        s(:args,
          s(:arg, :option)),
        s(:send,
          s(:const,
            s(:const, nil, :Tk), :Busy), :configure,
          s(:self),
          s(:lvar, :option))),
      s(:def, :busy,
        s(:args,
          s(:optarg, :keys,
            s(:hash))),
        s(:begin,
          s(:send,
            s(:const,
              s(:const, nil, :Tk), :Busy), :hold,
            s(:self),
            s(:lvar, :keys)),
          s(:self))),
      s(:alias,
        s(:sym, :busy_hold),
        s(:sym, :busy)),
      s(:def, :busy_forget,
        s(:args),
        s(:begin,
          s(:send,
            s(:const,
              s(:const, nil, :Tk), :Busy), :forget,
            s(:self)),
          s(:self))),
      s(:def, :busy_current?,
        s(:args),
        s(:send,
          s(:send,
            s(:send,
              s(:const,
                s(:const, nil, :Tk), :Busy), :current,
              s(:send,
                s(:self), :path)), :empty?), :!)),
      s(:def, :busy_status,
        s(:args),
        s(:send,
          s(:const,
            s(:const, nil, :Tk), :Busy), :status,
          s(:self))))))
