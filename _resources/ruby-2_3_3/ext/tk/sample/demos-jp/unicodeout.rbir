s(:begin,
  s(:if,
    s(:and,
      s(:defined?,
        s(:gvar, :$unicodeout_demo)),
      s(:gvar, :$unicodeout_demo)),
    s(:begin,
      s(:send,
        s(:gvar, :$unicodeout_demo), :destroy),
      s(:gvasgn, :$unicodeout_demo,
        s(:nil))), nil),
  s(:gvasgn, :$unicodeout_demo,
    s(:block,
      s(:send,
        s(:const, nil, :TkToplevel), :new),
      s(:args,
        s(:arg, :w)),
      s(:begin,
        s(:send, nil, :title,
          s(:str, "Unicode Label Demonstration")),
        s(:send, nil, :iconname,
          s(:str, "unicodeout")),
        s(:send, nil, :positionWindow,
          s(:lvar, :w))))),
  s(:lvasgn, :base_frame,
    s(:send,
      s(:send,
        s(:const, nil, :TkFrame), :new,
        s(:gvar, :$unicodeout_demo)), :pack,
      s(:hash,
        s(:pair,
          s(:sym, :fill),
          s(:sym, :both)),
        s(:pair,
          s(:sym, :expand),
          s(:true))))),
  s(:send,
    s(:send,
      s(:const, nil, :TkLabel), :new,
      s(:lvar, :base_frame),
      s(:hash,
        s(:pair,
          s(:sym, :font),
          s(:gvar, :$font)),
        s(:pair,
          s(:sym, :wraplength),
          s(:str, "5.4i")),
        s(:pair,
          s(:sym, :justify),
          s(:sym, :left)),
        s(:pair,
          s(:sym, :text),
          s(:dstr,
            s(:str, "これは，Tkにおける非欧米文字集合を用いる言語に対するサポートについての\nサンプルです．ただし，下の表示においてあなたが実際にどのような表示を\n目にするかは，あなたの環境にどのような文字集合がインストールされているかに\n大きく依存します．また，対象となる文字集合がインストールされていない場合に\nどのような表示がなされるかもあなたの環境次第です．\n「コード参照」ボタンを押してソースを表示し，\nUnicodeout_SampleFrameクラスの@@fontの定義を書き換えて\n(ファイルの内容は変更されません)\n「再実行」ボタンのクリックを試してみてください．\n"),
            s(:str, "スクリプトが可搬性を持つように，文字列は\\uXXXXという\nTclのエスケープ表現を用いたUNICODE文字列で書かれています．\n文字列は，Tk::UTF8_Stringメソッドによって，\n「UTF8形式の文字列である」という\nエンコード情報付きの文字列オブジェクト\n(Tclのエスケープ表現の変換済み)に変換して\nラベルウィジェットに渡している点に注意してください．\n"))))), :pack,
    s(:hash,
      s(:pair,
        s(:sym, :side),
        s(:sym, :top)))),
  s(:block,
    s(:send,
      s(:const, nil, :TkFrame), :new,
      s(:lvar, :base_frame)),
    s(:args,
      s(:arg, :f)),
    s(:begin,
      s(:send, nil, :pack,
        s(:hash,
          s(:pair,
            s(:sym, :side),
            s(:sym, :bottom)),
          s(:pair,
            s(:sym, :fill),
            s(:sym, :x)),
          s(:pair,
            s(:sym, :pady),
            s(:str, "2m")))),
      s(:send,
        s(:send,
          s(:const, nil, :TkButton), :new,
          s(:lvar, :f),
          s(:hash,
            s(:pair,
              s(:sym, :text),
              s(:str, "閉じる")),
            s(:pair,
              s(:sym, :width),
              s(:int, 15)),
            s(:pair,
              s(:sym, :command),
              s(:block,
                s(:send, nil, :proc),
                s(:args),
                s(:begin,
                  s(:send,
                    s(:gvar, :$unicodeout_demo), :destroy),
                  s(:gvasgn, :$unicodeout_demo,
                    s(:nil))))))), :pack,
        s(:hash,
          s(:pair,
            s(:sym, :side),
            s(:sym, :left)),
          s(:pair,
            s(:sym, :expand),
            s(:true)))),
      s(:send,
        s(:send,
          s(:const, nil, :TkButton), :new,
          s(:lvar, :f),
          s(:hash,
            s(:pair,
              s(:sym, :text),
              s(:str, "コード参照")),
            s(:pair,
              s(:sym, :width),
              s(:int, 15)),
            s(:pair,
              s(:sym, :command),
              s(:block,
                s(:send, nil, :proc),
                s(:args),
                s(:send, nil, :showCode,
                  s(:str, "unicodeout")))))), :pack,
        s(:hash,
          s(:pair,
            s(:sym, :side),
            s(:sym, :left)),
          s(:pair,
            s(:sym, :expand),
            s(:true)))))),
  s(:lvasgn, :wait_msg,
    s(:send,
      s(:send,
        s(:const, nil, :TkLabel), :new,
        s(:lvar, :base_frame),
        s(:hash,
          s(:pair,
            s(:sym, :text),
            s(:send,
              s(:str, "フォント読み込みの完了まで"), :+,
              s(:str, "しばらくお待ち下さい．．．"))),
          s(:pair,
            s(:sym, :font),
            s(:str, "Helvetica 12 italic")))), :pack)),
  s(:class,
    s(:const, nil, :Unicodeout_SampleFrame),
    s(:const, nil, :TkFrame),
    s(:begin,
      s(:cvasgn, :@@font,
        s(:gvar, :$font)),
      s(:def, :initialize,
        s(:args,
          s(:arg, :base)),
        s(:begin,
          s(:super,
            s(:lvar, :base)),
          s(:send, nil, :grid_columnconfig,
            s(:int, 1),
            s(:hash,
              s(:pair,
                s(:sym, :weight),
                s(:int, 1)))))),
      s(:def, :add_sample,
        s(:args,
          s(:arg, :lang),
          s(:restarg, :args)),
        s(:begin,
          s(:lvasgn, :sample_txt,
            s(:send,
              s(:const, nil, :Tk), :UTF8_String,
              s(:send,
                s(:lvar, :args), :join,
                s(:str, "")))),
          s(:lvasgn, :l,
            s(:send,
              s(:const, nil, :TkLabel), :new,
              s(:self),
              s(:hash,
                s(:pair,
                  s(:sym, :font),
                  s(:cvar, :@@font)),
                s(:pair,
                  s(:sym, :text),
                  s(:send,
                    s(:lvar, :lang), :+,
                    s(:str, ":"))),
                s(:pair,
                  s(:sym, :anchor),
                  s(:sym, :nw)),
                s(:pair,
                  s(:sym, :pady),
                  s(:int, 0))))),
          s(:lvasgn, :s,
            s(:send,
              s(:const, nil, :TkLabel), :new,
              s(:self),
              s(:hash,
                s(:pair,
                  s(:sym, :font),
                  s(:send,
                    s(:const, nil, :TkFont), :new,
                    s(:cvar, :@@font))),
                s(:pair,
                  s(:sym, :text),
                  s(:lvar, :sample_txt)),
                s(:pair,
                  s(:sym, :anchor),
                  s(:sym, :nw)),
                s(:pair,
                  s(:sym, :width),
                  s(:int, 30)),
                s(:pair,
                  s(:sym, :pady),
                  s(:int, 0))))),
          s(:send,
            s(:const, nil, :Tk), :grid,
            s(:lvar, :l),
            s(:lvar, :s),
            s(:hash,
              s(:pair,
                s(:sym, :sticky),
                s(:sym, :ew)),
              s(:pair,
                s(:sym, :pady),
                s(:int, 0)))),
          s(:send,
            s(:lvar, :l), :grid_config,
            s(:sym, :padx),
            s(:str, "1m")))))),
  s(:lvasgn, :f,
    s(:send,
      s(:const, nil, :Unicodeout_SampleFrame), :new,
      s(:lvar, :base_frame))),
  s(:send,
    s(:lvar, :f), :pack,
    s(:hash,
      s(:pair,
        s(:sym, :expand),
        s(:true)),
      s(:pair,
        s(:sym, :fill),
        s(:sym, :both)),
      s(:pair,
        s(:sym, :padx),
        s(:str, "2m")),
      s(:pair,
        s(:sym, :pady),
        s(:str, "1m")))),
  s(:lvasgn, :oldCursor,
    s(:send,
      s(:gvar, :$unicodeout_demo), :cursor)),
  s(:send,
    s(:gvar, :$unicodeout_demo), :cursor,
    s(:str, "watch")),
  s(:send,
    s(:const, nil, :Tk), :update),
  s(:send,
    s(:lvar, :f), :add_sample,
    s(:str, "Arabic"),
    s(:str, "\\uFE94\\uFEF4\\uFE91\\uFEAE\\uFECC\\uFEDF\\uFE8D\\uFE94"),
    s(:str, "\\uFEE4\\uFEE0\\uFEDC\\uFEDF\\uFE8D")),
  s(:send,
    s(:lvar, :f), :add_sample,
    s(:str, "Trad. Chinese"),
    s(:str, "\\u4E2D\\u570B\\u7684\\u6F22\\u5B57")),
  s(:send,
    s(:lvar, :f), :add_sample,
    s(:str, "Simpl. Chinese"),
    s(:str, "\\u6C49\\u8BED")),
  s(:send,
    s(:lvar, :f), :add_sample,
    s(:str, "Greek"),
    s(:str, "\\u0395\\u03BB\\u03BB\\u03B7\\u03BD\\u03B9\\u03BA\\u03AE "),
    s(:str, "\\u03B3\\u03BB\\u03CE\\u03C3\\u03C3\\u03B1")),
  s(:send,
    s(:lvar, :f), :add_sample,
    s(:str, "Hebrew"),
    s(:str, "\\u05DD\\u05D9\\u05DC\\u05E9\\u05D5\\u05E8\\u05D9 "),
    s(:str, "\\u05DC\\u05D9\\u05D0\\u05E8\\u05E9\\u05D9")),
  s(:send,
    s(:lvar, :f), :add_sample,
    s(:str, "Japanese"),
    s(:str, "\\u65E5\\u672C\\u8A9E\\u306E\\u3072\\u3089\\u304C\\u306A, "),
    s(:str, "\\u6F22\\u5B57\\u3068\\u30AB\\u30BF\\u30AB\\u30CA")),
  s(:send,
    s(:lvar, :f), :add_sample,
    s(:str, "Korean"),
    s(:str, "\\uB300\\uD55C\\uBBFC\\uAD6D\\uC758 \\uD55C\\uAE00")),
  s(:send,
    s(:lvar, :f), :add_sample,
    s(:str, "Russian"),
    s(:str, "\\u0420\\u0443\\u0441\\u0441\\u043A\\u0438\\u0439 "),
    s(:str, "\\u044F\\u0437\\u044B\\u043A")),
  s(:send,
    s(:lvar, :wait_msg), :destroy),
  s(:send,
    s(:gvar, :$unicodeout_demo), :cursor,
    s(:lvar, :oldCursor)))
