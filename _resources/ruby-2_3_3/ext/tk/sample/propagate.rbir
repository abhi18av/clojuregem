s(:begin,
  s(:send, nil, :require,
    s(:str, "tk")),
  s(:send,
    s(:send,
      s(:const, nil, :TkLabel), :new,
      s(:hash,
        s(:pair,
          s(:sym, :text),
          s(:str, "Please click the bottom frame")))), :pack),
  s(:lvasgn, :f,
    s(:send,
      s(:send,
        s(:const, nil, :TkFrame), :new,
        s(:hash,
          s(:pair,
            s(:sym, :width),
            s(:int, 400)),
          s(:pair,
            s(:sym, :height),
            s(:int, 100)),
          s(:pair,
            s(:sym, :background),
            s(:str, "yellow")),
          s(:pair,
            s(:sym, :relief),
            s(:str, "ridge")),
          s(:pair,
            s(:sym, :borderwidth),
            s(:int, 5)))), :pack)),
  s(:send,
    s(:lvar, :f), :pack_propagate,
    s(:false)),
  s(:lvasgn, :list,
    s(:block,
      s(:send,
        s(:begin,
          s(:irange,
            s(:int, 1),
            s(:int, 3))), :collect),
      s(:args,
        s(:arg, :n)),
      s(:block,
        s(:send,
          s(:const, nil, :TkButton), :new,
          s(:lvar, :f),
          s(:hash,
            s(:pair,
              s(:sym, :text),
              s(:dstr,
                s(:str, "button"),
                s(:begin,
                  s(:send,
                    s(:str, "-X"), :*,
                    s(:lvar, :n))))))),
        s(:args),
        s(:send, nil, :command,
          s(:block,
            s(:send, nil, :proc),
            s(:args),
            s(:begin,
              s(:send, nil, :puts,
                s(:dstr,
                  s(:str, "button"),
                  s(:begin,
                    s(:send,
                      s(:str, "-X"), :*,
                      s(:lvar, :n))))),
              s(:send,
                s(:self), :unpack))))))),
  s(:send,
    s(:lvar, :list), :unshift,
    s(:nil)),
  s(:send,
    s(:lvar, :f), :bind,
    s(:str, "1"),
    s(:block,
      s(:send, nil, :proc),
      s(:args),
      s(:begin,
        s(:lvasgn, :w,
          s(:send,
            s(:lvar, :list), :shift)),
        s(:if,
          s(:lvar, :w),
          s(:send,
            s(:lvar, :w), :unpack), nil),
        s(:send,
          s(:lvar, :list), :push,
          s(:lvar, :w)),
        s(:if,
          s(:send,
            s(:lvar, :list), :[],
            s(:int, 0)),
          s(:send,
            s(:send,
              s(:lvar, :list), :[],
              s(:int, 0)), :pack,
            s(:hash,
              s(:pair,
                s(:sym, :expand),
                s(:true)),
              s(:pair,
                s(:sym, :anchor),
                s(:sym, :center)))), nil)))),
  s(:send,
    s(:const, nil, :Tk), :mainloop))
