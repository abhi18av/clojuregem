s(:begin,
  s(:send, nil, :require,
    s(:str, "tk")),
  s(:if,
    s(:or,
      s(:send,
        s(:str, "(string)"), :==,
        s(:gvar, :$0)),
      s(:send,
        s(:send,
          s(:const,
            s(:const, nil, :TkCore), :INTERP), :safe?), :!)),
    s(:if,
      s(:send,
        s(:send,
          s(:const, nil, :ENV), :[],
          s(:str, "LANG")), :=~,
        s(:regexp,
          s(:str, "^ja"),
          s(:regopt))),
      s(:send,
        s(:const, nil, :TkOptionDB), :read_with_encoding,
        s(:send,
          s(:const, nil, :File), :expand_path,
          s(:str, "resource.ja"),
          s(:send,
            s(:const, nil, :File), :dirname,
            s(:str, "(string)"))),
        s(:str, "utf-8")),
      s(:send,
        s(:const, nil, :TkOptionDB), :readfile,
        s(:send,
          s(:const, nil, :File), :expand_path,
          s(:str, "resource.en"),
          s(:send,
            s(:const, nil, :File), :dirname,
            s(:str, "(string)"))))), nil),
  s(:lvasgn, :cmd,
    s(:block,
      s(:send,
        s(:const, nil, :TkOptionDB), :new_proc_class,
        s(:sym, :BTN_CMD),
        s(:array,
          s(:sym, :show_msg),
          s(:sym, :bye_msg)),
        s(:int, 3)),
      s(:args),
      s(:sclass,
        s(:self),
        s(:begin,
          s(:def, :__check_proc_string__,
            s(:args,
              s(:arg, :str)),
            s(:begin,
              s(:send, nil, :print,
                s(:dstr,
                  s(:str, "($SAFE="),
                  s(:begin,
                    s(:gvar, :$SAFE)),
                  s(:str, " >>>) check!! str.tainted?::"),
                  s(:begin,
                    s(:send,
                      s(:lvar, :str), :tainted?)))),
              s(:send,
                s(:lvar, :str), :untaint),
              s(:send, nil, :print,
                s(:dstr,
                  s(:str, "==>"),
                  s(:begin,
                    s(:send,
                      s(:lvar, :str), :tainted?)),
                  s(:str, " (<<< $SAFE="),
                  s(:begin,
                    s(:gvar, :$SAFE)),
                  s(:str, "): "))),
              s(:lvar, :str))),
          s(:send, nil, :private,
            s(:sym, :__check_proc_string__)))))),
  s(:block,
    s(:send,
      s(:const, nil, :TkFrame), :new,
      s(:hash,
        s(:pair,
          s(:sym, :class),
          s(:str, "BtnFrame")))),
    s(:args,
      s(:arg, :f)),
    s(:begin,
      s(:send, nil, :pack,
        s(:hash,
          s(:pair,
            s(:sym, :padx),
            s(:int, 5)),
          s(:pair,
            s(:sym, :pady),
            s(:int, 5)))),
      s(:block,
        s(:send,
          s(:const, nil, :TkButton), :new,
          s(:hash,
            s(:pair,
              s(:sym, :parent),
              s(:lvar, :f)),
            s(:pair,
              s(:sym, :widgetname),
              s(:str, "hello")))),
        s(:args),
        s(:begin,
          s(:send, nil, :command,
            s(:block,
              s(:send, nil, :proc),
              s(:args),
              s(:begin,
                s(:send, nil, :print,
                  s(:dstr,
                    s(:str, "($SAFE="),
                    s(:begin,
                      s(:gvar, :$SAFE)),
                    s(:str, " >>>) : "))),
                s(:send,
                  s(:lvar, :cmd), :show_msg,
                  s(:send,
                    s(:const, nil, :TkOptionDB), :inspect)),
                s(:send, nil, :print,
                  s(:dstr,
                    s(:str, "(<<< $SAFE="),
                    s(:begin,
                      s(:gvar, :$SAFE)),
                    s(:str, ")")))))),
          s(:send, nil, :pack,
            s(:hash,
              s(:pair,
                s(:sym, :fill),
                s(:sym, :x)),
              s(:pair,
                s(:sym, :padx),
                s(:int, 10)),
              s(:pair,
                s(:sym, :pady),
                s(:int, 10)))))),
      s(:block,
        s(:send,
          s(:const, nil, :TkButton), :new,
          s(:hash,
            s(:pair,
              s(:sym, :command),
              s(:block,
                s(:send, nil, :proc),
                s(:args),
                s(:begin,
                  s(:send, nil, :print,
                    s(:dstr,
                      s(:str, "($SAFE="),
                      s(:begin,
                        s(:gvar, :$SAFE)),
                      s(:str, " >>>) : "))),
                  s(:send,
                    s(:lvar, :cmd), :bye_msg),
                  s(:send, nil, :print,
                    s(:dstr,
                      s(:str, "(<<< $SAFE="),
                      s(:begin,
                        s(:gvar, :$SAFE)),
                      s(:str, " ) : "))),
                  s(:send, nil, :exit)))),
            s(:pair,
              s(:sym, :parent),
              s(:lvar, :f)),
            s(:pair,
              s(:sym, :widgetname),
              s(:str, "quit")))),
        s(:args),
        s(:send, nil, :pack,
          s(:hash,
            s(:pair,
              s(:sym, :fill),
              s(:sym, :x)),
            s(:pair,
              s(:sym, :padx),
              s(:int, 10)),
            s(:pair,
              s(:sym, :pady),
              s(:int, 10))))))),
  s(:class,
    s(:const, nil, :BtnFrame),
    s(:const, nil, :TkFrame), nil),
  s(:block,
    s(:send,
      s(:const, nil, :BtnFrame), :new),
    s(:args,
      s(:arg, :f)),
    s(:begin,
      s(:send, nil, :pack,
        s(:hash,
          s(:pair,
            s(:sym, :padx),
            s(:int, 5)),
          s(:pair,
            s(:sym, :pady),
            s(:int, 5)))),
      s(:block,
        s(:send,
          s(:const, nil, :TkButton), :new,
          s(:hash,
            s(:pair,
              s(:sym, :parent),
              s(:lvar, :f)),
            s(:pair,
              s(:sym, :widgetname),
              s(:str, "hello")))),
        s(:args),
        s(:begin,
          s(:send, nil, :command,
            s(:block,
              s(:send, nil, :proc),
              s(:args),
              s(:begin,
                s(:send, nil, :print,
                  s(:dstr,
                    s(:str, "($SAFE="),
                    s(:begin,
                      s(:gvar, :$SAFE)),
                    s(:str, " >>>) : "))),
                s(:send,
                  s(:lvar, :cmd), :show_msg,
                  s(:send,
                    s(:const, nil, :TkOptionDB), :inspect)),
                s(:send, nil, :print,
                  s(:dstr,
                    s(:str, "(<<< $SAFE="),
                    s(:begin,
                      s(:gvar, :$SAFE)),
                    s(:str, ")")))))),
          s(:send, nil, :pack,
            s(:hash,
              s(:pair,
                s(:sym, :fill),
                s(:sym, :x)),
              s(:pair,
                s(:sym, :padx),
                s(:int, 10)),
              s(:pair,
                s(:sym, :pady),
                s(:int, 10)))))),
      s(:block,
        s(:send,
          s(:const, nil, :TkButton), :new,
          s(:hash,
            s(:pair,
              s(:sym, :command),
              s(:block,
                s(:send, nil, :proc),
                s(:args),
                s(:begin,
                  s(:send, nil, :print,
                    s(:dstr,
                      s(:str, "($SAFE="),
                      s(:begin,
                        s(:gvar, :$SAFE)),
                      s(:str, " >>>) : "))),
                  s(:send,
                    s(:lvar, :cmd), :bye_msg),
                  s(:send, nil, :print,
                    s(:dstr,
                      s(:str, "(<<< $SAFE="),
                      s(:begin,
                        s(:gvar, :$SAFE)),
                      s(:str, ")"))),
                  s(:send, nil, :exit)))),
            s(:pair,
              s(:sym, :parent),
              s(:lvar, :f)),
            s(:pair,
              s(:sym, :widgetname),
              s(:str, "quit")))),
        s(:args),
        s(:send, nil, :pack,
          s(:hash,
            s(:pair,
              s(:sym, :fill),
              s(:sym, :x)),
            s(:pair,
              s(:sym, :padx),
              s(:int, 10)),
            s(:pair,
              s(:sym, :pady),
              s(:int, 10))))))),
  s(:block,
    s(:send,
      s(:const, nil, :TkFrame), :new,
      s(:hash,
        s(:pair,
          s(:sym, :class),
          s(:str, "BtnFrame2")))),
    s(:args,
      s(:arg, :f)),
    s(:begin,
      s(:send, nil, :pack,
        s(:hash,
          s(:pair,
            s(:sym, :padx),
            s(:int, 5)),
          s(:pair,
            s(:sym, :pady),
            s(:int, 5)))),
      s(:block,
        s(:send,
          s(:const, nil, :TkButton), :new,
          s(:hash,
            s(:pair,
              s(:sym, :parent),
              s(:lvar, :f)),
            s(:pair,
              s(:sym, :widgetname),
              s(:str, "hello")))),
        s(:args),
        s(:begin,
          s(:send, nil, :command,
            s(:block,
              s(:send, nil, :proc),
              s(:args),
              s(:begin,
                s(:send, nil, :print,
                  s(:dstr,
                    s(:str, "($SAFE="),
                    s(:begin,
                      s(:gvar, :$SAFE)),
                    s(:str, " >>>) : "))),
                s(:send,
                  s(:lvar, :cmd), :show_msg,
                  s(:send,
                    s(:const, nil, :TkOptionDB), :inspect)),
                s(:send, nil, :print,
                  s(:dstr,
                    s(:str, "(<<< $SAFE="),
                    s(:begin,
                      s(:gvar, :$SAFE)),
                    s(:str, ")")))))),
          s(:send, nil, :pack,
            s(:hash,
              s(:pair,
                s(:sym, :fill),
                s(:sym, :x)),
              s(:pair,
                s(:sym, :padx),
                s(:int, 10)),
              s(:pair,
                s(:sym, :pady),
                s(:int, 10)))))),
      s(:block,
        s(:send,
          s(:const, nil, :TkButton), :new,
          s(:hash,
            s(:pair,
              s(:sym, :command),
              s(:block,
                s(:send, nil, :proc),
                s(:args),
                s(:begin,
                  s(:send, nil, :print,
                    s(:dstr,
                      s(:str, "($SAFE="),
                      s(:begin,
                        s(:gvar, :$SAFE)),
                      s(:str, " >>>) : "))),
                  s(:send,
                    s(:lvar, :cmd), :bye_msg),
                  s(:send, nil, :print,
                    s(:dstr,
                      s(:str, "(<<< $SAFE="),
                      s(:begin,
                        s(:gvar, :$SAFE)),
                      s(:str, ")"))),
                  s(:send, nil, :exit)))),
            s(:pair,
              s(:sym, :parent),
              s(:lvar, :f)),
            s(:pair,
              s(:sym, :widgetname),
              s(:str, "quit")))),
        s(:args),
        s(:send, nil, :pack,
          s(:hash,
            s(:pair,
              s(:sym, :fill),
              s(:sym, :x)),
            s(:pair,
              s(:sym, :padx),
              s(:int, 10)),
            s(:pair,
              s(:sym, :pady),
              s(:int, 10))))))),
  s(:send,
    s(:const, nil, :Tk), :mainloop))
