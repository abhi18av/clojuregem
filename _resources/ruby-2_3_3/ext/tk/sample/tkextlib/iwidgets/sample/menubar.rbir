s(:begin,
  s(:send, nil, :require,
    s(:str, "tk")),
  s(:send, nil, :require,
    s(:str, "tkextlib/iwidgets")),
  s(:lvasgn, :helpvar,
    s(:send,
      s(:const, nil, :TkVariable), :new)),
  s(:lvasgn, :viewmode,
    s(:send,
      s(:const, nil, :TkVariable), :new)),
  s(:lvasgn, :menu_spec,
    s(:array,
      s(:array,
        s(:sym, :menubutton),
        s(:str, "file"),
        s(:hash,
          s(:pair,
            s(:sym, :text),
            s(:str, "File")),
          s(:pair,
            s(:sym, :menu),
            s(:array,
              s(:array,
                s(:sym, :options),
                s(:hash,
                  s(:pair,
                    s(:sym, :tearoff),
                    s(:false)))),
              s(:array,
                s(:sym, :command),
                s(:str, "new"),
                s(:hash,
                  s(:pair,
                    s(:sym, :label),
                    s(:str, "New")),
                  s(:pair,
                    s(:sym, :helpstr),
                    s(:str, "Open new document")),
                  s(:pair,
                    s(:sym, :command),
                    s(:block,
                      s(:send, nil, :proc),
                      s(:args),
                      s(:send, nil, :puts,
                        s(:str, "NEW")))))),
              s(:array,
                s(:sym, :command),
                s(:str, "close"),
                s(:hash,
                  s(:pair,
                    s(:sym, :label),
                    s(:str, "Close")),
                  s(:pair,
                    s(:sym, :helpstr),
                    s(:str, "Close current document")),
                  s(:pair,
                    s(:sym, :command),
                    s(:block,
                      s(:send, nil, :proc),
                      s(:args),
                      s(:send, nil, :puts,
                        s(:str, "CLOSE")))))),
              s(:array,
                s(:sym, :separator),
                s(:str, "sep1")),
              s(:array,
                s(:sym, :command),
                s(:str, "exit"),
                s(:hash,
                  s(:pair,
                    s(:sym, :label),
                    s(:str, "Exit")),
                  s(:pair,
                    s(:sym, :helpstr),
                    s(:str, "Exit application")),
                  s(:pair,
                    s(:sym, :command),
                    s(:block,
                      s(:send, nil, :proc),
                      s(:args),
                      s(:send, nil, :exit))))))))),
      s(:array,
        s(:sym, :menubutton),
        s(:str, "edit"),
        s(:hash,
          s(:pair,
            s(:sym, :text),
            s(:str, "Edit")),
          s(:pair,
            s(:sym, :menu),
            s(:array,
              s(:array,
                s(:sym, :options),
                s(:hash,
                  s(:pair,
                    s(:sym, :tearoff),
                    s(:false)))),
              s(:array,
                s(:sym, :command),
                s(:str, "undo"),
                s(:hash,
                  s(:pair,
                    s(:sym, :label),
                    s(:str, "Undo")),
                  s(:pair,
                    s(:sym, :underline),
                    s(:int, 0)),
                  s(:pair,
                    s(:sym, :helpstr),
                    s(:str, "Undo last command")),
                  s(:pair,
                    s(:sym, :command),
                    s(:block,
                      s(:send, nil, :proc),
                      s(:args),
                      s(:send, nil, :puts,
                        s(:str, "UNDO")))))),
              s(:array,
                s(:sym, :separator),
                s(:str, "sep2")),
              s(:array,
                s(:sym, :command),
                s(:str, "cut"),
                s(:hash,
                  s(:pair,
                    s(:sym, :label),
                    s(:str, "Cut")),
                  s(:pair,
                    s(:sym, :underline),
                    s(:int, 1)),
                  s(:pair,
                    s(:sym, :helpstr),
                    s(:str, "Cut selection to clipboard")),
                  s(:pair,
                    s(:sym, :command),
                    s(:block,
                      s(:send, nil, :proc),
                      s(:args),
                      s(:send, nil, :puts,
                        s(:str, "CUT")))))),
              s(:array,
                s(:sym, :command),
                s(:str, "copy"),
                s(:hash,
                  s(:pair,
                    s(:sym, :label),
                    s(:str, "Copy")),
                  s(:pair,
                    s(:sym, :underline),
                    s(:int, 1)),
                  s(:pair,
                    s(:sym, :helpstr),
                    s(:str, "Copy selection to clipboard")),
                  s(:pair,
                    s(:sym, :command),
                    s(:block,
                      s(:send, nil, :proc),
                      s(:args),
                      s(:send, nil, :puts,
                        s(:str, "COPY")))))),
              s(:array,
                s(:sym, :command),
                s(:str, "paste"),
                s(:hash,
                  s(:pair,
                    s(:sym, :label),
                    s(:str, "Paste")),
                  s(:pair,
                    s(:sym, :underline),
                    s(:int, 0)),
                  s(:pair,
                    s(:sym, :helpstr),
                    s(:str, "Paste clipboard contents")),
                  s(:pair,
                    s(:sym, :command),
                    s(:block,
                      s(:send, nil, :proc),
                      s(:args),
                      s(:send, nil, :puts,
                        s(:str, "PASTE")))))))))),
      s(:array,
        s(:sym, :menubutton),
        s(:str, "options"),
        s(:hash,
          s(:pair,
            s(:sym, :text),
            s(:str, "Options")),
          s(:pair,
            s(:sym, :menu),
            s(:array,
              s(:array,
                s(:sym, :options),
                s(:hash,
                  s(:pair,
                    s(:sym, :tearoff),
                    s(:false)),
                  s(:pair,
                    s(:sym, :selectcolor),
                    s(:str, "blue")))),
              s(:array,
                s(:sym, :radiobutton),
                s(:str, "byName"),
                s(:hash,
                  s(:pair,
                    s(:sym, :variable),
                    s(:lvar, :viewmode)),
                  s(:pair,
                    s(:sym, :value),
                    s(:str, "NAME")),
                  s(:pair,
                    s(:sym, :label),
                    s(:str, "by Name")),
                  s(:pair,
                    s(:sym, :helpstr),
                    s(:str, "View files by name order")),
                  s(:pair,
                    s(:sym, :command),
                    s(:block,
                      s(:send, nil, :proc),
                      s(:args),
                      s(:send, nil, :puts,
                        s(:str, "NAME")))))),
              s(:array,
                s(:sym, :radiobutton),
                s(:str, "byDate"),
                s(:hash,
                  s(:pair,
                    s(:sym, :variable),
                    s(:lvar, :viewmode)),
                  s(:pair,
                    s(:sym, :value),
                    s(:str, "DATE")),
                  s(:pair,
                    s(:sym, :label),
                    s(:str, "by Date")),
                  s(:pair,
                    s(:sym, :helpstr),
                    s(:str, "View files by date order")),
                  s(:pair,
                    s(:sym, :command),
                    s(:block,
                      s(:send, nil, :proc),
                      s(:args),
                      s(:send, nil, :puts,
                        s(:str, "DATE")))))),
              s(:array,
                s(:sym, :cascade),
                s(:str, "prefs"),
                s(:hash,
                  s(:pair,
                    s(:sym, :label),
                    s(:str, "Preferences")),
                  s(:pair,
                    s(:sym, :menu),
                    s(:array,
                      s(:array,
                        s(:sym, :command),
                        s(:str, "colors"),
                        s(:hash,
                          s(:pair,
                            s(:sym, :label),
                            s(:str, "Colors...")),
                          s(:pair,
                            s(:sym, :helpstr),
                            s(:str, "Change text colors")),
                          s(:pair,
                            s(:sym, :command),
                            s(:block,
                              s(:send, nil, :proc),
                              s(:args),
                              s(:send, nil, :puts,
                                s(:str, "COLORS")))))),
                      s(:array,
                        s(:sym, :command),
                        s(:str, "fonts"),
                        s(:hash,
                          s(:pair,
                            s(:sym, :label),
                            s(:str, "Fonts...")),
                          s(:pair,
                            s(:sym, :helpstr),
                            s(:str, "Change text font")),
                          s(:pair,
                            s(:sym, :command),
                            s(:block,
                              s(:send, nil, :proc),
                              s(:args),
                              s(:send, nil, :puts,
                                s(:str, "COLORS")))))))))))))))),
  s(:lvasgn, :mb,
    s(:send,
      s(:const,
        s(:const,
          s(:const, nil, :Tk), :Iwidgets), :Menubar), :new,
      s(:hash,
        s(:pair,
          s(:sym, :helpvariable),
          s(:lvar, :helpvar))))),
  s(:send,
    s(:lvar, :mb), :configure,
    s(:hash,
      s(:pair,
        s(:sym, :menubuttons),
        s(:lvar, :menu_spec)))),
  s(:lvasgn, :fr,
    s(:send,
      s(:const, nil, :TkFrame), :new,
      s(:hash,
        s(:pair,
          s(:sym, :width),
          s(:int, 300)),
        s(:pair,
          s(:sym, :height),
          s(:int, 300))))),
  s(:lvasgn, :ef,
    s(:send,
      s(:const, nil, :TkEntry), :new,
      s(:hash,
        s(:pair,
          s(:sym, :textvariable),
          s(:lvar, :helpvar))))),
  s(:send,
    s(:lvar, :mb), :pack,
    s(:hash,
      s(:pair,
        s(:sym, :anchor),
        s(:sym, :nw)),
      s(:pair,
        s(:sym, :fill),
        s(:sym, :x)),
      s(:pair,
        s(:sym, :expand),
        s(:true)))),
  s(:send,
    s(:lvar, :fr), :pack,
    s(:hash,
      s(:pair,
        s(:sym, :fill),
        s(:sym, :both)),
      s(:pair,
        s(:sym, :expand),
        s(:true)))),
  s(:send,
    s(:lvar, :ef), :pack,
    s(:hash,
      s(:pair,
        s(:sym, :anchor),
        s(:sym, :sw)),
      s(:pair,
        s(:sym, :fill),
        s(:sym, :x)),
      s(:pair,
        s(:sym, :expand),
        s(:true)))),
  s(:send,
    s(:const, nil, :Tk), :mainloop))
