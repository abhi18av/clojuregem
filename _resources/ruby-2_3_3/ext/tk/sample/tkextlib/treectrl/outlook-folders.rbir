s(:def, :demoOutlookFolders,
  s(:args,
    s(:arg, :t)),
  s(:begin,
    s(:send, nil, :init_pics,
      s(:str, "outlook-*")),
    s(:lvasgn, :height,
      s(:send,
        s(:send,
          s(:send,
            s(:lvar, :t), :font), :metrics,
          s(:sym, :linespace)), :+,
        s(:int, 2))),
    s(:if,
      s(:send,
        s(:lvar, :height), :<,
        s(:int, 18)),
      s(:lvasgn, :height,
        s(:int, 18)), nil),
    s(:send,
      s(:lvar, :t), :configure,
      s(:hash,
        s(:pair,
          s(:sym, :itemheight),
          s(:lvar, :height)),
        s(:pair,
          s(:sym, :selectmode),
          s(:sym, :browse)),
        s(:pair,
          s(:sym, :showlines),
          s(:true)),
        s(:pair,
          s(:sym, :showroot),
          s(:true)),
        s(:pair,
          s(:sym, :showrootbutton),
          s(:false)),
        s(:pair,
          s(:sym, :showbuttons),
          s(:true)))),
    s(:if,
      s(:gvar, :$HasColumnCreate),
      s(:send,
        s(:lvar, :t), :column_create,
        s(:hash,
          s(:pair,
            s(:sym, :text),
            s(:str, "Folders")))),
      s(:send,
        s(:lvar, :t), :column_configure,
        s(:int, 0),
        s(:hash,
          s(:pair,
            s(:sym, :text),
            s(:str, "Folders"))))),
    s(:send,
      s(:lvar, :t), :element_create,
      s(:str, "e1"),
      s(:sym, :image)),
    s(:send,
      s(:lvar, :t), :element_create,
      s(:str, "e2"),
      s(:sym, :text),
      s(:hash,
        s(:pair,
          s(:sym, :lines),
          s(:int, 1)),
        s(:pair,
          s(:sym, :fill),
          s(:array,
            s(:ivar, :@SystemHighlightText),
            s(:array,
              s(:str, "selected"),
              s(:str, "focus")))))),
    s(:send,
      s(:lvar, :t), :element_create,
      s(:str, "e3"),
      s(:sym, :text),
      s(:hash,
        s(:pair,
          s(:sym, :lines),
          s(:int, 1)),
        s(:pair,
          s(:sym, :font),
          s(:send,
            s(:send,
              s(:send,
                s(:lvar, :t), :font), :dup), :weight,
            s(:sym, :bold))),
        s(:pair,
          s(:sym, :fill),
          s(:array,
            s(:ivar, :@SystemHighlightText),
            s(:array,
              s(:str, "selected"),
              s(:str, "focus")))))),
    s(:send,
      s(:lvar, :t), :element_create,
      s(:str, "e4"),
      s(:sym, :text),
      s(:hash,
        s(:pair,
          s(:sym, :fill),
          s(:str, "blue")))),
    s(:send,
      s(:lvar, :t), :element_create,
      s(:str, "e5"),
      s(:sym, :image),
      s(:hash,
        s(:pair,
          s(:sym, :image),
          s(:send,
            s(:ivar, :@images), :[],
            s(:str, "outlook-folder"))))),
    s(:send,
      s(:lvar, :t), :element_create,
      s(:str, "e6"),
      s(:sym, :rect),
      s(:hash,
        s(:pair,
          s(:sym, :showfocus),
          s(:true)),
        s(:pair,
          s(:sym, :fill),
          s(:array,
            s(:ivar, :@SystemHighlight),
            s(:array,
              s(:str, "selected"),
              s(:str, "focus")),
            s(:str, "gray"),
            s(:array,
              s(:str, "selected"),
              s(:str, "!focus")))))),
    s(:lvasgn, :s,
      s(:send,
        s(:lvar, :t), :style_create,
        s(:str, "s1"))),
    s(:send,
      s(:lvar, :t), :style_elements,
      s(:lvar, :s),
      s(:array,
        s(:str, "e6"),
        s(:str, "e1"),
        s(:str, "e2"))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e1"),
      s(:hash,
        s(:pair,
          s(:sym, :expand),
          s(:sym, :ns)))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e2"),
      s(:hash,
        s(:pair,
          s(:sym, :padx),
          s(:array,
            s(:int, 4),
            s(:int, 0))),
        s(:pair,
          s(:sym, :expand),
          s(:sym, :ns)),
        s(:pair,
          s(:sym, :squeeze),
          s(:sym, :x)))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e6"),
      s(:hash,
        s(:pair,
          s(:sym, :union),
          s(:array,
            s(:str, "e2"))),
        s(:pair,
          s(:sym, :iexpand),
          s(:sym, :ns)),
        s(:pair,
          s(:sym, :ipadx),
          s(:int, 2)))),
    s(:lvasgn, :s,
      s(:send,
        s(:lvar, :t), :style_create,
        s(:str, "s2"))),
    s(:send,
      s(:lvar, :t), :style_elements,
      s(:lvar, :s),
      s(:array,
        s(:str, "e6"),
        s(:str, "e1"),
        s(:str, "e3"),
        s(:str, "e4"))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e1"),
      s(:hash,
        s(:pair,
          s(:sym, :expand),
          s(:sym, :ns)))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e3"),
      s(:hash,
        s(:pair,
          s(:sym, :padx),
          s(:int, 4)),
        s(:pair,
          s(:sym, :expand),
          s(:sym, :ns)),
        s(:pair,
          s(:sym, :squeeze),
          s(:sym, :x)))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e4"),
      s(:hash,
        s(:pair,
          s(:sym, :expand),
          s(:sym, :ns)))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e6"),
      s(:hash,
        s(:pair,
          s(:sym, :union),
          s(:array,
            s(:str, "e3"))),
        s(:pair,
          s(:sym, :iexpand),
          s(:sym, :ns)),
        s(:pair,
          s(:sym, :ipadx),
          s(:int, 2)))),
    s(:lvasgn, :s,
      s(:send,
        s(:lvar, :t), :style_create,
        s(:str, "s3"))),
    s(:send,
      s(:lvar, :t), :style_elements,
      s(:lvar, :s),
      s(:array,
        s(:str, "e6"),
        s(:str, "e5"),
        s(:str, "e2"))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e5"),
      s(:hash,
        s(:pair,
          s(:sym, :expand),
          s(:sym, :ns)))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e2"),
      s(:hash,
        s(:pair,
          s(:sym, :padx),
          s(:array,
            s(:int, 4),
            s(:int, 0))),
        s(:pair,
          s(:sym, :expand),
          s(:sym, :ns)),
        s(:pair,
          s(:sym, :squeeze),
          s(:sym, :x)))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e6"),
      s(:hash,
        s(:pair,
          s(:sym, :union),
          s(:array,
            s(:str, "e2"))),
        s(:pair,
          s(:sym, :iexpand),
          s(:sym, :ns)),
        s(:pair,
          s(:sym, :ipadx),
          s(:int, 2)))),
    s(:lvasgn, :s,
      s(:send,
        s(:lvar, :t), :style_create,
        s(:str, "s4"))),
    s(:send,
      s(:lvar, :t), :style_elements,
      s(:lvar, :s),
      s(:array,
        s(:str, "e6"),
        s(:str, "e5"),
        s(:str, "e3"),
        s(:str, "e4"))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e5"),
      s(:hash,
        s(:pair,
          s(:sym, :expand),
          s(:sym, :ns)))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e3"),
      s(:hash,
        s(:pair,
          s(:sym, :padx),
          s(:int, 4)),
        s(:pair,
          s(:sym, :expand),
          s(:sym, :ns)),
        s(:pair,
          s(:sym, :squeeze),
          s(:sym, :x)))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e4"),
      s(:hash,
        s(:pair,
          s(:sym, :expand),
          s(:sym, :ns)))),
    s(:send,
      s(:lvar, :t), :style_layout,
      s(:lvar, :s),
      s(:str, "e6"),
      s(:hash,
        s(:pair,
          s(:sym, :union),
          s(:array,
            s(:str, "e3"))),
        s(:pair,
          s(:sym, :iexpand),
          s(:sym, :ns)),
        s(:pair,
          s(:sym, :ipadx),
          s(:int, 2)))),
    s(:send,
      s(:lvar, :t), :item_style_set,
      s(:sym, :root),
      s(:int, 0),
      s(:str, "s1")),
    s(:send,
      s(:lvar, :t), :item_complex,
      s(:sym, :root),
      s(:array,
        s(:array,
          s(:str, "e1"),
          s(:hash,
            s(:pair,
              s(:sym, :image),
              s(:send,
                s(:ivar, :@images), :[],
                s(:str, "outlook-main"))))),
        s(:array,
          s(:str, "e2"),
          s(:hash,
            s(:pair,
              s(:sym, :text),
              s(:str, "Outlook Express")))))),
    s(:lvasgn, :parentList,
      s(:array,
        s(:sym, :root),
        s(:str, ""),
        s(:str, ""),
        s(:str, ""),
        s(:str, ""),
        s(:str, ""),
        s(:str, ""))),
    s(:lvasgn, :parent,
      s(:sym, :root)),
    s(:block,
      s(:send,
        s(:array,
          s(:array,
            s(:int, 0),
            s(:sym, :local),
            s(:str, "Local Folders"),
            s(:true),
            s(:int, 0)),
          s(:array,
            s(:int, 1),
            s(:sym, :inbox),
            s(:str, "Inbox"),
            s(:false),
            s(:int, 5)),
          s(:array,
            s(:int, 1),
            s(:sym, :outbox),
            s(:str, "Outbox"),
            s(:false),
            s(:int, 0)),
          s(:array,
            s(:int, 1),
            s(:sym, :sent),
            s(:str, "Sent Items"),
            s(:false),
            s(:int, 0)),
          s(:array,
            s(:int, 1),
            s(:sym, :deleted),
            s(:str, "Deleted Items"),
            s(:false),
            s(:int, 50)),
          s(:array,
            s(:int, 1),
            s(:sym, :draft),
            s(:str, "Drafts"),
            s(:false),
            s(:int, 0)),
          s(:array,
            s(:int, 1),
            s(:sym, :folder),
            s(:str, "Messages to Dad"),
            s(:false),
            s(:int, 0)),
          s(:array,
            s(:int, 1),
            s(:sym, :folder),
            s(:str, "Messages to Sis"),
            s(:false),
            s(:int, 0)),
          s(:array,
            s(:int, 1),
            s(:sym, :folder),
            s(:str, "Messages to Me"),
            s(:false),
            s(:int, 0)),
          s(:array,
            s(:int, 2),
            s(:sym, :folder),
            s(:str, "2001"),
            s(:false),
            s(:int, 0)),
          s(:array,
            s(:int, 2),
            s(:sym, :folder),
            s(:str, "2000"),
            s(:false),
            s(:int, 0)),
          s(:array,
            s(:int, 2),
            s(:sym, :folder),
            s(:str, "1999"),
            s(:false),
            s(:int, 0)),
          s(:array,
            s(:int, 0),
            s(:sym, :server),
            s(:str, "news.gmane.org"),
            s(:true),
            s(:int, 0)),
          s(:array,
            s(:int, 1),
            s(:sym, :group),
            s(:str, "gmane.comp.lang.lua.general"),
            s(:false),
            s(:int, 498))), :each),
      s(:args,
        s(:arg, :depth),
        s(:arg, :img),
        s(:arg, :text),
        s(:arg, :button),
        s(:arg, :unread)),
      s(:begin,
        s(:if,
          s(:gvar, :$Version_1_1_OrLater),
          s(:lvasgn, :item,
            s(:send,
              s(:lvar, :t), :item_create,
              s(:hash,
                s(:pair,
                  s(:sym, :button),
                  s(:lvar, :button))))),
          s(:begin,
            s(:lvasgn, :item,
              s(:send,
                s(:lvar, :t), :item_create)),
            s(:send,
              s(:lvar, :t), :item_hasbutton,
              s(:lvar, :item),
              s(:lvar, :button)))),
        s(:if,
          s(:send,
            s(:lvar, :img), :==,
            s(:sym, :folder)),
          s(:if,
            s(:send,
              s(:lvar, :unread), :!=,
              s(:int, 0)),
            s(:begin,
              s(:send,
                s(:lvar, :t), :item_style_set,
                s(:lvar, :item),
                s(:int, 0),
                s(:str, "s4")),
              s(:send,
                s(:lvar, :t), :item_complex,
                s(:lvar, :item),
                s(:array,
                  s(:array,
                    s(:str, "e3"),
                    s(:hash,
                      s(:pair,
                        s(:sym, :text),
                        s(:lvar, :text)))),
                  s(:array,
                    s(:str, "e4"),
                    s(:hash,
                      s(:pair,
                        s(:sym, :text),
                        s(:dstr,
                          s(:str, "("),
                          s(:begin,
                            s(:lvar, :unread)),
                          s(:str, ")")))))))),
            s(:begin,
              s(:send,
                s(:lvar, :t), :item_style_set,
                s(:lvar, :item),
                s(:int, 0),
                s(:str, "s3")),
              s(:send,
                s(:lvar, :t), :item_complex,
                s(:lvar, :item),
                s(:array,
                  s(:array,
                    s(:str, "e2"),
                    s(:hash,
                      s(:pair,
                        s(:sym, :text),
                        s(:lvar, :text)))))))),
          s(:if,
            s(:send,
              s(:lvar, :unread), :!=,
              s(:int, 0)),
            s(:begin,
              s(:send,
                s(:lvar, :t), :item_style_set,
                s(:lvar, :item),
                s(:int, 0),
                s(:str, "s2")),
              s(:send,
                s(:lvar, :t), :item_complex,
                s(:lvar, :item),
                s(:array,
                  s(:array,
                    s(:str, "e1"),
                    s(:hash,
                      s(:pair,
                        s(:sym, :image),
                        s(:send,
                          s(:ivar, :@images), :[],
                          s(:dstr,
                            s(:str, "outlook-"),
                            s(:begin,
                              s(:lvar, :img))))))),
                  s(:array,
                    s(:str, "e3"),
                    s(:hash,
                      s(:pair,
                        s(:sym, :text),
                        s(:lvar, :text)))),
                  s(:array,
                    s(:str, "e4"),
                    s(:hash,
                      s(:pair,
                        s(:sym, :text),
                        s(:dstr,
                          s(:str, "("),
                          s(:begin,
                            s(:lvar, :unread)),
                          s(:str, ")")))))))),
            s(:begin,
              s(:send,
                s(:lvar, :t), :item_style_set,
                s(:lvar, :item),
                s(:int, 0),
                s(:str, "s1")),
              s(:send,
                s(:lvar, :t), :item_complex,
                s(:lvar, :item),
                s(:array,
                  s(:array,
                    s(:str, "e1"),
                    s(:hash,
                      s(:pair,
                        s(:sym, :image),
                        s(:send,
                          s(:ivar, :@images), :[],
                          s(:dstr,
                            s(:str, "outlook-"),
                            s(:begin,
                              s(:lvar, :img))))))),
                  s(:array,
                    s(:str, "e2"),
                    s(:hash,
                      s(:pair,
                        s(:sym, :text),
                        s(:lvar, :text))))))))),
        s(:send,
          s(:lvar, :t), :item_lastchild,
          s(:send,
            s(:lvar, :parentList), :[],
            s(:lvar, :depth)),
          s(:lvar, :item)),
        s(:op_asgn,
          s(:lvasgn, :depth), :+,
          s(:int, 1)),
        s(:send,
          s(:lvar, :parentList), :[]=,
          s(:lvar, :depth),
          s(:lvar, :item))))))
