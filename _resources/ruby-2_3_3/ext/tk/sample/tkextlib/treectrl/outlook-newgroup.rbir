s(:begin,
  s(:def, :demoOutlookNewsgroup,
    s(:args,
      s(:arg, :t)),
    s(:begin,
      s(:send, nil, :init_pics,
        s(:str, "outlook-*")),
      s(:lvasgn, :height,
        s(:send,
          s(:send,
            s(:lvar, :t), :font), :metrics,
          s(:sym, :linespace))),
      s(:if,
        s(:send,
          s(:lvar, :height), :<,
          s(:int, 18)),
        s(:lvasgn, :height,
          s(:int, 18)), nil),
      s(:send,
        s(:lvar, :t), :configure,
        s(:hash,
          s(:pair,
            s(:sym, :itemheight),
            s(:lvar, :height)),
          s(:pair,
            s(:sym, :selectmode),
            s(:sym, :browse)),
          s(:pair,
            s(:sym, :showlines),
            s(:false)),
          s(:pair,
            s(:sym, :showroot),
            s(:false)),
          s(:pair,
            s(:sym, :showrootbutton),
            s(:false)),
          s(:pair,
            s(:sym, :showbuttons),
            s(:true)))),
      s(:if,
        s(:gvar, :$Version_1_1_OrLater),
        s(:begin,
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :image),
                s(:send,
                  s(:ivar, :@images), :[],
                  s(:str, "outlook-clip"))),
              s(:pair,
                s(:sym, :tag),
                s(:str, "clip")))),
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :image),
                s(:send,
                  s(:ivar, :@images), :[],
                  s(:str, "outlook-arrow"))),
              s(:pair,
                s(:sym, :tag),
                s(:str, "arrow")))),
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :image),
                s(:send,
                  s(:ivar, :@images), :[],
                  s(:str, "outlook-watch"))),
              s(:pair,
                s(:sym, :tag),
                s(:str, "watch")))),
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "Subject")),
              s(:pair,
                s(:sym, :width),
                s(:int, 250)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "subject")))),
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "From")),
              s(:pair,
                s(:sym, :width),
                s(:int, 150)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "from")))),
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "Sent")),
              s(:pair,
                s(:sym, :width),
                s(:int, 150)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "sent")))),
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "Size")),
              s(:pair,
                s(:sym, :width),
                s(:int, 60)),
              s(:pair,
                s(:sym, :justify),
                s(:sym, :right)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "size"))))),
        s(:begin,
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 0),
            s(:hash,
              s(:pair,
                s(:sym, :image),
                s(:send,
                  s(:ivar, :@images), :[],
                  s(:str, "outlook-clip"))),
              s(:pair,
                s(:sym, :tag),
                s(:str, "clip")))),
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 1),
            s(:hash,
              s(:pair,
                s(:sym, :image),
                s(:send,
                  s(:ivar, :@images), :[],
                  s(:str, "outlook-arrow"))),
              s(:pair,
                s(:sym, :tag),
                s(:str, "arrow")))),
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 2),
            s(:hash,
              s(:pair,
                s(:sym, :image),
                s(:send,
                  s(:ivar, :@images), :[],
                  s(:str, "outlook-watch"))),
              s(:pair,
                s(:sym, :tag),
                s(:str, "watch")))),
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 3),
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "Subject")),
              s(:pair,
                s(:sym, :width),
                s(:int, 250)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "subject")))),
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 4),
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "From")),
              s(:pair,
                s(:sym, :width),
                s(:int, 150)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "from")))),
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 5),
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "Sent")),
              s(:pair,
                s(:sym, :width),
                s(:int, 150)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "sent")))),
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 6),
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "Size")),
              s(:pair,
                s(:sym, :width),
                s(:int, 60)),
              s(:pair,
                s(:sym, :justify),
                s(:sym, :right)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "size")))))),
      s(:send,
        s(:lvar, :t), :treecolumn=,
        s(:int, 3)),
      s(:send,
        s(:lvar, :t), :state_define,
        s(:str, "read")),
      s(:send,
        s(:lvar, :t), :state_define,
        s(:str, "unread")),
      s(:send,
        s(:lvar, :t), :element_create,
        s(:str, "elemImg"),
        s(:sym, :image),
        s(:hash,
          s(:pair,
            s(:sym, :image),
            s(:array,
              s(:send,
                s(:ivar, :@sel_images), :[],
                s(:str, "outlook-read-2")),
              s(:array,
                s(:str, "selected"),
                s(:str, "read"),
                s(:str, "unread"),
                s(:str, "!open")),
              s(:send,
                s(:ivar, :@images), :[],
                s(:str, "outlook-read-2")),
              s(:array,
                s(:str, "read"),
                s(:str, "unread"),
                s(:str, "!open")),
              s(:send,
                s(:ivar, :@sel_images), :[],
                s(:str, "outlook-read")),
              s(:array,
                s(:str, "selected"),
                s(:str, "read")),
              s(:send,
                s(:ivar, :@images), :[],
                s(:str, "outlook-read")),
              s(:array,
                s(:str, "read")),
              s(:send,
                s(:ivar, :@sel_images), :[],
                s(:str, "outlook-unread")),
              s(:array,
                s(:str, "selected")),
              s(:send,
                s(:ivar, :@images), :[],
                s(:str, "outlook-unread")),
              s(:array))))),
      s(:send,
        s(:lvar, :t), :element_create,
        s(:str, "elemTxt"),
        s(:sym, :text),
        s(:hash,
          s(:pair,
            s(:sym, :lines),
            s(:int, 1)),
          s(:pair,
            s(:sym, :fill),
            s(:array,
              s(:ivar, :@SystemHighlightText),
              s(:array,
                s(:str, "selected"),
                s(:str, "focus")))),
          s(:pair,
            s(:sym, :font),
            s(:array,
              s(:send,
                s(:send,
                  s(:send,
                    s(:lvar, :t), :font), :dup), :weight,
                s(:sym, :bold)),
              s(:array,
                s(:str, "read"),
                s(:str, "unread"),
                s(:str, "!open")),
              s(:send,
                s(:send,
                  s(:send,
                    s(:lvar, :t), :font), :dup), :weight,
                s(:sym, :bold)),
              s(:array,
                s(:str, "!read")))))),
      s(:send,
        s(:lvar, :t), :element_create,
        s(:str, "sel.e"),
        s(:sym, :rect),
        s(:hash,
          s(:pair,
            s(:sym, :open),
            s(:sym, :e)),
          s(:pair,
            s(:sym, :showfocus),
            s(:true)),
          s(:pair,
            s(:sym, :fill),
            s(:array,
              s(:ivar, :@SystemHighlight),
              s(:array,
                s(:str, "selected"),
                s(:str, "focus")),
              s(:str, "gray"),
              s(:array,
                s(:str, "selected"),
                s(:str, "!focus")))))),
      s(:send,
        s(:lvar, :t), :element_create,
        s(:str, "sel.w"),
        s(:sym, :rect),
        s(:hash,
          s(:pair,
            s(:sym, :open),
            s(:sym, :w)),
          s(:pair,
            s(:sym, :showfocus),
            s(:true)),
          s(:pair,
            s(:sym, :fill),
            s(:array,
              s(:ivar, :@SystemHighlight),
              s(:array,
                s(:str, "selected"),
                s(:str, "focus")),
              s(:str, "gray"),
              s(:array,
                s(:str, "selected"),
                s(:str, "!focus")))))),
      s(:send,
        s(:lvar, :t), :element_create,
        s(:str, "sel.we"),
        s(:sym, :rect),
        s(:hash,
          s(:pair,
            s(:sym, :open),
            s(:sym, :we)),
          s(:pair,
            s(:sym, :showfocus),
            s(:true)),
          s(:pair,
            s(:sym, :fill),
            s(:array,
              s(:ivar, :@SystemHighlight),
              s(:array,
                s(:str, "selected"),
                s(:str, "focus")),
              s(:str, "gray"),
              s(:array,
                s(:str, "selected"),
                s(:str, "!focus")))))),
      s(:lvasgn, :s,
        s(:send,
          s(:lvar, :t), :style_create,
          s(:str, "s1"))),
      s(:send,
        s(:lvar, :t), :style_elements,
        s(:lvar, :s),
        s(:array,
          s(:str, "sel.e"),
          s(:str, "elemImg"),
          s(:str, "elemTxt"))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "elemImg"),
        s(:hash,
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "elemTxt"),
        s(:hash,
          s(:pair,
            s(:sym, :padx),
            s(:array,
              s(:int, 2),
              s(:int, 6))),
          s(:pair,
            s(:sym, :squeeze),
            s(:sym, :x)),
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "sel.e"),
        s(:hash,
          s(:pair,
            s(:sym, :union),
            s(:array,
              s(:str, "elemTxt"))),
          s(:pair,
            s(:sym, :iexpand),
            s(:sym, :nes)),
          s(:pair,
            s(:sym, :ipadx),
            s(:array,
              s(:int, 2),
              s(:int, 0))))),
      s(:lvasgn, :s,
        s(:send,
          s(:lvar, :t), :style_create,
          s(:str, "s2.we"))),
      s(:send,
        s(:lvar, :t), :style_elements,
        s(:lvar, :s),
        s(:array,
          s(:str, "sel.we"),
          s(:str, "elemTxt"))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "elemTxt"),
        s(:hash,
          s(:pair,
            s(:sym, :padx),
            s(:int, 6)),
          s(:pair,
            s(:sym, :squeeze),
            s(:sym, :x)),
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "sel.we"),
        s(:hash,
          s(:pair,
            s(:sym, :detach),
            s(:true)),
          s(:pair,
            s(:sym, :iexpand),
            s(:sym, :es)))),
      s(:lvasgn, :s,
        s(:send,
          s(:lvar, :t), :style_create,
          s(:str, "s2.w"))),
      s(:send,
        s(:lvar, :t), :style_elements,
        s(:lvar, :s),
        s(:array,
          s(:str, "sel.w"),
          s(:str, "elemTxt"))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "elemTxt"),
        s(:hash,
          s(:pair,
            s(:sym, :padx),
            s(:int, 6)),
          s(:pair,
            s(:sym, :squeeze),
            s(:sym, :x)),
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "sel.w"),
        s(:hash,
          s(:pair,
            s(:sym, :detach),
            s(:true)),
          s(:pair,
            s(:sym, :iexpand),
            s(:sym, :es)))),
      s(:if,
        s(:gvar, :$Version_1_1_OrLater),
        s(:send,
          s(:lvar, :t), :defaultstyle=,
          s(:array,
            s(:str, ""),
            s(:str, ""),
            s(:str, ""),
            s(:str, "s1"),
            s(:str, "s2.we"),
            s(:str, "s2.we"),
            s(:str, "s2.w"))), nil),
      s(:lvasgn, :msgCnt,
        s(:int, 100)),
      s(:lvasgn, :thread,
        s(:int, 0)),
      s(:ivasgn, :@Message,
        s(:block,
          s(:send,
            s(:const, nil, :Hash), :new),
          s(:args,
            s(:arg, :k),
            s(:arg, :v)),
          s(:send,
            s(:lvar, :k), :[]=,
            s(:lvar, :v),
            s(:send,
              s(:const, nil, :Hash), :new)))),
      s(:send,
        s(:send,
          s(:ivar, :@Message), :[],
          s(:sym, :count)), :[]=,
        s(:int, 0),
        s(:int, 0)),
      s(:lvasgn, :items,
        s(:array,
          s(:send,
            s(:lvar, :t), :index,
            s(:sym, :root)))),
      s(:block,
        s(:send,
          s(:begin,
            s(:erange,
              s(:int, 1),
              s(:begin,
                s(:lvar, :msgCnt)))), :each),
        s(:args,
          s(:arg, :i)),
        s(:begin,
          s(:lvasgn, :item_i,
            s(:send,
              s(:lvar, :t), :item_create)),
          s(:lvasgn, :item_j,
            s(:nil)),
          s(:lvasgn, :j,
            s(:nil)),
          s(:block,
            s(:send, nil, :loop),
            s(:args),
            s(:begin,
              s(:lvasgn, :j,
                s(:send, nil, :rand,
                  s(:lvar, :i))),
              s(:lvasgn, :item_j,
                s(:send,
                  s(:lvar, :items), :[],
                  s(:lvar, :j))),
              s(:if,
                s(:send,
                  s(:lvar, :j), :==,
                  s(:int, 0)),
                s(:break), nil),
              s(:if,
                s(:send,
                  s(:send,
                    s(:lvar, :t), :depth,
                    s(:lvar, :item_j)), :==,
                  s(:int, 5)),
                s(:next), nil),
              s(:if,
                s(:send,
                  s(:send,
                    s(:send,
                      s(:ivar, :@Message), :[],
                      s(:sym, :count)), :[],
                    s(:send,
                      s(:send,
                        s(:ivar, :@Message), :[],
                        s(:sym, :thread)), :[],
                      s(:lvar, :item_j))), :==,
                  s(:int, 15)),
                s(:next), nil),
              s(:break))),
          s(:send,
            s(:lvar, :t), :item_lastchild,
            s(:lvar, :item_j),
            s(:lvar, :item_i)),
          s(:send,
            s(:send,
              s(:ivar, :@Message), :[],
              s(:sym, :read)), :[]=,
            s(:lvar, :item_i),
            s(:begin,
              s(:send,
                s(:send, nil, :rand,
                  s(:int, 2)), :==,
                s(:int, 0)))),
          s(:if,
            s(:send,
              s(:lvar, :j), :==,
              s(:int, 0)),
            s(:begin,
              s(:op_asgn,
                s(:lvasgn, :thread), :+,
                s(:int, 1)),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :thread)), :[]=,
                s(:lvar, :item_i),
                s(:lvar, :thread)),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :seconds)), :[]=,
                s(:lvar, :item_i),
                s(:begin,
                  s(:send,
                    s(:send,
                      s(:const,
                        s(:const, nil, :Tk), :Clock), :seconds), :-,
                    s(:send, nil, :rand,
                      s(:int, 500000))))),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :seconds2)), :[]=,
                s(:lvar, :item_i),
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :seconds)), :[],
                  s(:lvar, :item_i))),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :count)), :[]=,
                s(:lvar, :thread),
                s(:int, 1))),
            s(:begin,
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :thread)), :[]=,
                s(:lvar, :item_i),
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :thread)), :[],
                  s(:lvar, :item_j))),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :seconds)), :[]=,
                s(:lvar, :item_i),
                s(:begin,
                  s(:send,
                    s(:send,
                      s(:send,
                        s(:ivar, :@Message), :[],
                        s(:sym, :seconds2)), :[],
                      s(:lvar, :item_j)), :+,
                    s(:send, nil, :rand,
                      s(:int, 10000))))),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :seconds2)), :[]=,
                s(:lvar, :item_i),
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :seconds)), :[],
                  s(:lvar, :item_i))),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :seconds2)), :[]=,
                s(:lvar, :item_j),
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :seconds)), :[],
                  s(:lvar, :item_i))),
              s(:op_asgn,
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :count)), :[],
                  s(:send,
                    s(:send,
                      s(:ivar, :@Message), :[],
                      s(:sym, :thread)), :[],
                    s(:lvar, :item_j))), :+,
                s(:int, 1)))),
          s(:send,
            s(:lvar, :items), :<<,
            s(:lvar, :item_i)))),
      s(:block,
        s(:send,
          s(:begin,
            s(:erange,
              s(:int, 1),
              s(:begin,
                s(:lvar, :msgCnt)))), :each),
        s(:args,
          s(:arg, :i)),
        s(:begin,
          s(:lvasgn, :item_i,
            s(:send,
              s(:lvar, :items), :[],
              s(:lvar, :i))),
          s(:lvasgn, :subject,
            s(:dstr,
              s(:str, "This is thread number "),
              s(:begin,
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :thread)), :[],
                  s(:lvar, :item_i))))),
          s(:lvasgn, :from,
            s(:str, "somebody@somewhere.net")),
          s(:lvasgn, :sent,
            s(:send,
              s(:const,
                s(:const, nil, :Tk), :Clock), :format,
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :seconds)), :[],
                s(:lvar, :item_i)),
              s(:str, "%d/%m/%y %I:%M %p"))),
          s(:lvasgn, :size,
            s(:dstr,
              s(:begin,
                s(:send,
                  s(:int, 1), :+,
                  s(:send, nil, :rand,
                    s(:int, 10)))),
              s(:str, "KB"))),
          s(:if,
            s(:send,
              s(:send,
                s(:ivar, :@Message), :[],
                s(:sym, :read)), :[],
              s(:lvar, :item_i)),
            s(:send,
              s(:lvar, :t), :item_state_set,
              s(:lvar, :item_i),
              s(:str, "read")), nil),
          s(:if,
            s(:send, nil, :anyUnreadDescendants,
              s(:lvar, :t),
              s(:lvar, :item_i)),
            s(:send,
              s(:lvar, :t), :item_state_set,
              s(:lvar, :item_i),
              s(:str, "unread")), nil),
          s(:if,
            s(:send,
              s(:send,
                s(:lvar, :t), :item_numchildren,
                s(:lvar, :item_i)), :>,
              s(:int, 0)),
            s(:begin,
              s(:if,
                s(:gvar, :$Version_1_1_OrLater),
                s(:send,
                  s(:lvar, :t), :item_configure,
                  s(:lvar, :item_i),
                  s(:hash,
                    s(:pair,
                      s(:sym, :button),
                      s(:true)))),
                s(:send,
                  s(:lvar, :t), :item_hasbutton,
                  s(:lvar, :item_i),
                  s(:true))),
              s(:if,
                s(:gvar, :$Version_1_1_OrLater),
                s(:if,
                  s(:send,
                    s(:send, nil, :rand,
                      s(:int, 2)), :==,
                    s(:int, 0)),
                  s(:send,
                    s(:lvar, :t), :item_collapse,
                    s(:lvar, :item_i)), nil),
                s(:if,
                  s(:send,
                    s(:send, nil, :rand,
                      s(:int, 2)), :==,
                    s(:int, 0)),
                  s(:send,
                    s(:lvar, :t), :collapse,
                    s(:lvar, :item_i)), nil))), nil),
          s(:if,
            s(:gvar, :$Version_1_1_OrLater), nil,
            s(:send,
              s(:lvar, :t), :item_style_set,
              s(:lvar, :item_i),
              s(:int, 3),
              s(:str, "s1"),
              s(:int, 4),
              s(:str, "s2.we"),
              s(:int, 5),
              s(:str, "s2.we"),
              s(:int, 6),
              s(:str, "s2.w"))),
          s(:send,
            s(:lvar, :t), :item_text,
            s(:lvar, :item_i),
            s(:int, 3),
            s(:lvar, :subject),
            s(:int, 4),
            s(:lvar, :from),
            s(:int, 5),
            s(:lvar, :sent),
            s(:int, 6),
            s(:lvar, :size)))),
      s(:send,
        s(:lvar, :t), :notify_bind,
        s(:lvar, :t),
        s(:str, "Selection"),
        s(:block,
          s(:send, nil, :proc),
          s(:args,
            s(:arg, :w)),
          s(:if,
            s(:send,
              s(:send,
                s(:lvar, :w), :selection_count), :==,
              s(:int, 1)),
            s(:begin,
              s(:if,
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :afterId)), :[],
                  s(:sym, :id)),
                s(:send,
                  s(:const, nil, :Tk), :after_cancel,
                  s(:send,
                    s(:send,
                      s(:ivar, :@Message), :[],
                      s(:sym, :afterId)), :[],
                    s(:sym, :id))), nil),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :afterId)), :[]=,
                s(:sym, :item),
                s(:send,
                  s(:send,
                    s(:lvar, :w), :selection_get), :[],
                  s(:int, 0))),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :afterId)), :[]=,
                s(:sym, :id),
                s(:send,
                  s(:const, nil, :Tk), :after,
                  s(:int, 500),
                  s(:block,
                    s(:send, nil, :proc),
                    s(:args),
                    s(:send, nil, :messageReadDelayed,
                      s(:lvar, :w)))))), nil)),
        s(:str, "%T")))),
  s(:def, :messageReadDelayed,
    s(:args,
      s(:arg, :t)),
    s(:begin,
      s(:send,
        s(:send,
          s(:ivar, :@Message), :[],
          s(:sym, :afterId)), :delete,
        s(:sym, :id)),
      s(:lvasgn, :i,
        s(:send,
          s(:send,
            s(:ivar, :@Message), :[],
            s(:sym, :afterId)), :[],
          s(:sym, :item))),
      s(:if,
        s(:send,
          s(:lvar, :t), :selection_includes,
          s(:lvar, :i)), nil,
        s(:return)),
      s(:if,
        s(:send,
          s(:send,
            s(:ivar, :@Message), :[],
            s(:sym, :read)), :[],
          s(:lvar, :i)), nil,
        s(:begin,
          s(:send,
            s(:lvar, :t), :item_state_set,
            s(:lvar, :i),
            s(:str, "read")),
          s(:send,
            s(:send,
              s(:ivar, :@Message), :[],
              s(:sym, :read)), :[]=,
            s(:lvar, :i),
            s(:true)),
          s(:block,
            s(:send,
              s(:send,
                s(:send,
                  s(:lvar, :t), :item_ancestors,
                  s(:lvar, :i)), :[],
                s(:irange,
                  s(:int, 0),
                  s(:int, -2))), :each),
            s(:args,
              s(:arg, :i2)),
            s(:if,
              s(:send, nil, :anyUnreadDescendants,
                s(:lvar, :t),
                s(:lvar, :i2)), nil,
              s(:send,
                s(:lvar, :t), :item_state_set,
                s(:lvar, :i2),
                s(:str, "!unread")))))))),
  s(:def, :demoOutlookNewsgroup2,
    s(:args,
      s(:arg, :t)),
    s(:begin,
      s(:send, nil, :init_pics,
        s(:str, "outlook-*")),
      s(:lvasgn, :height,
        s(:send,
          s(:send,
            s(:lvar, :t), :font), :metrics,
          s(:sym, :linespace))),
      s(:if,
        s(:send,
          s(:lvar, :height), :<,
          s(:int, 18)),
        s(:lvasgn, :height,
          s(:int, 18)), nil),
      s(:send,
        s(:lvar, :t), :configure,
        s(:hash,
          s(:pair,
            s(:sym, :itemheight),
            s(:lvar, :height)),
          s(:pair,
            s(:sym, :selectmode),
            s(:sym, :browse)),
          s(:pair,
            s(:sym, :showlines),
            s(:false)),
          s(:pair,
            s(:sym, :showroot),
            s(:false)),
          s(:pair,
            s(:sym, :showrootbutton),
            s(:false)),
          s(:pair,
            s(:sym, :showbuttons),
            s(:true)))),
      s(:if,
        s(:gvar, :$Version_1_1_OrLater),
        s(:begin,
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :image),
                s(:send,
                  s(:ivar, :@images), :[],
                  s(:str, "outlook-clip"))),
              s(:pair,
                s(:sym, :tag),
                s(:str, "clip")))),
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :image),
                s(:send,
                  s(:ivar, :@images), :[],
                  s(:str, "outlook-arrow"))),
              s(:pair,
                s(:sym, :tag),
                s(:str, "arrow")))),
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :image),
                s(:send,
                  s(:ivar, :@images), :[],
                  s(:str, "outlook-watch"))),
              s(:pair,
                s(:sym, :tag),
                s(:str, "watch")))),
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "Subject")),
              s(:pair,
                s(:sym, :width),
                s(:int, 250)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "subject")))),
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "From")),
              s(:pair,
                s(:sym, :width),
                s(:int, 150)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "from")))),
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "Sent")),
              s(:pair,
                s(:sym, :width),
                s(:int, 150)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "sent")))),
          s(:send,
            s(:lvar, :t), :column_create,
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "Size")),
              s(:pair,
                s(:sym, :width),
                s(:int, 60)),
              s(:pair,
                s(:sym, :justify),
                s(:sym, :right)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "size"))))),
        s(:begin,
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 0),
            s(:hash,
              s(:pair,
                s(:sym, :image),
                s(:send,
                  s(:ivar, :@images), :[],
                  s(:str, "outlook-clip"))),
              s(:pair,
                s(:sym, :tag),
                s(:str, "clip")))),
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 1),
            s(:hash,
              s(:pair,
                s(:sym, :image),
                s(:send,
                  s(:ivar, :@images), :[],
                  s(:str, "outlook-arrow"))),
              s(:pair,
                s(:sym, :tag),
                s(:str, "arrow")))),
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 2),
            s(:hash,
              s(:pair,
                s(:sym, :image),
                s(:send,
                  s(:ivar, :@images), :[],
                  s(:str, "outlook-watch"))),
              s(:pair,
                s(:sym, :tag),
                s(:str, "watch")))),
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 3),
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "Subject")),
              s(:pair,
                s(:sym, :width),
                s(:int, 250)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "subject")))),
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 4),
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "From")),
              s(:pair,
                s(:sym, :width),
                s(:int, 150)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "from")))),
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 5),
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "Sent")),
              s(:pair,
                s(:sym, :width),
                s(:int, 150)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "sent")))),
          s(:send,
            s(:lvar, :t), :column_configure,
            s(:int, 6),
            s(:hash,
              s(:pair,
                s(:sym, :text),
                s(:str, "Size")),
              s(:pair,
                s(:sym, :width),
                s(:int, 60)),
              s(:pair,
                s(:sym, :justify),
                s(:sym, :right)),
              s(:pair,
                s(:sym, :tag),
                s(:str, "size")))))),
      s(:send,
        s(:lvar, :t), :treecolumn=,
        s(:int, 3)),
      s(:send,
        s(:lvar, :t), :element_create,
        s(:str, "image.unread"),
        s(:sym, :image),
        s(:hash,
          s(:pair,
            s(:sym, :image),
            s(:send,
              s(:ivar, :@images), :[],
              s(:str, "outlook-unread"))))),
      s(:send,
        s(:lvar, :t), :element_create,
        s(:str, "image.read"),
        s(:sym, :image),
        s(:hash,
          s(:pair,
            s(:sym, :image),
            s(:send,
              s(:ivar, :@images), :[],
              s(:str, "outlook-read"))))),
      s(:send,
        s(:lvar, :t), :element_create,
        s(:str, "image.read2"),
        s(:sym, :image),
        s(:hash,
          s(:pair,
            s(:sym, :image),
            s(:send,
              s(:ivar, :@images), :[],
              s(:str, "outlook-read-2"))))),
      s(:send,
        s(:lvar, :t), :element_create,
        s(:str, "text.read"),
        s(:sym, :text),
        s(:hash,
          s(:pair,
            s(:sym, :lines),
            s(:int, 1)),
          s(:pair,
            s(:sym, :fill),
            s(:array,
              s(:ivar, :@SystemHighlightText),
              s(:array,
                s(:str, "selected"),
                s(:str, "focus")))))),
      s(:send,
        s(:lvar, :t), :element_create,
        s(:str, "text.unread"),
        s(:sym, :text),
        s(:hash,
          s(:pair,
            s(:sym, :lines),
            s(:int, 1)),
          s(:pair,
            s(:sym, :fill),
            s(:array,
              s(:ivar, :@SystemHighlightText),
              s(:array,
                s(:str, "selected"),
                s(:str, "focus")))),
          s(:pair,
            s(:sym, :font),
            s(:send,
              s(:send,
                s(:send,
                  s(:lvar, :t), :font), :dup), :weight,
              s(:sym, :bold))))),
      s(:send,
        s(:lvar, :t), :element_create,
        s(:str, "sel.e"),
        s(:sym, :rect),
        s(:hash,
          s(:pair,
            s(:sym, :open),
            s(:sym, :e)),
          s(:pair,
            s(:sym, :showfocus),
            s(:true)),
          s(:pair,
            s(:sym, :fill),
            s(:array,
              s(:ivar, :@SystemHighlight),
              s(:array,
                s(:str, "selected"),
                s(:str, "focus")),
              s(:str, "gray"),
              s(:array,
                s(:str, "selected"),
                s(:str, "!focus")))))),
      s(:send,
        s(:lvar, :t), :element_create,
        s(:str, "sel.w"),
        s(:sym, :rect),
        s(:hash,
          s(:pair,
            s(:sym, :open),
            s(:sym, :w)),
          s(:pair,
            s(:sym, :showfocus),
            s(:true)),
          s(:pair,
            s(:sym, :fill),
            s(:array,
              s(:ivar, :@SystemHighlight),
              s(:array,
                s(:str, "selected"),
                s(:str, "focus")),
              s(:str, "gray"),
              s(:array,
                s(:str, "selected"),
                s(:str, "!focus")))))),
      s(:send,
        s(:lvar, :t), :element_create,
        s(:str, "sel.we"),
        s(:sym, :rect),
        s(:hash,
          s(:pair,
            s(:sym, :open),
            s(:sym, :we)),
          s(:pair,
            s(:sym, :showfocus),
            s(:true)),
          s(:pair,
            s(:sym, :fill),
            s(:array,
              s(:ivar, :@SystemHighlight),
              s(:array,
                s(:str, "selected"),
                s(:str, "focus")),
              s(:str, "gray"),
              s(:array,
                s(:str, "selected"),
                s(:str, "!focus")))))),
      s(:lvasgn, :s,
        s(:send,
          s(:lvar, :t), :style_create,
          s(:str, "unread"))),
      s(:send,
        s(:lvar, :t), :style_elements,
        s(:lvar, :s),
        s(:array,
          s(:str, "sel.e"),
          s(:str, "image.unread"),
          s(:str, "text.unread"))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "image.unread"),
        s(:hash,
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "text.unread"),
        s(:hash,
          s(:pair,
            s(:sym, :padx),
            s(:array,
              s(:int, 2),
              s(:int, 6))),
          s(:pair,
            s(:sym, :squeeze),
            s(:sym, :x)),
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "sel.e"),
        s(:hash,
          s(:pair,
            s(:sym, :union),
            s(:array,
              s(:str, "text.unread"))),
          s(:pair,
            s(:sym, :iexpand),
            s(:sym, :nes)),
          s(:pair,
            s(:sym, :ipadx),
            s(:array,
              s(:int, 2),
              s(:int, 0))))),
      s(:lvasgn, :s,
        s(:send,
          s(:lvar, :t), :style_create,
          s(:str, "read"))),
      s(:send,
        s(:lvar, :t), :style_elements,
        s(:lvar, :s),
        s(:array,
          s(:str, "sel.e"),
          s(:str, "image.read"),
          s(:str, "text.read"))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "image.read"),
        s(:hash,
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "text.read"),
        s(:hash,
          s(:pair,
            s(:sym, :padx),
            s(:array,
              s(:int, 2),
              s(:int, 6))),
          s(:pair,
            s(:sym, :squeeze),
            s(:sym, :x)),
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "sel.e"),
        s(:hash,
          s(:pair,
            s(:sym, :union),
            s(:array,
              s(:str, "text.read"))),
          s(:pair,
            s(:sym, :iexpand),
            s(:sym, :nes)),
          s(:pair,
            s(:sym, :ipadx),
            s(:array,
              s(:int, 2),
              s(:int, 0))))),
      s(:lvasgn, :s,
        s(:send,
          s(:lvar, :t), :style_create,
          s(:str, "read2"))),
      s(:send,
        s(:lvar, :t), :style_elements,
        s(:lvar, :s),
        s(:array,
          s(:str, "sel.e"),
          s(:str, "image.read2"),
          s(:str, "text.unread"))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "image.read2"),
        s(:hash,
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "text.unread"),
        s(:hash,
          s(:pair,
            s(:sym, :padx),
            s(:array,
              s(:int, 2),
              s(:int, 6))),
          s(:pair,
            s(:sym, :squeeze),
            s(:sym, :x)),
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "sel.e"),
        s(:hash,
          s(:pair,
            s(:sym, :union),
            s(:array,
              s(:str, "text.unread"))),
          s(:pair,
            s(:sym, :iexpand),
            s(:sym, :nes)),
          s(:pair,
            s(:sym, :ipadx),
            s(:array,
              s(:int, 2),
              s(:int, 0))))),
      s(:lvasgn, :s,
        s(:send,
          s(:lvar, :t), :style_create,
          s(:str, "unread.we"))),
      s(:send,
        s(:lvar, :t), :style_elements,
        s(:lvar, :s),
        s(:array,
          s(:str, "sel.we"),
          s(:str, "text.unread"))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "text.unread"),
        s(:hash,
          s(:pair,
            s(:sym, :padx),
            s(:int, 6)),
          s(:pair,
            s(:sym, :squeeze),
            s(:sym, :x)),
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "sel.we"),
        s(:hash,
          s(:pair,
            s(:sym, :detach),
            s(:true)),
          s(:pair,
            s(:sym, :iexpand),
            s(:sym, :es)))),
      s(:lvasgn, :s,
        s(:send,
          s(:lvar, :t), :style_create,
          s(:str, "read.we"))),
      s(:send,
        s(:lvar, :t), :style_elements,
        s(:lvar, :s),
        s(:array,
          s(:str, "sel.we"),
          s(:str, "text.read"))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "text.read"),
        s(:hash,
          s(:pair,
            s(:sym, :padx),
            s(:int, 6)),
          s(:pair,
            s(:sym, :squeeze),
            s(:sym, :x)),
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "sel.we"),
        s(:hash,
          s(:pair,
            s(:sym, :detach),
            s(:true)),
          s(:pair,
            s(:sym, :iexpand),
            s(:sym, :es)))),
      s(:lvasgn, :s,
        s(:send,
          s(:lvar, :t), :style_create,
          s(:str, "unread.w"))),
      s(:send,
        s(:lvar, :t), :style_elements,
        s(:lvar, :s),
        s(:array,
          s(:str, "sel.w"),
          s(:str, "text.unread"))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "text.unread"),
        s(:hash,
          s(:pair,
            s(:sym, :padx),
            s(:int, 6)),
          s(:pair,
            s(:sym, :squeeze),
            s(:sym, :x)),
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "sel.w"),
        s(:hash,
          s(:pair,
            s(:sym, :detach),
            s(:true)),
          s(:pair,
            s(:sym, :iexpand),
            s(:sym, :es)))),
      s(:lvasgn, :s,
        s(:send,
          s(:lvar, :t), :style_create,
          s(:str, "read.w"))),
      s(:send,
        s(:lvar, :t), :style_elements,
        s(:lvar, :s),
        s(:array,
          s(:str, "sel.w"),
          s(:str, "text.read"))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "text.read"),
        s(:hash,
          s(:pair,
            s(:sym, :padx),
            s(:int, 6)),
          s(:pair,
            s(:sym, :squeeze),
            s(:sym, :x)),
          s(:pair,
            s(:sym, :expand),
            s(:sym, :ns)))),
      s(:send,
        s(:lvar, :t), :style_layout,
        s(:lvar, :s),
        s(:str, "sel.w"),
        s(:hash,
          s(:pair,
            s(:sym, :detach),
            s(:true)),
          s(:pair,
            s(:sym, :iexpand),
            s(:sym, :es)))),
      s(:lvasgn, :msgCnt,
        s(:int, 100)),
      s(:lvasgn, :thread,
        s(:int, 0)),
      s(:ivasgn, :@Message,
        s(:block,
          s(:send,
            s(:const, nil, :Hash), :new),
          s(:args,
            s(:arg, :k),
            s(:arg, :v)),
          s(:send,
            s(:lvar, :k), :[]=,
            s(:lvar, :v),
            s(:send,
              s(:const, nil, :Hash), :new)))),
      s(:send,
        s(:send,
          s(:ivar, :@Message), :[],
          s(:sym, :count)), :[]=,
        s(:int, 0),
        s(:int, 0)),
      s(:block,
        s(:send,
          s(:begin,
            s(:erange,
              s(:int, 1),
              s(:begin,
                s(:lvar, :msgCnt)))), :each),
        s(:args,
          s(:arg, :i)),
        s(:begin,
          s(:send,
            s(:lvar, :t), :item_create),
          s(:lvasgn, :j,
            s(:nil)),
          s(:block,
            s(:send, nil, :loop),
            s(:args),
            s(:begin,
              s(:lvasgn, :j,
                s(:send, nil, :rand,
                  s(:lvar, :i))),
              s(:if,
                s(:send,
                  s(:lvar, :j), :==,
                  s(:int, 0)),
                s(:break), nil),
              s(:if,
                s(:send,
                  s(:send,
                    s(:lvar, :t), :depth,
                    s(:lvar, :j)), :==,
                  s(:int, 5)),
                s(:next), nil),
              s(:if,
                s(:send,
                  s(:send,
                    s(:send,
                      s(:ivar, :@Message), :[],
                      s(:sym, :count)), :[],
                    s(:send,
                      s(:send,
                        s(:ivar, :@Message), :[],
                        s(:sym, :thread)), :[],
                      s(:lvar, :j))), :==,
                  s(:int, 15)),
                s(:next), nil),
              s(:break))),
          s(:send,
            s(:lvar, :t), :item_lastchild,
            s(:lvar, :j),
            s(:lvar, :i)),
          s(:send,
            s(:send,
              s(:ivar, :@Message), :[],
              s(:sym, :read)), :[]=,
            s(:lvar, :i),
            s(:begin,
              s(:send,
                s(:send, nil, :rand,
                  s(:int, 2)), :==,
                s(:int, 0)))),
          s(:if,
            s(:send,
              s(:lvar, :j), :==,
              s(:int, 0)),
            s(:begin,
              s(:op_asgn,
                s(:lvasgn, :thread), :+,
                s(:int, 1)),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :thread)), :[]=,
                s(:lvar, :i),
                s(:lvar, :thread)),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :seconds)), :[]=,
                s(:lvar, :i),
                s(:begin,
                  s(:send,
                    s(:send,
                      s(:const,
                        s(:const, nil, :Tk), :Clock), :seconds), :-,
                    s(:send, nil, :rand,
                      s(:int, 500000))))),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :seconds2)), :[]=,
                s(:lvar, :i),
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :seconds)), :[],
                  s(:lvar, :i))),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :count)), :[]=,
                s(:lvar, :thread),
                s(:int, 1))),
            s(:begin,
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :thread)), :[]=,
                s(:lvar, :i),
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :thread)), :[],
                  s(:lvar, :j))),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :seconds)), :[]=,
                s(:lvar, :i),
                s(:begin,
                  s(:send,
                    s(:send,
                      s(:send,
                        s(:ivar, :@Message), :[],
                        s(:sym, :seconds2)), :[],
                      s(:lvar, :j)), :+,
                    s(:send, nil, :rand,
                      s(:int, 10000))))),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :seconds2)), :[]=,
                s(:lvar, :i),
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :seconds)), :[],
                  s(:lvar, :i))),
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :seconds2)), :[]=,
                s(:lvar, :j),
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :seconds)), :[],
                  s(:lvar, :i))),
              s(:op_asgn,
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :count)), :[],
                  s(:send,
                    s(:send,
                      s(:ivar, :@Message), :[],
                      s(:sym, :thread)), :[],
                    s(:lvar, :j))), :+,
                s(:int, 1)))))),
      s(:block,
        s(:send,
          s(:begin,
            s(:erange,
              s(:int, 1),
              s(:begin,
                s(:lvar, :msgCnt)))), :each),
        s(:args,
          s(:arg, :i)),
        s(:begin,
          s(:lvasgn, :subject,
            s(:dstr,
              s(:str, "This is thread number "),
              s(:begin,
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :thread)), :[],
                  s(:lvar, :i))))),
          s(:lvasgn, :from,
            s(:str, "somebody@somewhere.net")),
          s(:lvasgn, :sent,
            s(:send,
              s(:const,
                s(:const, nil, :Tk), :Clock), :format,
              s(:send,
                s(:send,
                  s(:ivar, :@Message), :[],
                  s(:sym, :seconds)), :[],
                s(:lvar, :i)),
              s(:str, "%d/%m/%y %I:%M %p"))),
          s(:lvasgn, :size,
            s(:dstr,
              s(:begin,
                s(:send,
                  s(:int, 1), :+,
                  s(:send, nil, :rand,
                    s(:int, 10)))),
              s(:str, "KB"))),
          s(:if,
            s(:send,
              s(:send,
                s(:ivar, :@Message), :[],
                s(:sym, :read)), :[],
              s(:lvar, :i)),
            s(:begin,
              s(:lvasgn, :style,
                s(:str, "read")),
              s(:lvasgn, :style2,
                s(:str, "read2"))),
            s(:begin,
              s(:lvasgn, :style,
                s(:str, "unread")),
              s(:lvasgn, :style2,
                s(:str, "unread2")))),
          s(:send,
            s(:lvar, :t), :item_style_set,
            s(:lvar, :i),
            s(:int, 3),
            s(:lvar, :style),
            s(:int, 4),
            s(:dstr,
              s(:begin,
                s(:lvar, :style2)),
              s(:str, ".we")),
            s(:int, 5),
            s(:dstr,
              s(:begin,
                s(:lvar, :style2)),
              s(:str, ".we")),
            s(:int, 6),
            s(:dstr,
              s(:begin,
                s(:lvar, :style2)),
              s(:str, ".w"))),
          s(:send,
            s(:lvar, :t), :item_text,
            s(:lvar, :i),
            s(:int, 3),
            s(:lvar, :subject),
            s(:int, 4),
            s(:lvar, :from),
            s(:int, 5),
            s(:lvar, :sent),
            s(:int, 6),
            s(:lvar, :size)),
          s(:if,
            s(:send,
              s(:send,
                s(:lvar, :t), :item_numchildren,
                s(:lvar, :i)), :>,
              s(:int, 0)),
            s(:send,
              s(:lvar, :t), :item_configure,
              s(:send, nil, :item_i),
              s(:hash,
                s(:pair,
                  s(:sym, :button),
                  s(:true)))), nil))),
      s(:send,
        s(:lvar, :t), :notify_bind,
        s(:lvar, :t),
        s(:str, "Selection"),
        s(:block,
          s(:send, nil, :proc),
          s(:args,
            s(:arg, :w)),
          s(:if,
            s(:send,
              s(:send,
                s(:lvar, :w), :selection_count), :==,
              s(:int, 1)),
            s(:begin,
              s(:lvasgn, :i,
                s(:send,
                  s(:send,
                    s(:lvar, :t), :selection_get), :[],
                  s(:int, 0))),
              s(:if,
                s(:send,
                  s(:send,
                    s(:ivar, :@Message), :[],
                    s(:sym, :read)), :[],
                  s(:lvar, :i)), nil,
                s(:begin,
                  s(:if,
                    s(:or,
                      s(:send,
                        s(:lvar, :t), :item_isopen,
                        s(:lvar, :i)),
                      s(:send,
                        s(:send, nil, :anyUnreadDescendants,
                          s(:lvar, :t),
                          s(:lvar, :i)), :!)),
                    s(:begin,
                      s(:send,
                        s(:lvar, :t), :item_style_map,
                        s(:lvar, :i),
                        s(:str, "subject"),
                        s(:str, "read"),
                        s(:array,
                          s(:str, "text.unread"),
                          s(:str, "text.read"))),
                      s(:send,
                        s(:lvar, :t), :item_style_map,
                        s(:lvar, :i),
                        s(:str, "from"),
                        s(:str, "read.we"),
                        s(:array,
                          s(:str, "text.unread"),
                          s(:str, "text.read"))),
                      s(:send,
                        s(:lvar, :t), :item_style_map,
                        s(:lvar, :i),
                        s(:str, "sent"),
                        s(:str, "read.we"),
                        s(:array,
                          s(:str, "text.unread"),
                          s(:str, "text.read"))),
                      s(:send,
                        s(:lvar, :t), :item_style_map,
                        s(:lvar, :i),
                        s(:str, "size"),
                        s(:str, "read.w"),
                        s(:array,
                          s(:str, "text.unread"),
                          s(:str, "text.read")))),
                    s(:send,
                      s(:lvar, :t), :item_style_map,
                      s(:lvar, :i),
                      s(:str, "subject"),
                      s(:str, "read2"),
                      s(:array,
                        s(:str, "text.unread"),
                        s(:str, "text.unread")))),
                  s(:send,
                    s(:send,
                      s(:ivar, :@Message), :[],
                      s(:sym, :read)), :[]=,
                    s(:lvar, :i),
                    s(:true)),
                  s(:send,
                    s(:ivar, :@display_styles_in_item), :call,
                    s(:lvar, :i))))), nil)),
        s(:str, "%T")),
      s(:send,
        s(:lvar, :t), :notify_bind,
        s(:lvar, :t),
        s(:str, "Expand-after"),
        s(:block,
          s(:send, nil, :proc),
          s(:args,
            s(:arg, :w),
            s(:arg, :i)),
          s(:if,
            s(:and,
              s(:send,
                s(:send,
                  s(:ivar, :@Messge), :[],
                  s(:sym, :read)), :[],
                s(:lvar, :i)),
              s(:send, nil, :anyUnreadDescendants,
                s(:lvar, :t),
                s(:lvar, :i))),
            s(:begin,
              s(:send,
                s(:lvar, :t), :item_style_map,
                s(:lvar, :i),
                s(:str, "subject"),
                s(:str, "read"),
                s(:array,
                  s(:str, "text.unread"),
                  s(:str, "text.read"))),
              s(:send,
                s(:lvar, :t), :item_style_map,
                s(:lvar, :i),
                s(:str, "from"),
                s(:str, "read.we"),
                s(:array,
                  s(:str, "text.unread"),
                  s(:str, "text.read"))),
              s(:send,
                s(:lvar, :t), :item_style_map,
                s(:lvar, :i),
                s(:str, "sent"),
                s(:str, "read.we"),
                s(:array,
                  s(:str, "text.unread"),
                  s(:str, "text.read"))),
              s(:send,
                s(:lvar, :t), :item_style_map,
                s(:lvar, :i),
                s(:str, "size"),
                s(:str, "read.w"),
                s(:array,
                  s(:str, "text.unread"),
                  s(:str, "text.read")))), nil)),
        s(:str, "%T %I")),
      s(:send,
        s(:lvar, :t), :notify_bind,
        s(:lvar, :t),
        s(:str, "Collapse-after"),
        s(:block,
          s(:send, nil, :proc),
          s(:args,
            s(:arg, :w),
            s(:arg, :i)),
          s(:if,
            s(:and,
              s(:send,
                s(:send,
                  s(:ivar, :@Messge), :[],
                  s(:sym, :read)), :[],
                s(:lvar, :i)),
              s(:send, nil, :anyUnreadDescendants,
                s(:lvar, :t),
                s(:lvar, :i))),
            s(:begin,
              s(:send,
                s(:lvar, :t), :item_style_map,
                s(:lvar, :i),
                s(:str, "subject"),
                s(:str, "read2"),
                s(:array,
                  s(:str, "text.read"),
                  s(:str, "text.unread"))),
              s(:send,
                s(:lvar, :t), :item_style_map,
                s(:lvar, :i),
                s(:str, "from"),
                s(:str, "unread.we"),
                s(:array,
                  s(:str, "text.read"),
                  s(:str, "text.unread"))),
              s(:send,
                s(:lvar, :t), :item_style_map,
                s(:lvar, :i),
                s(:str, "sent"),
                s(:str, "unread.we"),
                s(:array,
                  s(:str, "text.read"),
                  s(:str, "text.unread"))),
              s(:send,
                s(:lvar, :t), :item_style_map,
                s(:lvar, :i),
                s(:str, "size"),
                s(:str, "unread.w"),
                s(:array,
                  s(:str, "text.read"),
                  s(:str, "text.unread")))), nil)),
        s(:str, "%T %I")),
      s(:block,
        s(:send,
          s(:begin,
            s(:erange,
              s(:int, 1),
              s(:begin,
                s(:lvar, :msgCnt)))), :each),
        s(:args,
          s(:arg, :i)),
        s(:if,
          s(:send,
            s(:send, nil, :rand,
              s(:int, 2)), :==,
            s(:int, 0)),
          s(:if,
            s(:send,
              s(:send,
                s(:lvar, :t), :item_numchildren,
                s(:lvar, :i)), :>,
              s(:int, 0)),
            s(:if,
              s(:gvar, :$Version_1_1_OrLater),
              s(:send,
                s(:lvar, :t), :item_collapse,
                s(:lvar, :i)),
              s(:send,
                s(:lvar, :t), :collapse,
                s(:lvar, :i))), nil), nil)))),
  s(:def, :anyUnreadDescendants,
    s(:args,
      s(:arg, :t),
      s(:arg, :i)),
    s(:begin,
      s(:lvasgn, :itemList,
        s(:array)),
      s(:lvasgn, :item,
        s(:send,
          s(:lvar, :t), :item_firstchild,
          s(:lvar, :i))),
      s(:if,
        s(:send,
          s(:lvar, :item), :!=,
          s(:str, "")),
        s(:send,
          s(:lvar, :itemList), :push,
          s(:lvar, :item)), nil),
      s(:while,
        s(:lvasgn, :item,
          s(:send,
            s(:lvar, :itemList), :pop)),
        s(:begin,
          s(:if,
            s(:send,
              s(:send,
                s(:ivar, :@Message), :[],
                s(:sym, :read)), :[],
              s(:lvar, :item)), nil,
            s(:return,
              s(:true))),
          s(:lvasgn, :item2,
            s(:send,
              s(:lvar, :t), :item_nextsibling,
              s(:lvar, :item))),
          s(:if,
            s(:send,
              s(:lvar, :item2), :!=,
              s(:str, "")),
            s(:send,
              s(:lvar, :itemList), :push,
              s(:lvar, :item2)), nil),
          s(:lvasgn, :item2,
            s(:send,
              s(:lvar, :t), :item_firstchild,
              s(:lvar, :item))),
          s(:if,
            s(:send,
              s(:lvar, :item2), :!=,
              s(:str, "")),
            s(:send,
              s(:lvar, :itemList), :push,
              s(:lvar, :item2)), nil))),
      s(:false))))
