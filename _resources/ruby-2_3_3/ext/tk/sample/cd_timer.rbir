s(:begin,
  s(:send, nil, :require,
    s(:str, "tk")),
  s(:if,
    s(:send,
      s(:const, nil, :ARGV), :empty?),
    s(:begin,
      s(:send,
        s(:gvar, :$stderr), :puts,
        s(:str, "Error:: No time arguments for counting down")),
      s(:send, nil, :exit,
        s(:int, 1))), nil),
  s(:lvasgn, :width,
    s(:int, 10)),
  s(:send,
    s(:send,
      s(:const, nil, :TkButton), :new,
      s(:hash,
        s(:pair,
          s(:sym, :text),
          s(:str, "exit")),
        s(:pair,
          s(:sym, :command),
          s(:block,
            s(:send, nil, :proc),
            s(:args),
            s(:send, nil, :exit))))), :pack,
    s(:hash,
      s(:pair,
        s(:sym, :side),
        s(:sym, :bottom)),
      s(:pair,
        s(:sym, :fill),
        s(:sym, :x)))),
  s(:lvasgn, :b,
    s(:send,
      s(:send,
        s(:const, nil, :TkButton), :new,
        s(:hash,
          s(:pair,
            s(:sym, :text),
            s(:str, "start")))), :pack,
      s(:hash,
        s(:pair,
          s(:sym, :side),
          s(:sym, :top)),
        s(:pair,
          s(:sym, :fill),
          s(:sym, :x))))),
  s(:lvasgn, :f,
    s(:send,
      s(:send,
        s(:const, nil, :TkFrame), :new,
        s(:hash,
          s(:pair,
            s(:sym, :relief),
            s(:sym, :ridge)),
          s(:pair,
            s(:sym, :borderwidth),
            s(:int, 2)))), :pack,
      s(:hash,
        s(:pair,
          s(:sym, :fill),
          s(:sym, :x))))),
  s(:send,
    s(:send,
      s(:const, nil, :TkLabel), :new,
      s(:lvar, :f),
      s(:hash,
        s(:pair,
          s(:sym, :relief),
          s(:sym, :flat)),
        s(:pair,
          s(:sym, :pady),
          s(:int, 3)),
        s(:pair,
          s(:sym, :background),
          s(:str, "black")),
        s(:pair,
          s(:sym, :foreground),
          s(:str, "white")),
        s(:pair,
          s(:sym, :text),
          s(:str, "  elapsed: ")))), :pack,
    s(:hash,
      s(:pair,
        s(:sym, :fill),
        s(:sym, :x)),
      s(:pair,
        s(:sym, :side),
        s(:sym, :left)),
      s(:pair,
        s(:sym, :expand),
        s(:true)))),
  s(:lvasgn, :now,
    s(:send,
      s(:send,
        s(:const, nil, :TkLabel), :new,
        s(:lvar, :f),
        s(:hash,
          s(:pair,
            s(:sym, :width),
            s(:lvar, :width)),
          s(:pair,
            s(:sym, :relief),
            s(:sym, :flat)),
          s(:pair,
            s(:sym, :pady),
            s(:int, 3)),
          s(:pair,
            s(:sym, :anchor),
            s(:sym, :w)),
          s(:pair,
            s(:sym, :background),
            s(:str, "black")),
          s(:pair,
            s(:sym, :foreground),
            s(:str, "white")),
          s(:pair,
            s(:sym, :text),
            s(:send,
              s(:str, "%4d:%02d.00"), :%,
              s(:array,
                s(:int, 0),
                s(:int, 0)))))), :pack,
      s(:hash,
        s(:pair,
          s(:sym, :side),
          s(:sym, :right))))),
  s(:lvasgn, :timers,
    s(:array,
      s(:send,
        s(:block,
          s(:send,
            s(:const, nil, :TkRTTimer), :new,
            s(:int, 10)),
          s(:args,
            s(:arg, :tm)),
          s(:begin,
            s(:lvasgn, :t,
              s(:send,
                s(:begin,
                  s(:or,
                    s(:send,
                      s(:lvar, :tm), :return_value),
                    s(:int, 0))), :+,
                s(:int, 1))),
            s(:masgn,
              s(:mlhs,
                s(:lvasgn, :s),
                s(:lvasgn, :u)),
              s(:send,
                s(:lvar, :t), :divmod,
                s(:int, 100))),
            s(:masgn,
              s(:mlhs,
                s(:lvasgn, :m),
                s(:lvasgn, :s)),
              s(:send,
                s(:lvar, :s), :divmod,
                s(:int, 60))),
            s(:send,
              s(:lvar, :now), :text,
              s(:send,
                s(:str, "%4d:%02d.%02d"), :%,
                s(:array,
                  s(:lvar, :m),
                  s(:lvar, :s),
                  s(:lvar, :u)))),
            s(:lvar, :t))), :set_start_proc,
        s(:int, 0),
        s(:block,
          s(:send, nil, :proc),
          s(:args),
          s(:begin,
            s(:send,
              s(:lvar, :now), :text,
              s(:send,
                s(:str, "%4d:%02d.00"), :%,
                s(:array,
                  s(:int, 0),
                  s(:int, 0)))),
            s(:send,
              s(:lvar, :now), :foreground,
              s(:str, "white")),
            s(:int, 0)))))),
  s(:block,
    s(:send,
      s(:send,
        s(:block,
          s(:send,
            s(:const, nil, :ARGV), :collect),
          s(:args,
            s(:arg, :arg)),
          s(:send,
            s(:begin,
              s(:send,
                s(:send, nil, :Float,
                  s(:lvar, :arg)), :*,
                s(:int, 60))), :to_i)), :sort), :each_with_index),
    s(:args,
      s(:arg, :time),
      s(:arg, :idx)),
    s(:begin,
      s(:lvasgn, :f,
        s(:send,
          s(:send,
            s(:const, nil, :TkFrame), :new,
            s(:hash,
              s(:pair,
                s(:sym, :relief),
                s(:sym, :ridge)),
              s(:pair,
                s(:sym, :borderwidth),
                s(:int, 2)))), :pack,
          s(:hash,
            s(:pair,
              s(:sym, :fill),
              s(:sym, :x))))),
      s(:send,
        s(:send,
          s(:const, nil, :TkLabel), :new,
          s(:lvar, :f),
          s(:hash,
            s(:pair,
              s(:sym, :relief),
              s(:sym, :flat)),
            s(:pair,
              s(:sym, :pady),
              s(:int, 3)),
            s(:pair,
              s(:sym, :text),
              s(:send,
                s(:str, "  %4d:%02d  --> "), :%,
                s(:begin,
                  s(:send,
                    s(:lvar, :time), :divmod,
                    s(:int, 60))))))), :pack,
        s(:hash,
          s(:pair,
            s(:sym, :side),
            s(:sym, :left)))),
      s(:lvasgn, :l,
        s(:send,
          s(:send,
            s(:const, nil, :TkLabel), :new,
            s(:lvar, :f),
            s(:hash,
              s(:pair,
                s(:sym, :width),
                s(:lvar, :width)),
              s(:pair,
                s(:sym, :relief),
                s(:sym, :flat)),
              s(:pair,
                s(:sym, :pady),
                s(:int, 3)),
              s(:pair,
                s(:sym, :anchor),
                s(:sym, :w)),
              s(:pair,
                s(:sym, :text),
                s(:send,
                  s(:str, "%4d:%02d"), :%,
                  s(:begin,
                    s(:send,
                      s(:lvar, :time), :divmod,
                      s(:int, 60))))))), :pack,
          s(:hash,
            s(:pair,
              s(:sym, :side),
              s(:sym, :right))))),
      s(:send,
        s(:lvar, :timers), :<<,
        s(:send,
          s(:block,
            s(:send,
              s(:const, nil, :TkRTTimer), :new,
              s(:int, 1000)),
            s(:args,
              s(:arg, :tm)),
            s(:begin,
              s(:lvasgn, :t,
                s(:send,
                  s(:begin,
                    s(:or,
                      s(:send,
                        s(:lvar, :tm), :return_value),
                      s(:lvar, :time))), :-,
                  s(:int, 1))),
              s(:if,
                s(:send,
                  s(:lvar, :t), :<,
                  s(:int, 0)),
                s(:send,
                  s(:lvar, :l), :text,
                  s(:send,
                    s(:str, "%4d:%02d"), :%,
                    s(:begin,
                      s(:send,
                        s(:begin,
                          s(:send,
                            s(:lvar, :t), :-@)), :divmod,
                        s(:int, 60))))),
                s(:send,
                  s(:lvar, :l), :text,
                  s(:send,
                    s(:str, "%4d:%02d"), :%,
                    s(:begin,
                      s(:send,
                        s(:lvar, :t), :divmod,
                        s(:int, 60)))))),
              s(:if,
                s(:send,
                  s(:lvar, :t), :zero?),
                s(:begin,
                  s(:send,
                    s(:lvar, :l), :foreground,
                    s(:str, "red")),
                  s(:block,
                    s(:send,
                      s(:lvar, :idx), :times),
                    s(:args),
                    s(:send,
                      s(:const, nil, :Tk), :bell))), nil),
              s(:lvar, :t))), :set_start_proc,
          s(:int, 0),
          s(:block,
            s(:send, nil, :proc),
            s(:args),
            s(:begin,
              s(:send,
                s(:lvar, :l), :text,
                s(:send,
                  s(:str, "%4d:%02d"), :%,
                  s(:begin,
                    s(:send,
                      s(:lvar, :time), :divmod,
                      s(:int, 60))))),
              s(:send,
                s(:lvar, :l), :foreground,
                s(:str, "black")),
              s(:lvar, :time))))))),
  s(:lvasgn, :mode,
    s(:sym, :start)),
  s(:send,
    s(:lvar, :b), :command,
    s(:block,
      s(:send, nil, :proc),
      s(:args),
      s(:if,
        s(:send,
          s(:lvar, :mode), :==,
          s(:sym, :start)),
        s(:begin,
          s(:block,
            s(:send,
              s(:lvar, :timers), :each),
            s(:args,
              s(:arg, :timer)),
            s(:send,
              s(:lvar, :timer), :restart)),
          s(:send,
            s(:lvar, :b), :text,
            s(:str, "reset")),
          s(:lvasgn, :mode,
            s(:sym, :reset))),
        s(:begin,
          s(:block,
            s(:send,
              s(:lvar, :timers), :each),
            s(:args,
              s(:arg, :timer)),
            s(:send,
              s(:send,
                s(:lvar, :timer), :stop), :reset)),
          s(:send,
            s(:lvar, :b), :text,
            s(:str, "start")),
          s(:lvasgn, :mode,
            s(:sym, :start)))))),
  s(:send,
    s(:const, nil, :Tk), :mainloop))
