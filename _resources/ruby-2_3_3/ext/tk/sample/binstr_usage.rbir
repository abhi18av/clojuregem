s(:begin,
  s(:send, nil, :require,
    s(:str, "tk")),
  s(:send,
    s(:send,
      s(:const, nil, :TkMessage), :new,
      s(:hash,
        s(:pair,
          s(:sym, :width),
          s(:int, 360)),
        s(:pair,
          s(:sym, :text),
          s(:dstr,
            s(:str, "This sample shows how to use a binary sequence between Ruby and Tk. \nThis reads the image data from the file as the binary sequence.\n"),
            s(:str, "\n"),
            s(:str, "To treat the difference of encodings between on Ruby and on Tk seamlessly, \nRuby/Tk converts the encoding of string arguments automatically. \nI think it is comfortable for users on almost all situations. \nHowever, when treats a binary sequence, the convert process makes troubles.\n"),
            s(:str, "\n"),
            s(:str, "Tk::BinaryString class (subclass of Tk::EncodedString class) is the class \nto avoid such troubles. Please see the source code of this sample. \nA Tk::BinaryString instance is used to create the image for the center button.\n"))))), :pack),
  s(:casgn, nil, :ImgFile,
    s(:send,
      s(:array,
        s(:send,
          s(:const, nil, :File), :dirname,
          s(:str, "(string)")),
        s(:str, "images"),
        s(:str, "tcllogo.gif")), :join,
      s(:const,
        s(:const, nil, :File), :Separator))),
  s(:lvasgn, :ph1,
    s(:send,
      s(:const, nil, :TkPhotoImage), :new,
      s(:hash,
        s(:pair,
          s(:sym, :file),
          s(:const, nil, :ImgFile))))),
  s(:send, nil, :p,
    s(:send,
      s(:lvar, :ph1), :configinfo)),
  s(:lvasgn, :b_str,
    s(:send,
      s(:const, nil, :Tk), :BinaryString,
      s(:send,
        s(:const, nil, :IO), :read,
        s(:const, nil, :ImgFile)))),
  s(:send, nil, :p,
    s(:array,
      s(:lvar, :b_str),
      s(:send,
        s(:lvar, :b_str), :encoding))),
  s(:lvasgn, :ph2,
    s(:send,
      s(:const, nil, :TkPhotoImage), :new,
      s(:hash,
        s(:pair,
          s(:sym, :data),
          s(:lvar, :b_str))))),
  s(:send, nil, :p,
    s(:send,
      s(:lvar, :ph2), :configinfo)),
  s(:send, nil, :p,
    s(:send,
      s(:lvar, :ph2), :data,
      s(:hash,
        s(:pair,
          s(:sym, :grayscale),
          s(:true))))),
  s(:lvasgn, :ph3,
    s(:send,
      s(:const, nil, :TkPhotoImage), :new,
      s(:hash,
        s(:pair,
          s(:sym, :palette),
          s(:int, 256))))),
  s(:send,
    s(:lvar, :ph3), :put,
    s(:send,
      s(:lvar, :ph2), :data)),
  s(:lvasgn, :ph4,
    s(:send,
      s(:const, nil, :TkPhotoImage), :new)),
  s(:send,
    s(:lvar, :ph4), :put,
    s(:send,
      s(:lvar, :ph2), :data,
      s(:hash,
        s(:pair,
          s(:sym, :grayscale),
          s(:true))))),
  s(:lvasgn, :f,
    s(:send,
      s(:send,
        s(:const, nil, :TkFrame), :new), :pack)),
  s(:send,
    s(:send,
      s(:const, nil, :TkButton), :new,
      s(:hash,
        s(:pair,
          s(:sym, :parent),
          s(:lvar, :f)),
        s(:pair,
          s(:sym, :image),
          s(:lvar, :ph1)),
        s(:pair,
          s(:sym, :command),
          s(:block,
            s(:send, nil, :proc),
            s(:args),
            s(:send, nil, :exit))))), :pack,
    s(:hash,
      s(:pair,
        s(:sym, :side),
        s(:sym, :left)))),
  s(:send,
    s(:send,
      s(:const, nil, :TkButton), :new,
      s(:hash,
        s(:pair,
          s(:sym, :parent),
          s(:lvar, :f)),
        s(:pair,
          s(:sym, :image),
          s(:lvar, :ph2)),
        s(:pair,
          s(:sym, :command),
          s(:block,
            s(:send, nil, :proc),
            s(:args),
            s(:send, nil, :exit))))), :pack,
    s(:hash,
      s(:pair,
        s(:sym, :side),
        s(:sym, :left)))),
  s(:send,
    s(:send,
      s(:const, nil, :TkButton), :new,
      s(:hash,
        s(:pair,
          s(:sym, :parent),
          s(:lvar, :f)),
        s(:pair,
          s(:sym, :image),
          s(:lvar, :ph3)),
        s(:pair,
          s(:sym, :command),
          s(:block,
            s(:send, nil, :proc),
            s(:args),
            s(:send, nil, :exit))))), :pack,
    s(:hash,
      s(:pair,
        s(:sym, :side),
        s(:sym, :left)))),
  s(:send,
    s(:send,
      s(:const, nil, :TkButton), :new,
      s(:hash,
        s(:pair,
          s(:sym, :parent),
          s(:lvar, :f)),
        s(:pair,
          s(:sym, :image),
          s(:lvar, :ph4)),
        s(:pair,
          s(:sym, :command),
          s(:block,
            s(:send, nil, :proc),
            s(:args),
            s(:send, nil, :exit))))), :pack,
    s(:hash,
      s(:pair,
        s(:sym, :side),
        s(:sym, :left)))),
  s(:send,
    s(:const, nil, :Tk), :mainloop))
