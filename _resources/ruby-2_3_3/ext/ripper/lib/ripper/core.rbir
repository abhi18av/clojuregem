s(:begin,
  s(:send, nil, :require,
    s(:str, "ripper.so")),
  s(:class,
    s(:const, nil, :Ripper), nil,
    s(:begin,
      s(:defs,
        s(:const, nil, :Ripper), :parse,
        s(:args,
          s(:arg, :src),
          s(:optarg, :filename,
            s(:str, "(ripper)")),
          s(:optarg, :lineno,
            s(:int, 1))),
        s(:send,
          s(:send, nil, :new,
            s(:lvar, :src),
            s(:lvar, :filename),
            s(:lvar, :lineno)), :parse)),
      s(:casgn, nil, :PARSER_EVENTS,
        s(:send,
          s(:const, nil, :PARSER_EVENT_TABLE), :keys)),
      s(:casgn, nil, :SCANNER_EVENTS,
        s(:send,
          s(:const, nil, :SCANNER_EVENT_TABLE), :keys)),
      s(:casgn, nil, :EVENTS,
        s(:send,
          s(:const, nil, :PARSER_EVENTS), :+,
          s(:const, nil, :SCANNER_EVENTS))),
      s(:send, nil, :private),
      s(:def, :_dispatch_0,
        s(:args),
        s(:nil)),
      s(:def, :_dispatch_1,
        s(:args,
          s(:arg, :a)),
        s(:lvar, :a)),
      s(:def, :_dispatch_2,
        s(:args,
          s(:arg, :a),
          s(:arg, :b)),
        s(:lvar, :a)),
      s(:def, :_dispatch_3,
        s(:args,
          s(:arg, :a),
          s(:arg, :b),
          s(:arg, :c)),
        s(:lvar, :a)),
      s(:def, :_dispatch_4,
        s(:args,
          s(:arg, :a),
          s(:arg, :b),
          s(:arg, :c),
          s(:arg, :d)),
        s(:lvar, :a)),
      s(:def, :_dispatch_5,
        s(:args,
          s(:arg, :a),
          s(:arg, :b),
          s(:arg, :c),
          s(:arg, :d),
          s(:arg, :e)),
        s(:lvar, :a)),
      s(:def, :_dispatch_6,
        s(:args,
          s(:arg, :a),
          s(:arg, :b),
          s(:arg, :c),
          s(:arg, :d),
          s(:arg, :e),
          s(:arg, :f)),
        s(:lvar, :a)),
      s(:def, :_dispatch_7,
        s(:args,
          s(:arg, :a),
          s(:arg, :b),
          s(:arg, :c),
          s(:arg, :d),
          s(:arg, :e),
          s(:arg, :f),
          s(:arg, :g)),
        s(:lvar, :a)),
      s(:block,
        s(:send,
          s(:const, nil, :PARSER_EVENT_TABLE), :each),
        s(:args,
          s(:arg, :id),
          s(:arg, :arity)),
        s(:send, nil, :alias_method,
          s(:dstr,
            s(:str, "on_"),
            s(:begin,
              s(:lvar, :id))),
          s(:dstr,
            s(:str, "_dispatch_"),
            s(:begin,
              s(:lvar, :arity))))),
      s(:def, :warn,
        s(:args,
          s(:arg, :fmt),
          s(:restarg, :args)), nil),
      s(:def, :warning,
        s(:args,
          s(:arg, :fmt),
          s(:restarg, :args)), nil),
      s(:def, :compile_error,
        s(:args,
          s(:arg, :msg)), nil),
      s(:block,
        s(:send,
          s(:const, nil, :SCANNER_EVENTS), :each),
        s(:args,
          s(:arg, :id)),
        s(:send, nil, :alias_method,
          s(:dstr,
            s(:str, "on_"),
            s(:begin,
              s(:lvar, :id))),
          s(:sym, :_dispatch_1))))))
