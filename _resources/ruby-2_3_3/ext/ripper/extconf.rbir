s(:begin,
  s(:send, nil, :require,
    s(:str, "mkmf")),
  s(:send, nil, :require,
    s(:str, "rbconfig")),
  s(:def, :main,
    s(:args),
    s(:begin,
      s(:if,
        s(:send, nil, :find_executable,
          s(:str, "bison")), nil,
        s(:if,
          s(:or,
            s(:send,
              s(:const, nil, :File), :exist?,
              s(:str, "ripper.c")),
            s(:send,
              s(:const, nil, :File), :exist?,
              s(:dstr,
                s(:begin,
                  s(:gvar, :$srcdir)),
                s(:str, "/ripper.c")))), nil,
          s(:send, nil, :raise,
            s(:str, "missing bison; abort")))),
      s(:gvasgn, :$objs,
        s(:array,
          s(:str, "ripper.o"))),
      s(:send,
        s(:gvar, :$cleanfiles), :concat,
        s(:array,
          s(:str, "ripper.y"),
          s(:str, "ripper.c"),
          s(:str, "ripper.E"),
          s(:str, "ripper.output"),
          s(:str, "y.output"),
          s(:str, "eventids1.c"),
          s(:str, "eventids2table.c"))),
      s(:send,
        s(:gvar, :$defs), :<<,
        s(:str, "-DRIPPER")),
      s(:if,
        s(:gvar, :$debug),
        s(:send,
          s(:gvar, :$defs), :<<,
          s(:str, "-DRIPPER_DEBUG")), nil),
      s(:send,
        s(:send,
          s(:gvar, :$VPATH), :<<,
          s(:str, "$(topdir)")), :<<,
        s(:str, "$(top_srcdir)")),
      s(:send,
        s(:gvar, :$INCFLAGS), :<<,
        s(:str, " -I$(topdir) -I$(top_srcdir)")),
      s(:send, nil, :create_makefile,
        s(:str, "ripper")))),
  s(:send, nil, :main))
