s(:begin,
  s(:if,
    s(:and,
      s(:defined?,
        s(:const,
          s(:const,
            s(:cbase), :JSON), :JSON_LOADED)),
      s(:const,
        s(:const,
          s(:cbase), :JSON), :JSON_LOADED)), nil,
    s(:send, nil, :require,
      s(:str, "json"))),
  s(:or,
    s(:defined?,
      s(:const,
        s(:cbase), :Rational)),
    s(:send, nil, :require,
      s(:str, "rational"))),
  s(:class,
    s(:const, nil, :Rational), nil,
    s(:begin,
      s(:defs,
        s(:self), :json_create,
        s(:args,
          s(:arg, :object)),
        s(:send, nil, :Rational,
          s(:send,
            s(:lvar, :object), :[],
            s(:str, "n")),
          s(:send,
            s(:lvar, :object), :[],
            s(:str, "d")))),
      s(:def, :as_json,
        s(:args,
          s(:restarg)),
        s(:hash,
          s(:pair,
            s(:send,
              s(:const, nil, :JSON), :create_id),
            s(:send,
              s(:send,
                s(:self), :class), :name)),
          s(:pair,
            s(:str, "n"),
            s(:send, nil, :numerator)),
          s(:pair,
            s(:str, "d"),
            s(:send, nil, :denominator)))),
      s(:def, :to_json,
        s(:args,
          s(:restarg)),
        s(:send,
          s(:send, nil, :as_json), :to_json)))))
