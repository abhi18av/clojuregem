s(:begin,
  s(:send, nil, :require,
    s(:str, "win32ole")),
  s(:lvasgn, :application,
    s(:send,
      s(:const, nil, :WIN32OLE), :new,
      s(:str, "Excel.Application"))),
  s(:send,
    s(:lvar, :application), :visible=,
    s(:const, nil, :TRUE)),
  s(:lvasgn, :workbook,
    s(:send,
      s(:send,
        s(:lvar, :application), :Workbooks), :Add)),
  s(:lvasgn, :sheet,
    s(:send,
      s(:lvar, :workbook), :Worksheets,
      s(:int, 1))),
  s(:lvasgn, :sheetS,
    s(:send,
      s(:lvar, :workbook), :Worksheets)),
  s(:send, nil, :puts,
    s(:dstr,
      s(:str, "The number of sheets is "),
      s(:begin,
        s(:send,
          s(:lvar, :sheetS), :count)))),
  s(:send, nil, :puts,
    s(:dstr,
      s(:str, "Now add 2 sheets after of `"),
      s(:begin,
        s(:send,
          s(:lvar, :sheet), :name)),
      s(:str, "`"))),
  s(:send,
    s(:lvar, :sheetS), :add,
    s(:hash,
      s(:pair,
        s(:str, "count"),
        s(:int, 2)),
      s(:pair,
        s(:str, "after"),
        s(:lvar, :sheet)))),
  s(:send, nil, :puts,
    s(:dstr,
      s(:str, "The number of sheets is "),
      s(:begin,
        s(:send,
          s(:lvar, :sheetS), :count)))),
  s(:send, nil, :print,
    s(:str, "Now quit Excel... Please enter.")),
  s(:send, nil, :gets),
  s(:send,
    s(:send,
      s(:lvar, :application), :ActiveWorkbook), :Close,
    s(:int, 0)),
  s(:send,
    s(:lvar, :application), :Quit))
