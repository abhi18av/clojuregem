s(:begin,
  s(:send, nil, :require,
    s(:str, "win32ole")),
  s(:def, :listup,
    s(:args,
      s(:arg, :items)),
    s(:for,
      s(:lvasgn, :i),
      s(:lvar, :items),
      s(:send, nil, :puts,
        s(:send,
          s(:lvar, :i), :name)))),
  s(:lvasgn, :fs,
    s(:send,
      s(:const, nil, :WIN32OLE), :new,
      s(:str, "Scripting.FileSystemObject"))),
  s(:lvasgn, :folder,
    s(:send,
      s(:lvar, :fs), :GetFolder,
      s(:str, "."))),
  s(:send, nil, :puts,
    s(:dstr,
      s(:str, "--- folder of "),
      s(:begin,
        s(:send,
          s(:lvar, :folder), :path)),
      s(:str, " ---"))),
  s(:send, nil, :listup,
    s(:send,
      s(:lvar, :folder), :SubFolders)),
  s(:send, nil, :puts,
    s(:dstr,
      s(:str, "--- files of "),
      s(:begin,
        s(:send,
          s(:lvar, :folder), :path)),
      s(:str, " ---"))),
  s(:send, nil, :listup,
    s(:send,
      s(:lvar, :folder), :Files)))
