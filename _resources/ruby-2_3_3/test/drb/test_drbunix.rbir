s(:begin,
  s(:send, nil, :require_relative,
    s(:str, "drbtest")),
  s(:kwbegin,
    s(:rescue,
      s(:send, nil, :require,
        s(:str, "drb/unix")),
      s(:resbody,
        s(:array,
          s(:const, nil, :LoadError)), nil, nil), nil)),
  s(:module,
    s(:const, nil, :DRbTests),
    s(:if,
      s(:send,
        s(:const, nil, :Object), :const_defined?,
        s(:str, "UNIXServer")),
      s(:begin,
        s(:class,
          s(:const, nil, :DRbUNIXService),
          s(:const, nil, :DRbService),
          s(:begin,
            s(:block,
              s(:send,
                s(:array,
                  s(:str, "ut_drb_drbunix.rb"),
                  s(:str, "ut_array_drbunix.rb")), :each),
              s(:args,
                s(:arg, :nm)),
              s(:send, nil, :add_service_command,
                s(:lvar, :nm))),
            s(:if,
              s(:send,
                s(:gvar, :$0), :==,
                s(:str, "(string)")),
              s(:lvasgn, :uri,
                s(:send,
                  s(:const, nil, :ARGV), :shift)), nil),
            s(:ivasgn, :@server,
              s(:send,
                s(:const,
                  s(:const, nil, :DRb), :DRbServer), :new,
                s(:or,
                  s(:lvar, :uri),
                  s(:str, "drbunix:")),
                s(:send,
                  s(:self), :manager),
                s(:hash))))),
        s(:class,
          s(:const, nil, :TestDRbUNIXCore),
          s(:const,
            s(:const,
              s(:const, nil, :Test), :Unit), :TestCase),
          s(:begin,
            s(:send, nil, :include,
              s(:const, nil, :DRbCore)),
            s(:def, :setup,
              s(:args),
              s(:begin,
                s(:send, nil, :setup_service,
                  s(:str, "ut_drb_drbunix.rb")),
                s(:zsuper))),
            s(:def, :teardown,
              s(:args),
              s(:begin,
                s(:zsuper),
                s(:send,
                  s(:const, nil, :DRbService), :finish))),
            s(:def, :test_02_unknown,
              s(:args), nil),
            s(:def, :test_01_02_loop,
              s(:args), nil),
            s(:def, :test_05_eq,
              s(:args), nil))),
        s(:class,
          s(:const, nil, :TestDRbUNIXAry),
          s(:const,
            s(:const,
              s(:const, nil, :Test), :Unit), :TestCase),
          s(:begin,
            s(:send, nil, :include,
              s(:const, nil, :DRbAry)),
            s(:def, :setup,
              s(:args),
              s(:begin,
                s(:send, nil, :setup_service,
                  s(:str, "ut_array_drbunix.rb")),
                s(:zsuper))),
            s(:def, :teardown,
              s(:args),
              s(:begin,
                s(:zsuper),
                s(:send,
                  s(:const, nil, :DRbService), :finish)))))), nil)))
