s(:class,
  s(:const, nil, :TestLastThread),
  s(:const,
    s(:const,
      s(:const, nil, :Test), :Unit), :TestCase),
  s(:def, :test_last_thread,
    s(:args),
    s(:send, nil, :assert_separately,
      s(:array),
      s(:dstr,
        s(:str, "      require '-test-/gvl/call_without_gvl'\n"),
        s(:str, "\n"),
        s(:str, "      Thread.new {\n"),
        s(:str, "        sleep 0.2\n"),
        s(:str, "      }\n"),
        s(:str, "\n"),
        s(:str, "      t0 = Time.now\n"),
        s(:str, "      Thread.current.__runnable_sleep__ 1\n"),
        s(:str, "      t1 = Time.now\n"),
        s(:str, "      t = t1 - t0\n"),
        s(:str, "\n"),
        s(:str, "      assert_in_delta(1.0, t, 0.16)\n")))))
