s(:begin,
  s(:send, nil, :require,
    s(:str, "rubygems/test_case")),
  s(:class,
    s(:const, nil, :TestGemResolverConflict),
    s(:const,
      s(:const, nil, :Gem), :TestCase),
    s(:begin,
      s(:def, :test_self_compatibility,
        s(:args),
        s(:send, nil, :assert_same,
          s(:const,
            s(:const,
              s(:const, nil, :Gem), :Resolver), :Conflict),
          s(:const,
            s(:const,
              s(:const, nil, :Gem), :Resolver), :DependencyConflict))),
      s(:def, :test_explanation,
        s(:args),
        s(:begin,
          s(:lvasgn, :root,
            s(:send, nil, :dependency_request,
              s(:send, nil, :dep,
                s(:str, "net-ssh"),
                s(:str, ">= 2.0.13")),
              s(:str, "rye"),
              s(:str, "0.9.8"))),
          s(:lvasgn, :child,
            s(:send, nil, :dependency_request,
              s(:send, nil, :dep,
                s(:str, "net-ssh"),
                s(:str, ">= 2.6.5")),
              s(:str, "net-ssh"),
              s(:str, "2.2.2"),
              s(:lvar, :root))),
          s(:lvasgn, :dep,
            s(:send,
              s(:const,
                s(:const,
                  s(:const, nil, :Gem), :Resolver), :DependencyRequest), :new,
              s(:send, nil, :dep,
                s(:str, "net-ssh"),
                s(:str, ">= 2.0.13")),
              s(:nil))),
          s(:lvasgn, :spec,
            s(:send, nil, :quick_spec,
              s(:str, "net-ssh"),
              s(:str, "2.2.2"))),
          s(:lvasgn, :active,
            s(:send,
              s(:const,
                s(:const,
                  s(:const, nil, :Gem), :Resolver), :ActivationRequest), :new,
              s(:lvar, :spec),
              s(:lvar, :dep))),
          s(:lvasgn, :conflict,
            s(:send,
              s(:const,
                s(:const,
                  s(:const, nil, :Gem), :Resolver), :Conflict), :new,
              s(:lvar, :child),
              s(:lvar, :active))),
          s(:lvasgn, :expected,
            s(:dstr,
              s(:str, "  Activated net-ssh-2.2.2\n"),
              s(:str, "  which does not match conflicting dependency (>= 2.6.5)\n"),
              s(:str, "\n"),
              s(:str, "  Conflicting dependency chains:\n"),
              s(:str, "    net-ssh (>= 2.0.13), 2.2.2 activated\n"),
              s(:str, "\n"),
              s(:str, "  versus:\n"),
              s(:str, "    rye (= 0.9.8), 0.9.8 activated, depends on\n"),
              s(:str, "    net-ssh (>= 2.0.13), 2.2.2 activated, depends on\n"),
              s(:str, "    net-ssh (>= 2.6.5)\n"),
              s(:str, "\n"))),
          s(:send, nil, :assert_equal,
            s(:lvar, :expected),
            s(:send,
              s(:lvar, :conflict), :explanation)))),
      s(:def, :test_explanation_user_request,
        s(:args),
        s(:begin,
          s(:ivasgn, :@DR,
            s(:const,
              s(:const, nil, :Gem), :Resolver)),
          s(:lvasgn, :spec,
            s(:send, nil, :util_spec,
              s(:str, "a"),
              s(:int, 2))),
          s(:lvasgn, :a1_req,
            s(:send,
              s(:const,
                s(:ivar, :@DR), :DependencyRequest), :new,
              s(:send, nil, :dep,
                s(:str, "a"),
                s(:str, "= 1")),
              s(:nil))),
          s(:lvasgn, :a2_req,
            s(:send,
              s(:const,
                s(:ivar, :@DR), :DependencyRequest), :new,
              s(:send, nil, :dep,
                s(:str, "a"),
                s(:str, "= 2")),
              s(:nil))),
          s(:lvasgn, :activated,
            s(:send,
              s(:const,
                s(:ivar, :@DR), :ActivationRequest), :new,
              s(:lvar, :spec),
              s(:lvar, :a2_req))),
          s(:lvasgn, :conflict,
            s(:send,
              s(:const,
                s(:ivar, :@DR), :Conflict), :new,
              s(:lvar, :a1_req),
              s(:lvar, :activated))),
          s(:lvasgn, :expected,
            s(:dstr,
              s(:str, "  Activated a-2\n"),
              s(:str, "  which does not match conflicting dependency (= 1)\n"),
              s(:str, "\n"),
              s(:str, "  Conflicting dependency chains:\n"),
              s(:str, "    a (= 2), 2 activated\n"),
              s(:str, "\n"),
              s(:str, "  versus:\n"),
              s(:str, "    a (= 1)\n"),
              s(:str, "\n"))),
          s(:send, nil, :assert_equal,
            s(:lvar, :expected),
            s(:send,
              s(:lvar, :conflict), :explanation)))),
      s(:def, :test_request_path,
        s(:args),
        s(:begin,
          s(:lvasgn, :root,
            s(:send, nil, :dependency_request,
              s(:send, nil, :dep,
                s(:str, "net-ssh"),
                s(:str, ">= 2.0.13")),
              s(:str, "rye"),
              s(:str, "0.9.8"))),
          s(:lvasgn, :child,
            s(:send, nil, :dependency_request,
              s(:send, nil, :dep,
                s(:str, "other"),
                s(:str, ">= 1.0")),
              s(:str, "net-ssh"),
              s(:str, "2.2.2"),
              s(:lvar, :root))),
          s(:lvasgn, :conflict,
            s(:send,
              s(:const,
                s(:const,
                  s(:const, nil, :Gem), :Resolver), :Conflict), :new,
              s(:nil),
              s(:nil))),
          s(:lvasgn, :expected,
            s(:array,
              s(:str, "net-ssh (>= 2.0.13), 2.2.2 activated"),
              s(:str, "rye (= 0.9.8), 0.9.8 activated"))),
          s(:send, nil, :assert_equal,
            s(:lvar, :expected),
            s(:send,
              s(:lvar, :conflict), :request_path,
              s(:send,
                s(:lvar, :child), :requester))))))))
