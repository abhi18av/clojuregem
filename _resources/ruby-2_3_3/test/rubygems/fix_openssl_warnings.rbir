s(:if,
  s(:send,
    s(:const, nil, :RUBY_VERSION), :<,
    s(:str, "1.9")),
  s(:if,
    s(:defined?,
      s(:const, nil, :OpenSSL)),
    s(:class,
      s(:const,
        s(:const,
          s(:const, nil, :OpenSSL), :X509), :ExtensionFactory), nil,
      s(:begin,
        s(:alias,
          s(:sym, :old_create_ext),
          s(:sym, :create_ext)),
        s(:def, :create_ext,
          s(:args,
            s(:restarg, :args)),
          s(:begin,
            s(:or_asgn,
              s(:ivasgn, :@config),
              s(:nil)),
            s(:send, nil, :old_create_ext,
              s(:splat,
                s(:lvar, :args))))))), nil), nil)
