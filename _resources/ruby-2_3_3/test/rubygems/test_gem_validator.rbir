s(:begin,
  s(:send, nil, :require,
    s(:str, "rubygems/test_case")),
  s(:send, nil, :require,
    s(:str, "rubygems/simple_gem")),
  s(:send, nil, :require,
    s(:str, "rubygems/validator")),
  s(:class,
    s(:const, nil, :TestGemValidator),
    s(:const,
      s(:const, nil, :Gem), :TestCase),
    s(:begin,
      s(:def, :setup,
        s(:args),
        s(:begin,
          s(:zsuper),
          s(:ivasgn, :@simple_gem,
            s(:const, nil, :SIMPLE_GEM)),
          s(:ivasgn, :@validator,
            s(:send,
              s(:const,
                s(:const, nil, :Gem), :Validator), :new)))),
      s(:def, :test_alien,
        s(:args),
        s(:begin,
          s(:ivasgn, :@spec,
            s(:block,
              s(:send, nil, :quick_gem,
                s(:str, "a")),
              s(:args,
                s(:arg, :s)),
              s(:send,
                s(:lvar, :s), :files=,
                s(:array,
                  s(:str, "lib/a.rb"),
                  s(:str, "lib/b.rb"))))),
          s(:send, nil, :util_build_gem,
            s(:ivar, :@spec)),
          s(:send,
            s(:const, nil, :FileUtils), :rm,
            s(:send,
              s(:const, nil, :File), :join,
              s(:send,
                s(:ivar, :@spec), :gem_dir),
              s(:str, "lib/b.rb"))),
          s(:send,
            s(:const, nil, :FileUtils), :touch,
            s(:send,
              s(:const, nil, :File), :join,
              s(:send,
                s(:ivar, :@spec), :gem_dir),
              s(:str, "lib/c.rb"))),
          s(:lvasgn, :alien,
            s(:send,
              s(:ivar, :@validator), :alien,
              s(:str, "a"))),
          s(:lvasgn, :expected,
            s(:hash,
              s(:pair,
                s(:send,
                  s(:ivar, :@spec), :file_name),
                s(:array,
                  s(:send,
                    s(:const,
                      s(:const,
                        s(:const, nil, :Gem), :Validator), :ErrorData), :new,
                    s(:str, "lib/b.rb"),
                    s(:str, "Missing file")),
                  s(:send,
                    s(:const,
                      s(:const,
                        s(:const, nil, :Gem), :Validator), :ErrorData), :new,
                    s(:str, "lib/c.rb"),
                    s(:str, "Extra file")))))),
          s(:send, nil, :assert_equal,
            s(:lvar, :expected),
            s(:lvar, :alien)))),
      s(:def, :test_alien_default,
        s(:args),
        s(:begin,
          s(:send, nil, :new_default_spec,
            s(:str, "c"),
            s(:int, 1),
            s(:nil),
            s(:str, "lib/c.rb")),
          s(:lvasgn, :alien,
            s(:send,
              s(:ivar, :@validator), :alien,
              s(:str, "c"))),
          s(:send, nil, :assert_empty,
            s(:lvar, :alien)))))))
