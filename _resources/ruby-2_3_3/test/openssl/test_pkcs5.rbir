s(:begin,
  s(:send, nil, :require_relative,
    s(:str, "utils")),
  s(:if,
    s(:defined?,
      s(:const,
        s(:const, nil, :OpenSSL), :TestUtils)),
    s(:class,
      s(:const,
        s(:const, nil, :OpenSSL), :TestPKCS5),
      s(:const,
        s(:const,
          s(:const, nil, :Test), :Unit), :TestCase),
      s(:begin,
        s(:def, :test_pbkdf2_hmac_sha1_rfc6070_c_1_len_20,
          s(:args),
          s(:begin,
            s(:lvasgn, :p,
              s(:str, "password")),
            s(:lvasgn, :s,
              s(:str, "salt")),
            s(:lvasgn, :c,
              s(:int, 1)),
            s(:lvasgn, :dk_len,
              s(:int, 20)),
            s(:lvasgn, :raw,
              s(:array,
                s(:str, "0c"),
                s(:str, "60"),
                s(:str, "c8"),
                s(:str, "0f"),
                s(:str, "96"),
                s(:str, "1f"),
                s(:str, "0e"),
                s(:str, "71"),
                s(:str, "f3"),
                s(:str, "a9"),
                s(:str, "b5"),
                s(:str, "24"),
                s(:str, "af"),
                s(:str, "60"),
                s(:str, "12"),
                s(:str, "06"),
                s(:str, "2f"),
                s(:str, "e0"),
                s(:str, "37"),
                s(:str, "a6"))),
            s(:lvasgn, :expected,
              s(:send,
                s(:array,
                  s(:send,
                    s(:lvar, :raw), :join,
                    s(:str, ""))), :pack,
                s(:str, "H*"))),
            s(:lvasgn, :value,
              s(:send,
                s(:const,
                  s(:const, nil, :OpenSSL), :PKCS5), :pbkdf2_hmac_sha1,
                s(:lvar, :p),
                s(:lvar, :s),
                s(:lvar, :c),
                s(:lvar, :dk_len))),
            s(:send, nil, :assert_equal,
              s(:lvar, :expected),
              s(:lvar, :value)))),
        s(:def, :test_pbkdf2_hmac_sha1_rfc6070_c_2_len_20,
          s(:args),
          s(:begin,
            s(:lvasgn, :p,
              s(:str, "password")),
            s(:lvasgn, :s,
              s(:str, "salt")),
            s(:lvasgn, :c,
              s(:int, 2)),
            s(:lvasgn, :dk_len,
              s(:int, 20)),
            s(:lvasgn, :raw,
              s(:array,
                s(:str, "ea"),
                s(:str, "6c"),
                s(:str, "01"),
                s(:str, "4d"),
                s(:str, "c7"),
                s(:str, "2d"),
                s(:str, "6f"),
                s(:str, "8c"),
                s(:str, "cd"),
                s(:str, "1e"),
                s(:str, "d9"),
                s(:str, "2a"),
                s(:str, "ce"),
                s(:str, "1d"),
                s(:str, "41"),
                s(:str, "f0"),
                s(:str, "d8"),
                s(:str, "de"),
                s(:str, "89"),
                s(:str, "57"))),
            s(:lvasgn, :expected,
              s(:send,
                s(:array,
                  s(:send,
                    s(:lvar, :raw), :join,
                    s(:str, ""))), :pack,
                s(:str, "H*"))),
            s(:lvasgn, :value,
              s(:send,
                s(:const,
                  s(:const, nil, :OpenSSL), :PKCS5), :pbkdf2_hmac_sha1,
                s(:lvar, :p),
                s(:lvar, :s),
                s(:lvar, :c),
                s(:lvar, :dk_len))),
            s(:send, nil, :assert_equal,
              s(:lvar, :expected),
              s(:lvar, :value)))),
        s(:def, :test_pbkdf2_hmac_sha1_rfc6070_c_4096_len_20,
          s(:args),
          s(:begin,
            s(:lvasgn, :p,
              s(:str, "password")),
            s(:lvasgn, :s,
              s(:str, "salt")),
            s(:lvasgn, :c,
              s(:int, 4096)),
            s(:lvasgn, :dk_len,
              s(:int, 20)),
            s(:lvasgn, :raw,
              s(:array,
                s(:str, "4b"),
                s(:str, "00"),
                s(:str, "79"),
                s(:str, "01"),
                s(:str, "b7"),
                s(:str, "65"),
                s(:str, "48"),
                s(:str, "9a"),
                s(:str, "be"),
                s(:str, "ad"),
                s(:str, "49"),
                s(:str, "d9"),
                s(:str, "26"),
                s(:str, "f7"),
                s(:str, "21"),
                s(:str, "d0"),
                s(:str, "65"),
                s(:str, "a4"),
                s(:str, "29"),
                s(:str, "c1"))),
            s(:lvasgn, :expected,
              s(:send,
                s(:array,
                  s(:send,
                    s(:lvar, :raw), :join,
                    s(:str, ""))), :pack,
                s(:str, "H*"))),
            s(:lvasgn, :value,
              s(:send,
                s(:const,
                  s(:const, nil, :OpenSSL), :PKCS5), :pbkdf2_hmac_sha1,
                s(:lvar, :p),
                s(:lvar, :s),
                s(:lvar, :c),
                s(:lvar, :dk_len))),
            s(:send, nil, :assert_equal,
              s(:lvar, :expected),
              s(:lvar, :value)))),
        s(:def, :test_pbkdf2_hmac_sha1_rfc6070_c_4096_len_25,
          s(:args),
          s(:begin,
            s(:lvasgn, :p,
              s(:str, "passwordPASSWORDpassword")),
            s(:lvasgn, :s,
              s(:str, "saltSALTsaltSALTsaltSALTsaltSALTsalt")),
            s(:lvasgn, :c,
              s(:int, 4096)),
            s(:lvasgn, :dk_len,
              s(:int, 25)),
            s(:lvasgn, :raw,
              s(:array,
                s(:str, "3d"),
                s(:str, "2e"),
                s(:str, "ec"),
                s(:str, "4f"),
                s(:str, "e4"),
                s(:str, "1c"),
                s(:str, "84"),
                s(:str, "9b"),
                s(:str, "80"),
                s(:str, "c8"),
                s(:str, "d8"),
                s(:str, "36"),
                s(:str, "62"),
                s(:str, "c0"),
                s(:str, "e4"),
                s(:str, "4a"),
                s(:str, "8b"),
                s(:str, "29"),
                s(:str, "1a"),
                s(:str, "96"),
                s(:str, "4c"),
                s(:str, "f2"),
                s(:str, "f0"),
                s(:str, "70"),
                s(:str, "38"))),
            s(:lvasgn, :expected,
              s(:send,
                s(:array,
                  s(:send,
                    s(:lvar, :raw), :join,
                    s(:str, ""))), :pack,
                s(:str, "H*"))),
            s(:lvasgn, :value,
              s(:send,
                s(:const,
                  s(:const, nil, :OpenSSL), :PKCS5), :pbkdf2_hmac_sha1,
                s(:lvar, :p),
                s(:lvar, :s),
                s(:lvar, :c),
                s(:lvar, :dk_len))),
            s(:send, nil, :assert_equal,
              s(:lvar, :expected),
              s(:lvar, :value)))),
        s(:def, :test_pbkdf2_hmac_sha1_rfc6070_c_4096_len_16,
          s(:args),
          s(:begin,
            s(:lvasgn, :p,
              s(:str, "pass\u0000word")),
            s(:lvasgn, :s,
              s(:str, "sa\u0000lt")),
            s(:lvasgn, :c,
              s(:int, 4096)),
            s(:lvasgn, :dk_len,
              s(:int, 16)),
            s(:lvasgn, :raw,
              s(:array,
                s(:str, "56"),
                s(:str, "fa"),
                s(:str, "6a"),
                s(:str, "a7"),
                s(:str, "55"),
                s(:str, "48"),
                s(:str, "09"),
                s(:str, "9d"),
                s(:str, "cc"),
                s(:str, "37"),
                s(:str, "d7"),
                s(:str, "f0"),
                s(:str, "34"),
                s(:str, "25"),
                s(:str, "e0"),
                s(:str, "c3"))),
            s(:lvasgn, :expected,
              s(:send,
                s(:array,
                  s(:send,
                    s(:lvar, :raw), :join,
                    s(:str, ""))), :pack,
                s(:str, "H*"))),
            s(:lvasgn, :value,
              s(:send,
                s(:const,
                  s(:const, nil, :OpenSSL), :PKCS5), :pbkdf2_hmac_sha1,
                s(:lvar, :p),
                s(:lvar, :s),
                s(:lvar, :c),
                s(:lvar, :dk_len))),
            s(:send, nil, :assert_equal,
              s(:lvar, :expected),
              s(:lvar, :value)))),
        s(:if,
          s(:send,
            s(:const,
              s(:const, nil, :OpenSSL), :PKCS5), :respond_to?,
            s(:sym, :pbkdf2_hmac)),
          s(:def, :test_pbkdf2_hmac_sha256_c_20000_len_32,
            s(:args),
            s(:begin,
              s(:lvasgn, :p,
                s(:str, "password")),
              s(:lvasgn, :s,
                s(:send,
                  s(:const,
                    s(:const, nil, :OpenSSL), :Random), :random_bytes,
                  s(:int, 16))),
              s(:lvasgn, :c,
                s(:int, 20000)),
              s(:lvasgn, :dk_len,
                s(:int, 32)),
              s(:lvasgn, :digest,
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :OpenSSL), :Digest), :SHA256), :new)),
              s(:lvasgn, :value1,
                s(:send,
                  s(:const,
                    s(:const, nil, :OpenSSL), :PKCS5), :pbkdf2_hmac,
                  s(:lvar, :p),
                  s(:lvar, :s),
                  s(:lvar, :c),
                  s(:lvar, :dk_len),
                  s(:lvar, :digest))),
              s(:lvasgn, :value2,
                s(:send,
                  s(:const,
                    s(:const, nil, :OpenSSL), :PKCS5), :pbkdf2_hmac,
                  s(:lvar, :p),
                  s(:lvar, :s),
                  s(:lvar, :c),
                  s(:lvar, :dk_len),
                  s(:lvar, :digest))),
              s(:send, nil, :assert_equal,
                s(:lvar, :value1),
                s(:lvar, :value2)))), nil))), nil))
