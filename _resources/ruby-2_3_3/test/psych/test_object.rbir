s(:begin,
  s(:send, nil, :require_relative,
    s(:str, "helper")),
  s(:module,
    s(:const, nil, :Psych),
    s(:begin,
      s(:class,
        s(:const, nil, :Tagged), nil,
        s(:begin,
          s(:send, nil, :yaml_tag,
            s(:str, "!foo")),
          s(:send, nil, :attr_accessor,
            s(:sym, :baz)),
          s(:def, :initialize,
            s(:args),
            s(:ivasgn, :@baz,
              s(:str, "bar"))))),
      s(:class,
        s(:const, nil, :Foo), nil,
        s(:begin,
          s(:send, nil, :attr_accessor,
            s(:sym, :parent)),
          s(:def, :initialize,
            s(:args,
              s(:arg, :parent)),
            s(:ivasgn, :@parent,
              s(:lvar, :parent))))),
      s(:class,
        s(:const, nil, :TestObject),
        s(:const, nil, :TestCase),
        s(:begin,
          s(:def, :test_dump_with_tag,
            s(:args),
            s(:begin,
              s(:lvasgn, :tag,
                s(:send,
                  s(:const, nil, :Tagged), :new)),
              s(:send, nil, :assert_match,
                s(:str, "foo"),
                s(:send,
                  s(:const, nil, :Psych), :dump,
                  s(:lvar, :tag))))),
          s(:def, :test_tag_round_trip,
            s(:args),
            s(:begin,
              s(:lvasgn, :tag,
                s(:send,
                  s(:const, nil, :Tagged), :new)),
              s(:lvasgn, :tag2,
                s(:send,
                  s(:const, nil, :Psych), :load,
                  s(:send,
                    s(:const, nil, :Psych), :dump,
                    s(:lvar, :tag)))),
              s(:send, nil, :assert_equal,
                s(:send,
                  s(:lvar, :tag), :baz),
                s(:send,
                  s(:lvar, :tag2), :baz)),
              s(:send, nil, :assert_instance_of,
                s(:const, nil, :Tagged),
                s(:lvar, :tag2)))),
          s(:def, :test_cyclic_references,
            s(:args),
            s(:begin,
              s(:lvasgn, :foo,
                s(:send,
                  s(:const, nil, :Foo), :new,
                  s(:nil))),
              s(:send,
                s(:lvar, :foo), :parent=,
                s(:lvar, :foo)),
              s(:lvasgn, :loaded,
                s(:send,
                  s(:const, nil, :Psych), :load,
                  s(:send,
                    s(:const, nil, :Psych), :dump,
                    s(:lvar, :foo)))),
              s(:send, nil, :assert_instance_of,
                s(:const, nil, :Foo),
                s(:lvar, :loaded)),
              s(:send, nil, :assert_equal,
                s(:lvar, :loaded),
                s(:send,
                  s(:lvar, :loaded), :parent)))))))))
