s(:begin,
  s(:kwbegin,
    s(:rescue,
      s(:send, nil, :require,
        s(:str, "win32ole")),
      s(:resbody,
        s(:array,
          s(:const, nil, :LoadError)), nil, nil), nil)),
  s(:send, nil, :require,
    s(:str, "test/unit")),
  s(:if,
    s(:defined?,
      s(:const, nil, :WIN32OLE_VARIANT)),
    s(:class,
      s(:const, nil, :TestWIN32OLE_VARIANT),
      s(:const,
        s(:const,
          s(:const, nil, :Test), :Unit), :TestCase),
      s(:begin,
        s(:def, :setup,
          s(:args),
          s(:begin,
            s(:ivasgn, :@orglocale,
              s(:send,
                s(:const, nil, :WIN32OLE), :locale)),
            s(:send,
              s(:const, nil, :WIN32OLE), :locale=,
              s(:int, 1033)))),
        s(:def, :teardown,
          s(:args),
          s(:send,
            s(:const, nil, :WIN32OLE), :locale=,
            s(:ivar, :@orglocale))),
        s(:def, :test_s_new,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "foo"))),
            s(:send, nil, :assert_instance_of,
              s(:const, nil, :WIN32OLE_VARIANT),
              s(:lvar, :obj)))),
        s(:def, :test_s_new_exc,
          s(:args),
          s(:block,
            s(:send, nil, :assert_raise,
              s(:const, nil, :TypeError)),
            s(:args),
            s(:send,
              s(:const, nil, :WIN32OLE_VARIANT), :new,
              s(:regexp,
                s(:str, "foo"),
                s(:regopt))))),
        s(:def, :test_s_new_ary,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:int, 1)))),
            s(:send, nil, :assert_instance_of,
              s(:const, nil, :WIN32OLE_VARIANT),
              s(:lvar, :obj)),
            s(:block,
              s(:send, nil, :assert_raise,
                s(:const, nil, :TypeError)),
              s(:args),
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:regexp,
                    s(:str, "foo"),
                    s(:regopt))))))),
        s(:def, :test_s_new_no_argument,
          s(:args),
          s(:begin,
            s(:lvasgn, :pat,
              s(:regexp,
                s(:str, "wrong number of arguments \\(.*\\b0\\b.* 1\\.\\.3\\)"),
                s(:regopt))),
            s(:block,
              s(:send, nil, :assert_raise_with_message,
                s(:const, nil, :ArgumentError),
                s(:lvar, :pat)),
              s(:args),
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new)))),
        s(:def, :test_s_new_one_argument,
          s(:args),
          s(:begin,
            s(:lvasgn, :ex,
              s(:nil)),
            s(:kwbegin,
              s(:rescue,
                s(:send,
                  s(:const, nil, :WIN32OLE_VARIANT), :new,
                  s(:str, "foo")),
                s(:resbody, nil, nil,
                  s(:lvasgn, :ex,
                    s(:gvar, :$!))), nil)),
            s(:send, nil, :assert_equal,
              s(:nil),
              s(:lvar, :ex)))),
        s(:def, :test_s_new_with_nil,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I2))),
            s(:send, nil, :assert_equal,
              s(:int, 0),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_I2),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4))),
            s(:send, nil, :assert_equal,
              s(:int, 0),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_R4))),
            s(:send, nil, :assert_equal,
              s(:int, 0),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_R4),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_R8))),
            s(:send, nil, :assert_equal,
              s(:int, 0),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_R8),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_CY))),
            s(:send, nil, :assert_equal,
              s(:str, "0"),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_CY),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 1899),
                s(:int, 12),
                s(:int, 30)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BSTR))),
            s(:send, nil, :assert_equal,
              s(:str, ""),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_BSTR),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DISPATCH))),
            s(:send, nil, :assert_nil,
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_DISPATCH),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BOOL))),
            s(:send, nil, :assert_equal,
              s(:false),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_BOOL),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_VARIANT))),
            s(:send, nil, :assert_nil,
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_VARIANT),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I1))),
            s(:send, nil, :assert_equal,
              s(:int, 0),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_I1),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI1))),
            s(:send, nil, :assert_equal,
              s(:int, 0),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI1),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI2))),
            s(:send, nil, :assert_equal,
              s(:int, 0),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI2),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI4))),
            s(:send, nil, :assert_equal,
              s(:int, 0),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI4),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:if,
              s(:defined?,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I8)),
              s(:begin,
                s(:lvasgn, :obj,
                  s(:send,
                    s(:const, nil, :WIN32OLE_VARIANT), :new,
                    s(:nil),
                    s(:const,
                      s(:const,
                        s(:const, nil, :WIN32OLE), :VARIANT), :VT_I8))),
                s(:send, nil, :assert_equal,
                  s(:int, 0),
                  s(:send,
                    s(:lvar, :obj), :value)),
                s(:send, nil, :assert_equal,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_I8),
                  s(:send,
                    s(:lvar, :obj), :vartype))), nil),
            s(:if,
              s(:defined?,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI8)),
              s(:begin,
                s(:lvasgn, :obj,
                  s(:send,
                    s(:const, nil, :WIN32OLE_VARIANT), :new,
                    s(:nil),
                    s(:const,
                      s(:const,
                        s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI8))),
                s(:send, nil, :assert_equal,
                  s(:int, 0),
                  s(:send,
                    s(:lvar, :obj), :value)),
                s(:send, nil, :assert_equal,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI8),
                  s(:send,
                    s(:lvar, :obj), :vartype))), nil),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_INT))),
            s(:send, nil, :assert_equal,
              s(:int, 0),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_INT),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UINT))),
            s(:send, nil, :assert_equal,
              s(:int, 0),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_UINT),
              s(:send,
                s(:lvar, :obj), :vartype)))),
        s(:def, :test_s_new_with_non_nil,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 2),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I2))),
            s(:send, nil, :assert_equal,
              s(:int, 2),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_I2),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 3),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4))),
            s(:send, nil, :assert_equal,
              s(:int, 3),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:float, 4.5),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_R4))),
            s(:send, nil, :assert_equal,
              s(:float, 4.5),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_R4),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:float, 5.5),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_R8))),
            s(:send, nil, :assert_equal,
              s(:float, 5.5),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_R8),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 600),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_CY))),
            s(:send, nil, :assert_equal,
              s(:str, "600"),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_CY),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "2001-06-15 12:17:34"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 2001),
                s(:int, 6),
                s(:int, 15),
                s(:int, 12),
                s(:int, 17),
                s(:int, 34)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "foo"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BSTR))),
            s(:send, nil, :assert_equal,
              s(:str, "foo"),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_BSTR),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:true),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BOOL))),
            s(:send, nil, :assert_equal,
              s(:true),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_BOOL),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 2),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I1))),
            s(:send, nil, :assert_equal,
              s(:int, 2),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_I1),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 3),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI1))),
            s(:send, nil, :assert_equal,
              s(:int, 3),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI1),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 4),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI2))),
            s(:send, nil, :assert_equal,
              s(:int, 4),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI2),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 5),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI4))),
            s(:send, nil, :assert_equal,
              s(:int, 5),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI4),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:if,
              s(:defined?,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I8)),
              s(:begin,
                s(:lvasgn, :obj,
                  s(:send,
                    s(:const, nil, :WIN32OLE_VARIANT), :new,
                    s(:int, -123456789012345),
                    s(:const,
                      s(:const,
                        s(:const, nil, :WIN32OLE), :VARIANT), :VT_I8))),
                s(:send, nil, :assert_equal,
                  s(:int, -123456789012345),
                  s(:send,
                    s(:lvar, :obj), :value)),
                s(:send, nil, :assert_equal,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_I8),
                  s(:send,
                    s(:lvar, :obj), :vartype))), nil),
            s(:if,
              s(:defined?,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI8)),
              s(:begin,
                s(:lvasgn, :obj,
                  s(:send,
                    s(:const, nil, :WIN32OLE_VARIANT), :new,
                    s(:int, 123456789012345),
                    s(:const,
                      s(:const,
                        s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI8))),
                s(:send, nil, :assert_equal,
                  s(:int, 123456789012345),
                  s(:send,
                    s(:lvar, :obj), :value)),
                s(:send, nil, :assert_equal,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI8),
                  s(:send,
                    s(:lvar, :obj), :vartype))), nil),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 4),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_INT))),
            s(:send, nil, :assert_equal,
              s(:int, 4),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_INT),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 5),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UINT))),
            s(:send, nil, :assert_equal,
              s(:int, 5),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_UINT),
              s(:send,
                s(:lvar, :obj), :vartype)))),
        s(:def, :test_s_new_with_non_nil_byref,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 2),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_I2), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:int, 2),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I2), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 3),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:int, 3),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:float, 4.5),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_R4), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:float, 4.5),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_R4), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:float, 5.5),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_R8), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:float, 5.5),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_R8), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 600),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_CY), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:str, "600"),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_CY), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "2001-06-15 12:17:34"),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 2001),
                s(:int, 6),
                s(:int, 15),
                s(:int, 12),
                s(:int, 17),
                s(:int, 34)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "foo"),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BSTR), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:str, "foo"),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BSTR), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:true),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BOOL), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:true),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BOOL), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 2),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_I1), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:int, 2),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I1), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 3),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI1), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:int, 3),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI1), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 4),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI2), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:int, 4),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI2), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 5),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI4), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:int, 5),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI4), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 4),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_INT), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:int, 4),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_INT), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 5),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_UINT), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:int, 5),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UINT), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)))),
        s(:def, :test_s_new_with_i8_byref,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, -123456789012345),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_I8), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:int, -123456789012345),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I8), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)))),
        s(:def, :test_s_new_with_ui8_byref,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 123456789012345),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI8), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:int, 123456789012345),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI8), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)))),
        s(:def, :test_value,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "foo"))),
            s(:send, nil, :assert_equal,
              s(:str, "foo"),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_s_new_2_argument,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "foo"),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BSTR), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:str, "foo"),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_s_new_2_argument2,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "foo"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BSTR))),
            s(:send, nil, :assert_equal,
              s(:str, "foo"),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_s_new_dispatch_array,
          s(:args),
          s(:begin,
            s(:lvasgn, :vt,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DISPATCH))),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:lvar, :vt))),
            s(:send, nil, :assert_equal,
              s(:lvar, :vt),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:send, nil, :assert_nil,
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :vt,
              s(:send,
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_DISPATCH)), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF))),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:lvar, :vt))),
            s(:send, nil, :assert_equal,
              s(:lvar, :vt),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:send, nil, :assert_nil,
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_s_new_array,
          s(:args),
          s(:begin,
            s(:lvasgn, :ar,
              s(:block,
                s(:send,
                  s(:send,
                    s(:begin,
                      s(:irange,
                        s(:int, 1),
                        s(:int, 500000))), :to_a), :map),
                s(:args,
                  s(:arg, :i)),
                s(:array,
                  s(:lvar, :i)))),
            s(:lvasgn, :ar2,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:lvar, :ar))),
            s(:send, nil, :assert_equal,
              s(:lvar, :ar),
              s(:send,
                s(:lvar, :ar2), :value)))),
        s(:def, :test_s_new_vt_record_exc,
          s(:args),
          s(:block,
            s(:send, nil, :assert_raise,
              s(:const, nil, :ArgumentError)),
            s(:args),
            s(:send,
              s(:const, nil, :WIN32OLE_VARIANT), :new,
              s(:nil),
              s(:int, 36)))),
        s(:def, :test_s_array,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :array,
                s(:array,
                  s(:int, 2),
                  s(:int, 3)),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4))),
            s(:send, nil, :assert_instance_of,
              s(:const, nil, :WIN32OLE_VARIANT),
              s(:lvar, :obj)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array,
                  s(:int, 0),
                  s(:int, 0),
                  s(:int, 0)),
                s(:array,
                  s(:int, 0),
                  s(:int, 0),
                  s(:int, 0))),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :array,
                s(:array,
                  s(:int, 2),
                  s(:int, 3)),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array,
                  s(:int, 0),
                  s(:int, 0),
                  s(:int, 0)),
                s(:array,
                  s(:int, 0),
                  s(:int, 0),
                  s(:int, 0))),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :array,
                s(:array,
                  s(:int, 2),
                  s(:int, 3)),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY)))),
            s(:send, nil, :assert_instance_of,
              s(:const, nil, :WIN32OLE_VARIANT),
              s(:lvar, :obj)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array,
                  s(:int, 0),
                  s(:int, 0),
                  s(:int, 0)),
                s(:array,
                  s(:int, 0),
                  s(:int, 0),
                  s(:int, 0))),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:int, 0),
              s(:send,
                s(:lvar, :obj), :[],
                s(:int, 0),
                s(:int, 0))),
            s(:send,
              s(:lvar, :obj), :[]=,
              s(:int, 0),
              s(:int, 0),
              s(:int, 10)),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array,
                  s(:int, 10),
                  s(:int, 0),
                  s(:int, 0)),
                s(:array,
                  s(:int, 0),
                  s(:int, 0),
                  s(:int, 0))),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send,
              s(:lvar, :obj), :[]=,
              s(:int, 0),
              s(:int, 1),
              s(:str, "13.2")),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array,
                  s(:int, 10),
                  s(:int, 13),
                  s(:int, 0)),
                s(:array,
                  s(:int, 0),
                  s(:int, 0),
                  s(:int, 0))),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :array,
                s(:array,
                  s(:int, 3),
                  s(:int, 2)),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_VARIANT))),
            s(:send,
              s(:lvar, :obj), :[]=,
              s(:int, 0),
              s(:int, 0),
              s(:int, 10)),
            s(:send,
              s(:lvar, :obj), :[]=,
              s(:int, 0),
              s(:int, 1),
              s(:str, "string")),
            s(:send,
              s(:lvar, :obj), :[]=,
              s(:int, 1),
              s(:int, 0),
              s(:float, 12.735)),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array,
                  s(:int, 10),
                  s(:str, "string")),
                s(:array,
                  s(:float, 12.735),
                  s(:nil)),
                s(:array,
                  s(:nil),
                  s(:nil))),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :array,
                s(:array,
                  s(:int, 2),
                  s(:int, 3)),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DISPATCH))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array,
                  s(:nil),
                  s(:nil),
                  s(:nil)),
                s(:array,
                  s(:nil),
                  s(:nil),
                  s(:nil))),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_s_array_exc,
          s(:args),
          s(:block,
            s(:send, nil, :assert_raise,
              s(:const, nil, :TypeError)),
            s(:args),
            s(:send,
              s(:const, nil, :WIN32OLE_VARIANT), :array,
              s(:int, 2),
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4)))),
        s(:def, :test_conversion_num2str,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 124),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BSTR))),
            s(:send, nil, :assert_equal,
              s(:str, "124"),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_conversion_float2int,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:float, 12.345),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4))),
            s(:send, nil, :assert_equal,
              s(:int, 12),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:float, 12.345),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:int, 12),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_conversion_str2num,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "12.345"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_R8))),
            s(:send, nil, :assert_equal,
              s(:float, 12.345),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_conversion_ole_variant2ole_variant,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "12.345"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_R4))),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:lvar, :obj),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4))),
            s(:send, nil, :assert_equal,
              s(:int, 12),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_conversion_str2date,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "2004-12-24 12:24:45"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 2004),
                s(:int, 12),
                s(:int, 24),
                s(:int, 12),
                s(:int, 24),
                s(:int, 45)),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_conversion_time2date,
          s(:args),
          s(:begin,
            s(:lvasgn, :dt,
              s(:send,
                s(:const, nil, :Time), :mktime,
                s(:int, 2004),
                s(:int, 12),
                s(:int, 24),
                s(:int, 12),
                s(:int, 24),
                s(:int, 45))),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:lvar, :dt),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:lvar, :dt),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_conversion_dbl2date_with_msec,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:float, 41878.5242683912),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:lvasgn, :t,
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:str, "2014-08-27 12:34:56"),
              s(:send,
                s(:lvar, :t), :strftime,
                s(:str, "%Y-%m-%d %H:%M:%S"))),
            s(:send, nil, :assert_in_delta,
              s(:float, 0.789),
              s(:send,
                s(:send,
                  s(:lvar, :t), :nsec), :/,
                s(:float, 1000000000.0)),
              s(:float, 0.001)))),
        s(:def, :test_conversion_time2date_with_msec,
          s(:args),
          s(:begin,
            s(:lvasgn, :t0,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 2014),
                s(:int, 8),
                s(:int, 27),
                s(:int, 12),
                s(:int, 34),
                s(:int, 56))),
            s(:op_asgn,
              s(:lvasgn, :t0), :+,
              s(:float, 0.789)),
            s(:lvasgn, :t1,
              s(:send,
                s(:send,
                  s(:const, nil, :WIN32OLE_VARIANT), :new,
                  s(:lvar, :t0)), :value)),
            s(:lvasgn, :msg,
              s(:dstr,
                s(:str, "Expected:"),
                s(:begin,
                  s(:send,
                    s(:lvar, :t0), :strftime,
                    s(:str, "%Y-%m-%dT%H:%M:%S.%N"))),
                s(:str, " but was:"),
                s(:begin,
                  s(:send,
                    s(:lvar, :t1), :strftime,
                    s(:str, "%Y-%m-%dT%H:%M:%S.%N"))))),
            s(:send, nil, :assert_in_delta,
              s(:lvar, :t0),
              s(:lvar, :t1),
              s(:float, 0.001),
              s(:lvar, :msg)),
            s(:lvasgn, :t0,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 2014),
                s(:int, 8),
                s(:int, 27),
                s(:int, 12),
                s(:int, 34),
                s(:int, 56))),
            s(:op_asgn,
              s(:lvasgn, :t0), :+,
              s(:float, 0.999999999)),
            s(:lvasgn, :t1,
              s(:send,
                s(:send,
                  s(:const, nil, :WIN32OLE_VARIANT), :new,
                  s(:lvar, :t0)), :value)),
            s(:lvasgn, :msg,
              s(:dstr,
                s(:str, "Expected:"),
                s(:begin,
                  s(:send,
                    s(:lvar, :t0), :strftime,
                    s(:str, "%Y-%m-%dT%H:%M:%S.%N"))),
                s(:str, " but was:"),
                s(:begin,
                  s(:send,
                    s(:lvar, :t1), :strftime,
                    s(:str, "%Y-%m-%dT%H:%M:%S.%N"))))),
            s(:send, nil, :assert_in_delta,
              s(:lvar, :t0),
              s(:lvar, :t1),
              s(:float, 0.001),
              s(:lvar, :msg)),
            s(:lvasgn, :t0,
              s(:send,
                s(:const, nil, :Time), :now)),
            s(:lvasgn, :t1,
              s(:send,
                s(:send,
                  s(:const, nil, :WIN32OLE_VARIANT), :new,
                  s(:lvar, :t0)), :value)),
            s(:lvasgn, :msg,
              s(:dstr,
                s(:str, "Expected:"),
                s(:begin,
                  s(:send,
                    s(:lvar, :t0), :strftime,
                    s(:str, "%Y-%m-%dT%H:%M:%S.%N"))),
                s(:str, " but was:"),
                s(:begin,
                  s(:send,
                    s(:lvar, :t1), :strftime,
                    s(:str, "%Y-%m-%dT%H:%M:%S.%N"))))),
            s(:send, nil, :assert_in_delta,
              s(:lvar, :t0),
              s(:lvar, :t1),
              s(:float, 0.001),
              s(:lvar, :msg)))),
        s(:def, :test_conversion_str2cy,
          s(:args),
          s(:begin,
            s(:kwbegin,
              s(:rescue,
                s(:send,
                  s(:const, nil, :WIN32OLE), :locale=,
                  s(:int, 1041)),
                s(:resbody,
                  s(:array,
                    s(:const, nil, :WIN32OLERuntimeError)), nil,
                  s(:send, nil, :skip,
                    s(:str, "Japanese locale is not installed"))), nil)),
            s(:if,
              s(:send,
                s(:send,
                  s(:const, nil, :WIN32OLE), :locale), :==,
                s(:int, 1041)),
              s(:begin,
                s(:lvasgn, :obj,
                  s(:send,
                    s(:const, nil, :WIN32OLE_VARIANT), :new,
                    s(:str, "\\10,000"),
                    s(:const,
                      s(:const,
                        s(:const, nil, :WIN32OLE), :VARIANT), :VT_CY))),
                s(:send, nil, :assert_equal,
                  s(:str, "10000"),
                  s(:send,
                    s(:lvar, :obj), :value))), nil))),
        s(:def, :test_create_vt_array,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:float, 1.2),
                  s(:float, 2.3)),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_R8)))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:float, 1.2),
                s(:float, 2.3)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_R8)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:float, 1.2),
                  s(:float, 2.3)),
                s(:send,
                  s(:send,
                    s(:const,
                      s(:const,
                        s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                    s(:const,
                      s(:const,
                        s(:const, nil, :WIN32OLE), :VARIANT), :VT_R8)), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:float, 1.2),
                s(:float, 2.3)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_R8)), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)))),
        s(:def, :test_create_vt_array2,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:float, 1.2),
                  s(:str, "a")),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:float, 1.2),
                s(:str, "a")),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_VARIANT)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:float, 1.2),
                  s(:str, "a")))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:float, 1.2),
                s(:str, "a")),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_VARIANT)),
              s(:send,
                s(:lvar, :obj), :vartype)))),
        s(:def, :test_create_vt_nested_array,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:array,
                    s(:float, 1.2),
                    s(:str, "a"),
                    s(:str, "b")),
                  s(:array,
                    s(:float, 3.4),
                    s(:str, "C"),
                    s(:str, "D"))),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array,
                  s(:float, 1.2),
                  s(:str, "a"),
                  s(:str, "b")),
                s(:array,
                  s(:float, 3.4),
                  s(:str, "C"),
                  s(:str, "D"))),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:array,
                    s(:float, 1.2),
                    s(:str, "a"),
                    s(:str, "b")),
                  s(:array,
                    s(:float, 3.4),
                    s(:str, "C"),
                    s(:str, "D"))))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array,
                  s(:float, 1.2),
                  s(:str, "a"),
                  s(:str, "b")),
                s(:array,
                  s(:float, 3.4),
                  s(:str, "C"),
                  s(:str, "D"))),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:array,
                    s(:float, 1.2),
                    s(:str, "a"),
                    s(:str, "b")),
                  s(:array,
                    s(:float, 3.4),
                    s(:str, "C"),
                    s(:str, "D")),
                  s(:array,
                    s(:float, 5.6),
                    s(:str, "E"),
                    s(:str, "F"))))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array,
                  s(:float, 1.2),
                  s(:str, "a"),
                  s(:str, "b")),
                s(:array,
                  s(:float, 3.4),
                  s(:str, "C"),
                  s(:str, "D")),
                s(:array,
                  s(:float, 5.6),
                  s(:str, "E"),
                  s(:str, "F"))),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:array,
                    s(:array,
                      s(:float, 1.2)),
                    s(:array,
                      s(:float, 3.4))),
                  s(:array,
                    s(:array,
                      s(:float, 5.6)),
                    s(:array,
                      s(:float, 7.8))),
                  s(:array,
                    s(:array,
                      s(:float, 9.1)),
                    s(:array,
                      s(:float, 9.2)))))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array,
                  s(:array,
                    s(:float, 1.2)),
                  s(:array,
                    s(:float, 3.4))),
                s(:array,
                  s(:array,
                    s(:float, 5.6)),
                  s(:array,
                    s(:float, 7.8))),
                s(:array,
                  s(:array,
                    s(:float, 9.1)),
                  s(:array,
                    s(:float, 9.2)))),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_create_vt_array3,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array))),
            s(:send, nil, :assert_equal,
              s(:array),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:array)))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:array),
                  s(:array)))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array),
                s(:array)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:array),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:array)),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:array),
                  s(:array)),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array),
                s(:array)),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_create_vt_array_nil,
          s(:args),
          s(:begin,
            s(:lvasgn, :vartype,
              s(:send,
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_DISPATCH)), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF))),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:lvar, :vartype))),
            s(:send, nil, :assert_nil,
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:lvar, :vartype),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :vartype,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DISPATCH))),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:lvar, :vartype))),
            s(:send, nil, :assert_nil,
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:lvar, :vartype),
              s(:send,
                s(:lvar, :obj), :vartype)))),
        s(:def, :test_create_vt_array_str,
          s(:args),
          s(:begin,
            s(:lvasgn, :vartype,
              s(:send,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BSTR))),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:str, "abc"),
                  s(:str, "123")),
                s(:lvar, :vartype))),
            s(:send, nil, :assert_equal,
              s(:lvar, :vartype),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:str, "abc"),
                s(:str, "123")),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :vartype,
              s(:send,
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BSTR))),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:str, "abc"),
                  s(:str, "123")),
                s(:lvar, :vartype))),
            s(:send, nil, :assert_equal,
              s(:lvar, :vartype),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:str, "abc"),
                s(:str, "123")),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_create_vt_array_exc,
          s(:args),
          s(:begin,
            s(:lvasgn, :exc,
              s(:block,
                s(:send, nil, :assert_raise,
                  s(:const, nil, :TypeError)),
                s(:args),
                s(:send,
                  s(:const, nil, :WIN32OLE_VARIANT), :new,
                  s(:int, 1),
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY)))),
            s(:send, nil, :assert_match,
              s(:regexp,
                s(:str, "wrong argument type Fixnum \\(expected Array\\)"),
                s(:regopt)),
              s(:send,
                s(:lvar, :exc), :message)))),
        s(:def, :test_create_vt_array_str2ui1array,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "ABC"),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI1)))),
            s(:send, nil, :assert_equal,
              s(:str, "ABC"),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send,
              s(:lvar, :obj), :value=,
              s(:str, "DEF")),
            s(:send, nil, :assert_equal,
              s(:str, "DEF"),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send,
              s(:lvar, :obj), :[]=,
              s(:int, 0),
              s(:int, 71)),
            s(:send, nil, :assert_equal,
              s(:str, "GEF"),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:send,
                  s(:array,
                    s(:int, 65),
                    s(:int, 0)), :pack,
                  s(:str, "C*")),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI1)))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:array,
                  s(:int, 65),
                  s(:int, 0)), :pack,
                s(:str, "C*")),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "abc"),
                s(:send,
                  s(:send,
                    s(:const,
                      s(:const,
                        s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                    s(:const,
                      s(:const,
                        s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI1)), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:str, "abc"),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send,
              s(:lvar, :obj), :value=,
              s(:str, "DEF")),
            s(:send, nil, :assert_equal,
              s(:str, "DEF"),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI1)), :|,
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:send,
              s(:lvar, :obj), :[]=,
              s(:int, 1),
              s(:int, 71)),
            s(:send, nil, :assert_equal,
              s(:str, "DGF"),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_create_vt_array_int,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:int, 65),
                  s(:int, 0)),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_UI1)))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:array,
                  s(:int, 65),
                  s(:int, 0)), :pack,
                s(:str, "C*")),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:int, 65),
                  s(:int, 0)))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:int, 65),
                s(:int, 0)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:int, 65),
                  s(:int, 0)),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_I2), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_ARRAY)))),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:int, 65),
                s(:int, 0)),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_vt_array_bracket,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:array,
                    s(:int, 1),
                    s(:int, 2),
                    s(:int, 3)),
                  s(:array,
                    s(:int, 4),
                    s(:int, 5),
                    s(:int, 6))))),
            s(:send, nil, :assert_equal,
              s(:int, 1),
              s(:send,
                s(:lvar, :obj), :[],
                s(:int, 0),
                s(:int, 0))),
            s(:send, nil, :assert_equal,
              s(:int, 2),
              s(:send,
                s(:lvar, :obj), :[],
                s(:int, 0),
                s(:int, 1))),
            s(:send, nil, :assert_equal,
              s(:int, 3),
              s(:send,
                s(:lvar, :obj), :[],
                s(:int, 0),
                s(:int, 2))),
            s(:send, nil, :assert_equal,
              s(:int, 4),
              s(:send,
                s(:lvar, :obj), :[],
                s(:int, 1),
                s(:int, 0))),
            s(:send, nil, :assert_equal,
              s(:int, 5),
              s(:send,
                s(:lvar, :obj), :[],
                s(:int, 1),
                s(:int, 1))),
            s(:send, nil, :assert_equal,
              s(:int, 6),
              s(:send,
                s(:lvar, :obj), :[],
                s(:int, 1),
                s(:int, 2))),
            s(:block,
              s(:send, nil, :assert_raise,
                s(:const, nil, :WIN32OLERuntimeError)),
              s(:args),
              s(:send,
                s(:lvar, :obj), :[],
                s(:int, 0),
                s(:int, 4))),
            s(:block,
              s(:send, nil, :assert_raise,
                s(:const, nil, :WIN32OLERuntimeError)),
              s(:args),
              s(:send,
                s(:lvar, :obj), :[],
                s(:int, 0),
                s(:int, -1))),
            s(:block,
              s(:send, nil, :assert_raise,
                s(:const, nil, :ArgumentError)),
              s(:args),
              s(:send,
                s(:lvar, :obj), :[],
                s(:int, 0))),
            s(:send,
              s(:lvar, :obj), :[]=,
              s(:int, 0),
              s(:int, 0),
              s(:int, 7)),
            s(:send,
              s(:lvar, :obj), :[]=,
              s(:int, 1),
              s(:int, 2),
              s(:int, 8)),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:array,
                  s(:int, 7),
                  s(:int, 2),
                  s(:int, 3)),
                s(:array,
                  s(:int, 4),
                  s(:int, 5),
                  s(:int, 8))),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:block,
              s(:send, nil, :assert_raise,
                s(:const, nil, :WIN32OLERuntimeError)),
              s(:args),
              s(:send,
                s(:lvar, :obj), :[]=,
                s(:int, 0),
                s(:int, 4),
                s(:int, 9))),
            s(:block,
              s(:send, nil, :assert_raise,
                s(:const, nil, :WIN32OLERuntimeError)),
              s(:args),
              s(:send,
                s(:lvar, :obj), :[]=,
                s(:int, 0),
                s(:int, -1),
                s(:int, 10))),
            s(:block,
              s(:send, nil, :assert_raise,
                s(:const, nil, :ArgumentError)),
              s(:args),
              s(:send,
                s(:lvar, :obj), :[]=,
                s(:int, 0),
                s(:int, 11))))),
        s(:def, :test_conversion_vt_date,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, -657434),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 100),
                s(:int, 1),
                s(:int, 1)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "1500/12/29 23:59:59"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 1500),
                s(:int, 12),
                s(:int, 29),
                s(:int, 23),
                s(:int, 59),
                s(:int, 59)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "1500/12/30 00:00:00"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 1500),
                s(:int, 12),
                s(:int, 30)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "1500/12/30 00:00:01"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 1500),
                s(:int, 12),
                s(:int, 30),
                s(:int, 0),
                s(:int, 0),
                s(:int, 1)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "1899/12/29 23:59:59"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 1899),
                s(:int, 12),
                s(:int, 29),
                s(:int, 23),
                s(:int, 59),
                s(:int, 59)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "1899/12/30 00:00:00"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 1899),
                s(:int, 12),
                s(:int, 30)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "1899/12/30 00:00:01"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 1899),
                s(:int, 12),
                s(:int, 30),
                s(:int, 0),
                s(:int, 0),
                s(:int, 1)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 0),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 1899),
                s(:int, 12),
                s(:int, 30)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "2008/12/29 23:59:59"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 2008),
                s(:int, 12),
                s(:int, 29),
                s(:int, 23),
                s(:int, 59),
                s(:int, 59)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "2008/12/30 00:00:00"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 2008),
                s(:int, 12),
                s(:int, 30),
                s(:int, 0),
                s(:int, 0),
                s(:int, 0)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "2008/12/30 00:00:01"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 2008),
                s(:int, 12),
                s(:int, 30),
                s(:int, 0),
                s(:int, 0),
                s(:int, 1)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "9999/12/31 23:59:59"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 9999),
                s(:int, 12),
                s(:int, 31),
                s(:int, 23),
                s(:int, 59),
                s(:int, 59)),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_create_nil_dispatch,
          s(:args),
          s(:begin,
            s(:lvasgn, :var,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:nil),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DISPATCH))),
            s(:send, nil, :assert_nil,
              s(:send,
                s(:lvar, :var), :value)))),
        s(:def, :test_create_variant_byref,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "Str"),
                s(:send,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_VARIANT), :|,
                  s(:const,
                    s(:const,
                      s(:const, nil, :WIN32OLE), :VARIANT), :VT_BYREF)))),
            s(:send, nil, :assert_equal,
              s(:str, "Str"),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_vartype,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "Str"))),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_BSTR),
              s(:send,
                s(:lvar, :obj), :vartype)))),
        s(:def, :test_set_value,
          s(:args),
          s(:begin,
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, 10))),
            s(:send,
              s(:lvar, :obj), :value=,
              s(:int, 12)),
            s(:send, nil, :assert_equal,
              s(:int, 12),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:send,
              s(:lvar, :obj), :value=,
              s(:str, "14")),
            s(:send, nil, :assert_equal,
              s(:int, 14),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:send,
              s(:lvar, :obj), :value=,
              s(:float, 11.2)),
            s(:send, nil, :assert_equal,
              s(:int, 11),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:send, nil, :assert_equal,
              s(:const,
                s(:const,
                  s(:const, nil, :WIN32OLE), :VARIANT), :VT_I4),
              s(:send,
                s(:lvar, :obj), :vartype)),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:array,
                  s(:int, 1),
                  s(:int, 2)))),
            s(:block,
              s(:send, nil, :assert_raise,
                s(:const, nil, :WIN32OLERuntimeError)),
              s(:args),
              s(:send,
                s(:lvar, :obj), :value=,
                s(:array,
                  s(:int, 3),
                  s(:int, 4)))),
            s(:lvasgn, :obj,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "2007/01/01"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:block,
              s(:send, nil, :assert_raise,
                s(:const, nil, :WIN32OLERuntimeError)),
              s(:args),
              s(:send,
                s(:lvar, :obj), :value=,
                s(:str, "hogehoge"))),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 2007),
                s(:int, 1),
                s(:int, 1)),
              s(:send,
                s(:lvar, :obj), :value)),
            s(:lvasgn, :obj2,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:str, "2006/01/01"),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_DATE))),
            s(:send,
              s(:lvar, :obj), :value=,
              s(:lvar, :obj2)),
            s(:send, nil, :assert_equal,
              s(:send,
                s(:const, nil, :Time), :new,
                s(:int, 2006),
                s(:int, 1),
                s(:int, 1)),
              s(:send,
                s(:lvar, :obj), :value)))),
        s(:def, :test_c_nothing,
          s(:args),
          s(:send, nil, :assert_nil,
            s(:send,
              s(:const,
                s(:const, nil, :WIN32OLE_VARIANT), :Nothing), :value))),
        s(:def, :test_c_empty,
          s(:args),
          s(:send, nil, :assert_nil,
            s(:send,
              s(:const,
                s(:const, nil, :WIN32OLE_VARIANT), :Empty), :value))),
        s(:def, :test_c_null,
          s(:args),
          s(:send, nil, :assert_nil,
            s(:send,
              s(:const,
                s(:const, nil, :WIN32OLE_VARIANT), :Null), :value))),
        s(:def, :test_c_noparam,
          s(:args),
          s(:send, nil, :assert_equal,
            s(:int, -2147352572),
            s(:send,
              s(:const,
                s(:const, nil, :WIN32OLE_VARIANT), :NoParam), :value))),
        s(:def, :test_vt_error_noparam,
          s(:args),
          s(:begin,
            s(:lvasgn, :v,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, -1),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_ERROR))),
            s(:send, nil, :assert_equal,
              s(:int, -1),
              s(:send,
                s(:lvar, :v), :value)),
            s(:lvasgn, :fso,
              s(:send,
                s(:const, nil, :WIN32OLE), :new,
                s(:str, "Scripting.FileSystemObject"))),
            s(:lvasgn, :exc,
              s(:block,
                s(:send, nil, :assert_raise,
                  s(:const, nil, :WIN32OLERuntimeError)),
                s(:args),
                s(:send,
                  s(:lvar, :fso), :openTextFile,
                  s(:str, "NonExistingFile"),
                  s(:lvar, :v),
                  s(:false)))),
            s(:send, nil, :assert_match,
              s(:regexp,
                s(:str, "Type mismatch"),
                s(:regopt, :i)),
              s(:send,
                s(:lvar, :exc), :message)),
            s(:lvasgn, :exc,
              s(:block,
                s(:send, nil, :assert_raise,
                  s(:const, nil, :WIN32OLERuntimeError)),
                s(:args),
                s(:send,
                  s(:lvar, :fso), :openTextFile,
                  s(:str, "NonExistingFile"),
                  s(:const,
                    s(:const, nil, :WIN32OLE_VARIANT), :NoParam),
                  s(:false)))),
            s(:send, nil, :assert_match,
              s(:regexp,
                s(:str, "800A0035"),
                s(:regopt)),
              s(:send,
                s(:lvar, :exc), :message)),
            s(:lvasgn, :v,
              s(:send,
                s(:const, nil, :WIN32OLE_VARIANT), :new,
                s(:int, -2147352572),
                s(:const,
                  s(:const,
                    s(:const, nil, :WIN32OLE), :VARIANT), :VT_ERROR))),
            s(:lvasgn, :exc,
              s(:block,
                s(:send, nil, :assert_raise,
                  s(:const, nil, :WIN32OLERuntimeError)),
                s(:args),
                s(:send,
                  s(:lvar, :fso), :openTextFile,
                  s(:str, "NonExistingFile"),
                  s(:const,
                    s(:const, nil, :WIN32OLE_VARIANT), :NoParam),
                  s(:false)))),
            s(:send, nil, :assert_match,
              s(:regexp,
                s(:str, "800A0035"),
                s(:regopt)),
              s(:send,
                s(:lvar, :exc), :message)))))), nil))
