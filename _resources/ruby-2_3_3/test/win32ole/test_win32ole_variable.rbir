s(:begin,
  s(:kwbegin,
    s(:rescue,
      s(:send, nil, :require,
        s(:str, "win32ole")),
      s(:resbody,
        s(:array,
          s(:const, nil, :LoadError)), nil, nil), nil)),
  s(:send, nil, :require,
    s(:str, "test/unit")),
  s(:if,
    s(:defined?,
      s(:const, nil, :WIN32OLE_VARIABLE)),
    s(:class,
      s(:const, nil, :TestWIN32OLE_VARIABLE),
      s(:const,
        s(:const,
          s(:const, nil, :Test), :Unit), :TestCase),
      s(:begin,
        s(:def, :setup,
          s(:args),
          s(:begin,
            s(:lvasgn, :ole_type,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPE), :new,
                s(:str, "Microsoft Shell Controls And Automation"),
                s(:str, "ShellSpecialFolderConstants"))),
            s(:ivasgn, :@var1,
              s(:block,
                s(:send,
                  s(:send,
                    s(:lvar, :ole_type), :variables), :find),
                s(:args,
                  s(:arg, :v)),
                s(:send,
                  s(:send,
                    s(:lvar, :v), :name), :==,
                  s(:str, "ssfDESKTOP")))),
            s(:lvasgn, :variables,
              s(:send,
                s(:send,
                  s(:const, nil, :WIN32OLE_TYPE), :new,
                  s(:str, "Microsoft Windows Installer Object Library"),
                  s(:str, "Installer")), :variables)),
            s(:ivasgn, :@var2,
              s(:block,
                s(:send,
                  s(:lvar, :variables), :find),
                s(:args,
                  s(:arg, :v)),
                s(:send,
                  s(:send,
                    s(:lvar, :v), :name), :==,
                  s(:str, "UILevel")))))),
        s(:def, :test_name,
          s(:args),
          s(:send, nil, :assert_equal,
            s(:str, "ssfDESKTOP"),
            s(:send,
              s(:ivar, :@var1), :name))),
        s(:def, :test_ole_type,
          s(:args),
          s(:begin,
            s(:send, nil, :assert_equal,
              s(:str, "INT"),
              s(:send,
                s(:ivar, :@var1), :ole_type)),
            s(:send, nil, :assert_equal,
              s(:str, "MsiUILevel"),
              s(:send,
                s(:ivar, :@var2), :ole_type)))),
        s(:def, :test_ole_type_detail,
          s(:args),
          s(:begin,
            s(:send, nil, :assert_equal,
              s(:array,
                s(:str, "INT")),
              s(:send,
                s(:ivar, :@var1), :ole_type_detail)),
            s(:send, nil, :assert_equal,
              s(:array,
                s(:str, "USERDEFINED"),
                s(:str, "MsiUILevel")),
              s(:send,
                s(:ivar, :@var2), :ole_type_detail)))),
        s(:def, :test_ole_type_value,
          s(:args),
          s(:begin,
            s(:send, nil, :assert_equal,
              s(:int, 0),
              s(:send,
                s(:ivar, :@var1), :value)),
            s(:send, nil, :assert_equal,
              s(:nil),
              s(:send,
                s(:ivar, :@var2), :value)))),
        s(:def, :test_ole_type_visible?,
          s(:args),
          s(:send, nil, :assert,
            s(:send,
              s(:ivar, :@var1), :visible?))),
        s(:def, :test_ole_type_variable_kind,
          s(:args),
          s(:begin,
            s(:send, nil, :assert_equal,
              s(:str, "CONSTANT"),
              s(:send,
                s(:ivar, :@var1), :variable_kind)),
            s(:send, nil, :assert_equal,
              s(:str, "DISPATCH"),
              s(:send,
                s(:ivar, :@var2), :variable_kind)))),
        s(:def, :test_ole_type_varkind,
          s(:args),
          s(:begin,
            s(:send, nil, :assert_equal,
              s(:int, 2),
              s(:send,
                s(:ivar, :@var1), :varkind)),
            s(:send, nil, :assert_equal,
              s(:int, 3),
              s(:send,
                s(:ivar, :@var2), :varkind)))),
        s(:def, :test_to_s,
          s(:args),
          s(:send, nil, :assert_equal,
            s(:send,
              s(:ivar, :@var1), :name),
            s(:send,
              s(:ivar, :@var1), :to_s))),
        s(:def, :test_inspect,
          s(:args),
          s(:begin,
            s(:send, nil, :assert_equal,
              s(:str, "#<WIN32OLE_VARIABLE:ssfDESKTOP=0>"),
              s(:send,
                s(:ivar, :@var1), :inspect)),
            s(:send, nil, :assert_equal,
              s(:str, "#<WIN32OLE_VARIABLE:UILevel=nil>"),
              s(:send,
                s(:ivar, :@var2), :inspect)))))), nil))
