s(:begin,
  s(:kwbegin,
    s(:rescue,
      s(:send, nil, :require,
        s(:str, "win32ole")),
      s(:resbody,
        s(:array,
          s(:const, nil, :LoadError)), nil, nil), nil)),
  s(:send, nil, :require,
    s(:str, "test/unit")),
  s(:if,
    s(:defined?,
      s(:const, nil, :WIN32OLE_TYPELIB)),
    s(:class,
      s(:const, nil, :TestWIN32OLE_TYPELIB),
      s(:const,
        s(:const,
          s(:const, nil, :Test), :Unit), :TestCase),
      s(:begin,
        s(:def, :test_s_typelibs,
          s(:args),
          s(:begin,
            s(:lvasgn, :tlibs,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :typelibs)),
            s(:send, nil, :assert_instance_of,
              s(:const, nil, :Array),
              s(:lvar, :tlibs)),
            s(:send, nil, :assert,
              s(:send,
                s(:send,
                  s(:lvar, :tlibs), :size), :>,
                s(:int, 0))),
            s(:lvasgn, :tlib,
              s(:block,
                s(:send,
                  s(:lvar, :tlibs), :find),
                s(:args,
                  s(:arg, :t)),
                s(:send,
                  s(:send,
                    s(:lvar, :t), :name), :==,
                  s(:str, "Microsoft Shell Controls And Automation")))),
            s(:send, nil, :assert,
              s(:lvar, :tlib)))),
        s(:def, :test_initialize,
          s(:args),
          s(:begin,
            s(:block,
              s(:send, nil, :assert_raise,
                s(:const, nil, :ArgumentError)),
              s(:args),
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:int, 1),
                s(:int, 2),
                s(:int, 3),
                s(:int, 4))),
            s(:block,
              s(:send, nil, :assert_raise,
                s(:const, nil, :TypeError)),
              s(:args),
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:int, 100))),
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"))),
            s(:send, nil, :assert_instance_of,
              s(:const, nil, :WIN32OLE_TYPELIB),
              s(:lvar, :tlib)),
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"),
                s(:float, 1.0))),
            s(:send, nil, :assert_instance_of,
              s(:const, nil, :WIN32OLE_TYPELIB),
              s(:lvar, :tlib)),
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"),
                s(:int, 1),
                s(:int, 0))),
            s(:send, nil, :assert_instance_of,
              s(:const, nil, :WIN32OLE_TYPELIB),
              s(:lvar, :tlib)),
            s(:lvasgn, :guid,
              s(:send,
                s(:lvar, :tlib), :guid)),
            s(:lvasgn, :tlib_by_guid,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:lvar, :guid),
                s(:int, 1),
                s(:int, 0))),
            s(:send, nil, :assert_instance_of,
              s(:const, nil, :WIN32OLE_TYPELIB),
              s(:lvar, :tlib_by_guid)),
            s(:send, nil, :assert_equal,
              s(:str, "Microsoft Shell Controls And Automation"),
              s(:send,
                s(:lvar, :tlib_by_guid), :name)),
            s(:lvasgn, :path,
              s(:send,
                s(:lvar, :tlib), :path)),
            s(:lvasgn, :tlib_by_path,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:lvar, :path))),
            s(:send, nil, :assert_equal,
              s(:str, "Microsoft Shell Controls And Automation"),
              s(:send,
                s(:lvar, :tlib_by_path), :name)),
            s(:block,
              s(:send, nil, :assert_raise,
                s(:const, nil, :WIN32OLERuntimeError)),
              s(:args),
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Non Exist Type Library"))))),
        s(:def, :test_initialize_with_REG_EXPAND_SZ,
          s(:args),
          s(:begin,
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Disk Management Snap-In Object Library"))),
            s(:send, nil, :assert_instance_of,
              s(:const, nil, :WIN32OLE_TYPELIB),
              s(:lvar, :tlib)))),
        s(:def, :test_guid,
          s(:args),
          s(:begin,
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"))),
            s(:send, nil, :assert_equal,
              s(:str, "{50A7E9B0-70EF-11D1-B75A-00A0C90564FE}"),
              s(:send,
                s(:lvar, :tlib), :guid)))),
        s(:def, :test_name,
          s(:args),
          s(:begin,
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"))),
            s(:send, nil, :assert_equal,
              s(:str, "Microsoft Shell Controls And Automation"),
              s(:send,
                s(:lvar, :tlib), :name)),
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "{50A7E9B0-70EF-11D1-B75A-00A0C90564FE}"))),
            s(:send, nil, :assert_equal,
              s(:str, "Microsoft Shell Controls And Automation"),
              s(:send,
                s(:lvar, :tlib), :name)))),
        s(:def, :test_version,
          s(:args),
          s(:begin,
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"))),
            s(:send, nil, :assert_equal,
              s(:str, "1.0"),
              s(:send,
                s(:lvar, :tlib), :version)))),
        s(:def, :test_major_version,
          s(:args),
          s(:begin,
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"))),
            s(:send, nil, :assert_equal,
              s(:int, 1),
              s(:send,
                s(:lvar, :tlib), :major_version)))),
        s(:def, :test_minor_version,
          s(:args),
          s(:begin,
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"))),
            s(:send, nil, :assert_equal,
              s(:int, 0),
              s(:send,
                s(:lvar, :tlib), :minor_version)))),
        s(:def, :test_path,
          s(:args),
          s(:begin,
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"))),
            s(:send, nil, :assert_match,
              s(:regexp,
                s(:str, "shell32\\.dll$"),
                s(:regopt, :i)),
              s(:send,
                s(:lvar, :tlib), :path)))),
        s(:def, :test_visible?,
          s(:args),
          s(:begin,
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"))),
            s(:send, nil, :assert,
              s(:send,
                s(:lvar, :tlib), :visible?)))),
        s(:def, :test_library_name,
          s(:args),
          s(:begin,
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"))),
            s(:send, nil, :assert_equal,
              s(:str, "Shell32"),
              s(:send,
                s(:lvar, :tlib), :library_name)))),
        s(:def, :test_to_s,
          s(:args),
          s(:begin,
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"))),
            s(:send, nil, :assert_equal,
              s(:str, "Microsoft Shell Controls And Automation"),
              s(:send,
                s(:lvar, :tlib), :to_s)))),
        s(:def, :test_ole_types,
          s(:args),
          s(:begin,
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"))),
            s(:lvasgn, :ole_types,
              s(:send,
                s(:lvar, :tlib), :ole_types)),
            s(:send, nil, :assert_instance_of,
              s(:const, nil, :Array),
              s(:lvar, :ole_types)),
            s(:send, nil, :assert,
              s(:send,
                s(:send,
                  s(:lvar, :ole_types), :size), :>,
                s(:int, 0))),
            s(:send, nil, :assert_instance_of,
              s(:const, nil, :WIN32OLE_TYPE),
              s(:send,
                s(:lvar, :ole_types), :[],
                s(:int, 0))))),
        s(:def, :test_inspect,
          s(:args),
          s(:begin,
            s(:lvasgn, :tlib,
              s(:send,
                s(:const, nil, :WIN32OLE_TYPELIB), :new,
                s(:str, "Microsoft Shell Controls And Automation"))),
            s(:send, nil, :assert_equal,
              s(:str, "#<WIN32OLE_TYPELIB:Microsoft Shell Controls And Automation>"),
              s(:send,
                s(:lvar, :tlib), :inspect)))))), nil))
