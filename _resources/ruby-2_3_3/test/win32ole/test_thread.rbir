s(:begin,
  s(:kwbegin,
    s(:rescue,
      s(:send, nil, :require,
        s(:str, "win32ole")),
      s(:resbody,
        s(:array,
          s(:const, nil, :LoadError)), nil, nil), nil)),
  s(:send, nil, :require,
    s(:str, "test/unit")),
  s(:if,
    s(:defined?,
      s(:const, nil, :WIN32OLE)),
    s(:class,
      s(:const, nil, :TestThread),
      s(:const,
        s(:const,
          s(:const, nil, :Test), :Unit), :TestCase),
      s(:begin,
        s(:def, :assert_creating_win32ole_object_in_thread,
          s(:args,
            s(:arg, :meth)),
          s(:begin,
            s(:lvasgn, :t,
              s(:block,
                s(:send,
                  s(:const, nil, :Thread), :__send__,
                  s(:lvar, :meth)),
                s(:args),
                s(:send,
                  s(:const, nil, :WIN32OLE), :new,
                  s(:str, "Scripting.Dictionary")))),
            s(:block,
              s(:send, nil, :assert_nothing_raised,
                s(:const, nil, :WIN32OLERuntimeError),
                s(:dstr,
                  s(:str, "[Bug #2618] Thread."),
                  s(:begin,
                    s(:lvar, :meth)))),
              s(:args),
              s(:send,
                s(:lvar, :t), :join)))),
        s(:def, :test_creating_win32ole_object_in_thread_new,
          s(:args),
          s(:send, nil, :assert_creating_win32ole_object_in_thread,
            s(:sym, :new))),
        s(:def, :test_creating_win32ole_object_in_thread_start,
          s(:args),
          s(:send, nil, :assert_creating_win32ole_object_in_thread,
            s(:sym, :start))),
        s(:def, :test_creating_win32ole_object_in_thread_fork,
          s(:args),
          s(:send, nil, :assert_creating_win32ole_object_in_thread,
            s(:sym, :fork))))), nil))
