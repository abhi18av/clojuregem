s(:begin,
  s(:kwbegin,
    s(:rescue,
      s(:send, nil, :require,
        s(:str, "win32ole")),
      s(:resbody,
        s(:array,
          s(:const, nil, :LoadError)), nil, nil), nil)),
  s(:send, nil, :require,
    s(:str, "test/unit")),
  s(:def, :word_installed?,
    s(:args),
    s(:begin,
      s(:lvasgn, :installed,
        s(:false)),
      s(:lvasgn, :w,
        s(:nil)),
      s(:if,
        s(:defined?,
          s(:const, nil, :WIN32OLE)),
        s(:kwbegin,
          s(:ensure,
            s(:rescue,
              s(:begin,
                s(:lvasgn, :w,
                  s(:send,
                    s(:const, nil, :WIN32OLE), :new,
                    s(:str, "Word.Application"))),
                s(:lvasgn, :installed,
                  s(:true))),
              s(:resbody, nil, nil, nil), nil),
            s(:if,
              s(:lvar, :w),
              s(:begin,
                s(:send,
                  s(:lvar, :w), :quit),
                s(:lvasgn, :w,
                  s(:nil))), nil))), nil),
      s(:return,
        s(:lvar, :installed)))),
  s(:if,
    s(:defined?,
      s(:const, nil, :WIN32OLE)),
    s(:class,
      s(:const, nil, :TestWIN32OLE_WITH_WORD),
      s(:const,
        s(:const,
          s(:const, nil, :Test), :Unit), :TestCase),
      s(:if,
        s(:send, nil, :word_installed?),
        s(:begin,
          s(:def, :setup,
            s(:args),
            s(:kwbegin,
              s(:rescue,
                s(:ivasgn, :@obj,
                  s(:send,
                    s(:const, nil, :WIN32OLE), :new,
                    s(:str, "Word.Application"))),
                s(:resbody,
                  s(:array,
                    s(:const, nil, :WIN32OLERuntimeError)), nil,
                  s(:ivasgn, :@obj,
                    s(:nil))), nil))),
          s(:def, :test_ole_methods,
            s(:args),
            s(:if,
              s(:ivar, :@obj),
              s(:begin,
                s(:send,
                  s(:ivar, :@obj), :visible=,
                  s(:true)),
                s(:send,
                  s(:send,
                    s(:ivar, :@obj), :wordbasic), :disableAutoMacros,
                  s(:true)),
                s(:send, nil, :assert,
                  s(:true))), nil)),
          s(:def, :test_s_connect,
            s(:args),
            s(:if,
              s(:ivar, :@obj),
              s(:begin,
                s(:lvasgn, :obj2,
                  s(:send,
                    s(:const, nil, :WIN32OLE), :connect,
                    s(:str, "Word.Application"))),
                s(:send, nil, :assert_instance_of,
                  s(:const, nil, :WIN32OLE),
                  s(:lvar, :obj2)),
                s(:send,
                  s(:lvar, :obj2), :visible=,
                  s(:true))), nil)),
          s(:def, :teardown,
            s(:args),
            s(:if,
              s(:ivar, :@obj),
              s(:begin,
                s(:send,
                  s(:ivar, :@obj), :quit),
                s(:ivasgn, :@obj,
                  s(:nil))), nil))),
        s(:def, :test_dummy_for_skip_message,
          s(:args),
          s(:send, nil, :skip,
            s(:str, "Microsoft Word is not installed"))))), nil))
