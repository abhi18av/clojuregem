s(:begin,
  s(:kwbegin,
    s(:rescue,
      s(:send, nil, :require,
        s(:str, "win32ole")),
      s(:resbody,
        s(:array,
          s(:const, nil, :LoadError)), nil, nil), nil)),
  s(:send, nil, :require,
    s(:str, "test/unit")),
  s(:if,
    s(:defined?,
      s(:const, nil, :WIN32OLE)),
    s(:class,
      s(:const, nil, :TestWIN32OLE_FOR_PROPERTYPUTREF),
      s(:const,
        s(:const,
          s(:const, nil, :Test), :Unit), :TestCase),
      s(:begin,
        s(:def, :setup,
          s(:args),
          s(:ivasgn, :@obj,
            s(:send,
              s(:const, nil, :WIN32OLE), :new,
              s(:str, "Scripting.Dictionary")))),
        s(:def, :test_ole_methods,
          s(:args),
          s(:begin,
            s(:lvasgn, :x,
              s(:block,
                s(:send,
                  s(:send,
                    s(:ivar, :@obj), :ole_methods), :select),
                s(:args,
                  s(:arg, :m)),
                s(:send,
                  s(:send,
                    s(:lvar, :m), :invoke_kind), :==,
                  s(:str, "PROPERTYPUTREF")))),
            s(:send, nil, :assert,
              s(:send,
                s(:send,
                  s(:lvar, :x), :size), :>,
                s(:int, 0))),
            s(:send, nil, :assert_equal,
              s(:int, 1),
              s(:send,
                s(:lvar, :x), :size)),
            s(:send, nil, :assert_equal,
              s(:str, "Item"),
              s(:send,
                s(:send,
                  s(:lvar, :x), :[],
                  s(:int, 0)), :name)))),
        s(:def, :test_ole_put_methods,
          s(:args),
          s(:begin,
            s(:lvasgn, :x,
              s(:block,
                s(:send,
                  s(:send,
                    s(:ivar, :@obj), :ole_put_methods), :select),
                s(:args,
                  s(:arg, :m)),
                s(:send,
                  s(:send,
                    s(:lvar, :m), :invoke_kind), :==,
                  s(:str, "PROPERTYPUTREF")))),
            s(:send, nil, :assert,
              s(:send,
                s(:send,
                  s(:lvar, :x), :size), :>,
                s(:int, 0))),
            s(:send, nil, :assert_equal,
              s(:int, 1),
              s(:send,
                s(:lvar, :x), :size)),
            s(:send, nil, :assert_equal,
              s(:str, "Item"),
              s(:send,
                s(:send,
                  s(:lvar, :x), :[],
                  s(:int, 0)), :name)))))), nil))
