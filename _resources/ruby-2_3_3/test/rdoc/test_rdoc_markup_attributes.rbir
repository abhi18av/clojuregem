s(:begin,
  s(:send, nil, :require,
    s(:str, "rdoc/test_case")),
  s(:class,
    s(:const, nil, :TestRDocMarkupAttributes),
    s(:const,
      s(:const, nil, :RDoc), :TestCase),
    s(:begin,
      s(:def, :setup,
        s(:args),
        s(:begin,
          s(:zsuper),
          s(:ivasgn, :@as,
            s(:send,
              s(:const,
                s(:const,
                  s(:const, nil, :RDoc), :Markup), :Attributes), :new)))),
      s(:def, :test_bitmap_for,
        s(:args),
        s(:begin,
          s(:send, nil, :assert_equal,
            s(:int, 2),
            s(:send,
              s(:ivar, :@as), :bitmap_for,
              s(:str, "two"))),
          s(:send, nil, :assert_equal,
            s(:int, 2),
            s(:send,
              s(:ivar, :@as), :bitmap_for,
              s(:str, "two"))),
          s(:send, nil, :assert_equal,
            s(:int, 4),
            s(:send,
              s(:ivar, :@as), :bitmap_for,
              s(:str, "three"))))),
      s(:def, :test_as_string,
        s(:args),
        s(:begin,
          s(:send,
            s(:ivar, :@as), :bitmap_for,
            s(:str, "two")),
          s(:send,
            s(:ivar, :@as), :bitmap_for,
            s(:str, "three")),
          s(:send, nil, :assert_equal,
            s(:str, "none"),
            s(:send,
              s(:ivar, :@as), :as_string,
              s(:int, 0))),
          s(:send, nil, :assert_equal,
            s(:str, "_SPECIAL_"),
            s(:send,
              s(:ivar, :@as), :as_string,
              s(:int, 1))),
          s(:send, nil, :assert_equal,
            s(:str, "two"),
            s(:send,
              s(:ivar, :@as), :as_string,
              s(:int, 2))),
          s(:send, nil, :assert_equal,
            s(:str, "_SPECIAL_,two"),
            s(:send,
              s(:ivar, :@as), :as_string,
              s(:int, 3))))),
      s(:def, :test_each_name_of,
        s(:args),
        s(:begin,
          s(:send,
            s(:ivar, :@as), :bitmap_for,
            s(:str, "two")),
          s(:send,
            s(:ivar, :@as), :bitmap_for,
            s(:str, "three")),
          s(:send, nil, :assert_equal,
            s(:array),
            s(:send,
              s(:send,
                s(:ivar, :@as), :each_name_of,
                s(:int, 0)), :to_a)),
          s(:send, nil, :assert_equal,
            s(:array),
            s(:send,
              s(:send,
                s(:ivar, :@as), :each_name_of,
                s(:int, 1)), :to_a)),
          s(:send, nil, :assert_equal,
            s(:array,
              s(:str, "two")),
            s(:send,
              s(:send,
                s(:ivar, :@as), :each_name_of,
                s(:int, 2)), :to_a)),
          s(:send, nil, :assert_equal,
            s(:array,
              s(:str, "three")),
            s(:send,
              s(:send,
                s(:ivar, :@as), :each_name_of,
                s(:int, 4)), :to_a)),
          s(:send, nil, :assert_equal,
            s(:array,
              s(:str, "two"),
              s(:str, "three")),
            s(:send,
              s(:send,
                s(:ivar, :@as), :each_name_of,
                s(:int, 6)), :to_a)))))))
