s(:begin,
  s(:send,
    s(:const, nil, :ENV), :[]=,
    s(:str, "RDOC_TEST"),
    s(:str, "yes")),
  s(:send, nil, :require,
    s(:str, "rdoc")),
  s(:send, nil, :require,
    s(:send,
      s(:const, nil, :File), :expand_path,
      s(:str, "../xref_data"),
      s(:str, "(string)"))),
  s(:class,
    s(:const, nil, :XrefTestCase),
    s(:const,
      s(:const, nil, :RDoc), :TestCase),
    s(:def, :setup,
      s(:args),
      s(:begin,
        s(:zsuper),
        s(:ivasgn, :@options,
          s(:send,
            s(:const,
              s(:const, nil, :RDoc), :Options), :new)),
        s(:send,
          s(:ivar, :@options), :quiet=,
          s(:true)),
        s(:send,
          s(:ivar, :@rdoc), :options=,
          s(:ivar, :@options)),
        s(:ivasgn, :@file_name,
          s(:str, "xref_data.rb")),
        s(:ivasgn, :@xref_data,
          s(:send,
            s(:ivar, :@store), :add_file,
            s(:ivar, :@file_name))),
        s(:ivasgn, :@top_level,
          s(:ivar, :@xref_data)),
        s(:lvasgn, :stats,
          s(:send,
            s(:const,
              s(:const, nil, :RDoc), :Stats), :new,
            s(:ivar, :@store),
            s(:int, 0))),
        s(:lvasgn, :parser,
          s(:send,
            s(:const,
              s(:const,
                s(:const, nil, :RDoc), :Parser), :Ruby), :new,
            s(:ivar, :@xref_data),
            s(:ivar, :@file_name),
            s(:const, nil, :XREF_DATA),
            s(:ivar, :@options),
            s(:lvar, :stats))),
        s(:ivasgn, :@top_levels,
          s(:array)),
        s(:send,
          s(:ivar, :@top_levels), :push,
          s(:send,
            s(:lvar, :parser), :scan)),
        s(:lvasgn, :generator,
          s(:send,
            s(:const, nil, :Object), :new)),
        s(:defs,
          s(:lvar, :generator), :class_dir,
          s(:args),
          s(:nil)),
        s(:defs,
          s(:lvar, :generator), :file_dir,
          s(:args),
          s(:nil)),
        s(:send,
          s(:ivar, :@rdoc), :options=,
          s(:ivar, :@options)),
        s(:send,
          s(:ivar, :@rdoc), :generator=,
          s(:lvar, :generator)),
        s(:ivasgn, :@c1,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "C1"))),
        s(:ivasgn, :@c1_m,
          s(:send,
            s(:send,
              s(:ivar, :@c1), :method_list), :last)),
        s(:ivasgn, :@c1__m,
          s(:send,
            s(:send,
              s(:ivar, :@c1), :method_list), :first)),
        s(:ivasgn, :@c2,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "C2"))),
        s(:ivasgn, :@c2_a,
          s(:send,
            s(:send,
              s(:ivar, :@c2), :method_list), :last)),
        s(:ivasgn, :@c2_b,
          s(:send,
            s(:send,
              s(:ivar, :@c2), :method_list), :first)),
        s(:ivasgn, :@c2_c3,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "C2::C3"))),
        s(:ivasgn, :@c2_c3_m,
          s(:send,
            s(:send,
              s(:ivar, :@c2_c3), :method_list), :first)),
        s(:ivasgn, :@c2_c3_h1,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "C2::C3::H1"))),
        s(:ivasgn, :@c2_c3_h1_meh,
          s(:send,
            s(:send,
              s(:ivar, :@c2_c3_h1), :method_list), :first)),
        s(:ivasgn, :@c3,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "C3"))),
        s(:ivasgn, :@c4,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "C4"))),
        s(:ivasgn, :@c4_c4,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "C4::C4"))),
        s(:ivasgn, :@c5_c1,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "C5::C1"))),
        s(:ivasgn, :@c3_h1,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "C3::H1"))),
        s(:ivasgn, :@c3_h2,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "C3::H2"))),
        s(:ivasgn, :@m1,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "M1"))),
        s(:ivasgn, :@m1_m,
          s(:send,
            s(:send,
              s(:ivar, :@m1), :method_list), :first)),
        s(:ivasgn, :@m1_m2,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "M1::M2"))),
        s(:ivasgn, :@parent,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "Parent"))),
        s(:ivasgn, :@child,
          s(:send,
            s(:ivar, :@xref_data), :find_module_named,
            s(:str, "Child"))),
        s(:ivasgn, :@parent_m,
          s(:send,
            s(:send,
              s(:ivar, :@parent), :method_list), :first)),
        s(:ivasgn, :@parent__m,
          s(:send,
            s(:send,
              s(:ivar, :@parent), :method_list), :last))))))
