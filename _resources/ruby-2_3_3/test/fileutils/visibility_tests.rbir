s(:begin,
  s(:send, nil, :require,
    s(:str, "test/unit")),
  s(:send, nil, :require,
    s(:str, "fileutils")),
  s(:class,
    s(:const, nil, :TestFileUtils),
    s(:const,
      s(:const,
        s(:const, nil, :Test), :Unit), :TestCase), nil),
  s(:module,
    s(:const,
      s(:const, nil, :TestFileUtils), :Visibility),
    s(:begin,
      s(:block,
        s(:send,
          s(:const,
            s(:const, nil, :FileUtils), :METHODS), :each),
        s(:args,
          s(:arg, :m)),
        s(:begin,
          s(:block,
            s(:send, nil, :define_method,
              s(:dstr,
                s(:str, "test_singleton_visibility_"),
                s(:begin,
                  s(:lvar, :m)))),
            s(:args),
            s(:begin,
              s(:send, nil, :assert,
                s(:send,
                  s(:ivar, :@fu_module), :respond_to?,
                  s(:lvar, :m),
                  s(:true)),
                s(:dstr,
                  s(:str, "FileUtils::Verbose."),
                  s(:begin,
                    s(:lvar, :m)),
                  s(:str, " is not defined"))),
              s(:send, nil, :assert,
                s(:send,
                  s(:ivar, :@fu_module), :respond_to?,
                  s(:lvar, :m),
                  s(:false)),
                s(:dstr,
                  s(:str, "FileUtils::Verbose."),
                  s(:begin,
                    s(:lvar, :m)),
                  s(:str, " is not public"))))),
          s(:block,
            s(:send, nil, :define_method,
              s(:dstr,
                s(:str, "test_visibility_"),
                s(:begin,
                  s(:lvar, :m)))),
            s(:args),
            s(:begin,
              s(:send, nil, :assert,
                s(:send, nil, :respond_to?,
                  s(:lvar, :m),
                  s(:true)),
                s(:dstr,
                  s(:str, "FileUtils::Verbose#"),
                  s(:begin,
                    s(:lvar, :m)),
                  s(:str, " is not defined"))),
              s(:send, nil, :assert,
                s(:send,
                  s(:ivar, :@fu_module), :private_method_defined?,
                  s(:lvar, :m)),
                s(:dstr,
                  s(:str, "FileUtils::Verbose#"),
                  s(:begin,
                    s(:lvar, :m)),
                  s(:str, " is not private"))))))),
      s(:block,
        s(:send,
          s(:send,
            s(:const,
              s(:const, nil, :FileUtils), :StreamUtils_), :private_instance_methods), :each),
        s(:args,
          s(:arg, :m)),
        s(:begin,
          s(:block,
            s(:send, nil, :define_method,
              s(:dstr,
                s(:str, "test_singleton_visibility_"),
                s(:begin,
                  s(:lvar, :m)))),
            s(:args),
            s(:send, nil, :assert,
              s(:send,
                s(:ivar, :@fu_module), :respond_to?,
                s(:lvar, :m),
                s(:true)),
              s(:dstr,
                s(:str, "FileUtils::Verbose#"),
                s(:begin,
                  s(:lvar, :m)),
                s(:str, " is not defined")))),
          s(:block,
            s(:send, nil, :define_method,
              s(:dstr,
                s(:str, "test_visibility_"),
                s(:begin,
                  s(:lvar, :m)))),
            s(:args),
            s(:send, nil, :assert,
              s(:send, nil, :respond_to?,
                s(:lvar, :m),
                s(:true)),
              s(:dstr,
                s(:str, "FileUtils::Verbose#"),
                s(:begin,
                  s(:lvar, :m)),
                s(:str, " is not defined")))))))))
